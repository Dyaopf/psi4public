
.PHONY:	default all install depend clean dclean targetclean

subdirs = \
transqt2 dcft fnocc ccenergy cctriples ccsort scf lmp2 mp2 mcscf\
dfmp2 sapt dftsapt cchbar cclambda ccdensity transqt mints deriv scfgrad \
optking psimrcc findif ccresponse detci cceom occ adc \
mrcc stable thermo psi4

all: default

buildsubdirs       = $(subdirs:%=build-%)
installsubdirs     = $(subdirs:%=install-%)
installincsubdirs  = $(subdirs:%=installinc-%)
installmansubdirs  = $(subdirs:%=installman-%)
dependsubdirs      = $(subdirs:%=depend-%)
cleansubdirs       = $(subdirs:%=clean-%)
dcleansubdirs      = $(subdirs:%=dclean-%)
targetcleansubdirs = $(subdirs:%=targetclean-%)
.PHONY: $(buildsubdirs) $(installsubdirs) $(installincsubdirs) $(installmansubdirs) $(dependsubdirs) $(cleansubdirs) $(dcleansubdirs) $(targetcleansubdirs)

default: $(buildsubdirs)
$(buildsubdirs):
	$(MAKE) -C $(@:build-%=%) default

install: $(installsubdirs)
$(installsubdirs): all
	$(MAKE) -C $(@:install-%=%) install

install_inc: $(installincsubdirs)
$(installincsubdirs): all
	$(MAKE) -C $(@:installinc-%=%) install_inc

install_man: $(installmansubdirs)
$(installmansubdirs): all
	$(MAKE) -C $(@:installman-%=%) install_man

depend: $(dependsubdirs)
$(dependsubdirs):
	$(MAKE) -C $(@:depend-%=%) depend

clean: $(cleansubdirs)
$(cleansubdirs):
	$(MAKE) -C $(@:clean-%=%) clean

dclean: $(dcleansubdirs)
$(dcleansubdirs):
	$(MAKE) -C $(@:dclean-%=%) dclean

targetclean: $(targetcleansubdirs)
$(targetcleansubdirs):
	$(MAKE) -C $(@:targetclean-%=%) targetclean


top_srcdir = @top_srcdir@
srcdir = @srcdir@
top_objdir = ../..

$(top_srcdir)/configure: $(top_srcdir)/configure.ac $(top_srcdir)/aclocal.m4
	cd $(top_srcdir) && autoconf

$(top_objdir)/config.status: $(top_srcdir)/configure
	cd $(top_objdir) && ./config.status --recheck

Makefile: $(srcdir)/Makefile.in $(top_objdir)/config.status
	cd $(top_objdir) && CONFIG_FILES=src/bin/Makefile ./config.status
