/**********************************************************
* wBg_X_functional.cc: definitions for wBg_X_functional for KS-DFT
* Robert Parrish, robparrish@gmail.com
* Autogenerated by MATLAB Script on 08-Mar-2012
*
***********************************************************/
#include <libmints/mints.h>
#include <libfock/points.h>
#include "wBg_X_functional.h"
#include <stdlib.h>
#include <cmath>
#include <string>
#include <string>
#include <vector>

using namespace psi;
using namespace boost;
using namespace std;

namespace psi { namespace functional {

wBg_X_Functional::wBg_X_Functional(int npoints, int deriv) : Functional(npoints, deriv)
{

    name_ = "wBg_X";
    description_ = "SR Becke Exchange (Fake II)";
    citation_ = "A.D. Becke, Phys. Rev. A, 38(6):3098-3100, 1988";

    double omega = 2.9999999999999999E-01;
    params_.push_back(make_pair("omega",omega));
    double d = 4.1999999999999997E-03;
    params_.push_back(make_pair("d",d));

    is_gga_ = true;
    is_meta_ = false;

    //Required allocateion
    allocate();
}
wBg_X_Functional::~wBg_X_Functional()
{
}
void wBg_X_Functional::computeRKSFunctional(boost::shared_ptr<RKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict gamma_aa;
    const double* restrict tau_a;

    rho_a = prop->property_value("RHO_A")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
    }

    double omega = params_[0].second;
    double d = params_[1].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_) {
            double t191019 = 1.0/pow(rho_a[index],1.0/3.0);
            double t191020 = 1.0/(omega*omega);
            double t191021 = pow(rho_a[index],2.0/3.0);
            double t191022 = exp(t191020*t191021*(-5.734716210713804E32/3.774660826274405E31));
            double t191023 = sqrt(gamma_aa[index]);
            double t191024 = 1.0/pow(rho_a[index],4.0/3.0);
            functional_[index] = pow(rho_a[index],4.0/3.0)*(omega*t191019*(erf((pow(rho_a[index],1.0/3.0)*(2.394726750740845E16/ \
               6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t191019*(-t191022+ \
               (omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t191022-1.0)*(3.774660826274405E31/1.146943242142761E33) \
               +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
               -1.0)*((d*gamma_aa[index]*1.0/pow(rho_a[index],8.0/3.0)*2.0)/(d*t191023*t191024*log(t191023*t191024+ \
               sqrt((t191023*t191023)*(t191024*t191024)+1.0))*6.0+1.0)+4.190715359480463E15/2.251799813685248E15) \
               ;
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_) {
            double t191026 = 1.0/pow(rho_a[index],1.0/3.0);
            double t191027 = 1.0/(omega*omega);
            double t191028 = pow(rho_a[index],2.0/3.0);
            double t191043 = t191027*t191028*(5.734716210713804E32/3.774660826274405E31);
            double t191029 = exp(-t191043);
            double t191030 = sqrt(gamma_aa[index]);
            double t191031 = 1.0/pow(rho_a[index],4.0/3.0);
            double t191032 = t191030*t191031;
            double t191033 = log(t191032+sqrt(t191032*t191032+1.0));
            double t191034 = d*t191030*t191031*t191033*6.0;
            double t191035 = t191034+1.0;
            double t191036 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t191037 = 1.0/pow(rho_a[index],8.0/3.0);
            double t191038 = pow(rho_a[index],1.0/3.0);
            double t191039 = 1.0/omega;
            double t191040 = t191038*t191039*(2.394726750740845E16/6.143826841858749E15);
            double t191041 = erf(t191040);
            double t191042 = t191041*(3.991211251234741E15/2.251799813685248E15);
            double t191044 = omega*omega;
            double t191045 = 1.0/pow(rho_a[index],2.0/3.0);
            double t191046 = t191029-1.0;
            double t191047 = t191044*t191045*t191046*(3.774660826274405E31/1.146943242142761E33);
            double t191048 = -t191029+t191047+3.0/2.0;
            double t191056 = omega*t191026*t191048*(6.143826841858749E15/2.394726750740845E16);
            double t191049 = t191042-t191056;
            double t191050 = omega*t191026*t191049*(2.047942280619583E15/5.986816876852112E15);
            double t191051 = t191050-1.0;
            double t191052 = 1.0/t191035;
            double t191053 = pow(rho_a[index],4.0/3.0);
            double t191054 = d*gamma_aa[index]*t191052*t191037*2.0;
            double t191055 = t191054+4.190715359480463E15/2.251799813685248E15;
            v_rho_a_[index] = t191051*t191053*(d*gamma_aa[index]*t191052*t191036*(1.6E1/3.0)-d*gamma_aa[index]* \
               1.0/(t191035*t191035)*t191037*(d*1.0/pow(rho_a[index],7.0/3.0)*t191030*t191033*8.0+d*gamma_aa[index]* \
               t191036*1.0/sqrt(gamma_aa[index]*t191037+1.0)*8.0)*2.0)*(-1.0/2.0)+t191051*t191055*t191038*(2.0/3.0) \
               +t191053*t191055*(omega*t191026*(omega*t191026*((t191029*(1.0/3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/ \
               3.0)*t191044*t191046*(1.258220275424802E31/5.734716210713804E32)-t191026*t191027*t191029*(1.146943242142761E33/ \
               1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16)+omega*t191031*t191048*(2.047942280619583E15/ \
               2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t191045*t191029*t191039*(1.493415679873386E30/3.242500344799677E29) \
               )*(2.047942280619583E15/5.986816876852112E15)-omega*t191031*t191049*(2.047942280619583E15/1.796045063055634E16) \
               )*(1.0/2.0);
        } else {
            v_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            if (rho_a[index] > cutoff_) {
                double t191058 = 1.0/pow(rho_a[index],1.0/3.0);
                double t191059 = 1.0/(omega*omega);
                double t191060 = pow(rho_a[index],2.0/3.0);
                double t191061 = exp(t191060*t191059*(-5.734716210713804E32/3.774660826274405E31));
                double t191062 = sqrt(gamma_aa[index]);
                double t191063 = 1.0/pow(rho_a[index],4.0/3.0);
                double t191064 = 1.0/pow(rho_a[index],8.0/3.0);
                double t191065 = t191062*t191063;
                double t191066 = log(t191065+sqrt(t191065*t191065+1.0));
                double t191067 = d*t191062*t191063*t191066*6.0;
                double t191068 = t191067+1.0;
                v_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t191058*(erf((pow(rho_a[index],1.0/3.0)*(2.394726750740845E16/ \
                   6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t191058*(-t191061+ \
                   (omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t191061-1.0)*(3.774660826274405E31/1.146943242142761E33) \
                   +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
                   -1.0)*((d*t191064*2.0)/t191068-d*gamma_aa[index]*t191064*1.0/(t191068*t191068)*(d*t191064*1.0/sqrt(gamma_aa[index]* \
                   t191064+1.0)*3.0+d*1.0/sqrt(gamma_aa[index])*t191063*t191066*3.0)*2.0);
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_) {
            double t191071 = sqrt(gamma_aa[index]);
            double t191072 = 1.0/pow(rho_a[index],4.0/3.0);
            double t191073 = 1.0/(omega*omega);
            double t191074 = pow(rho_a[index],2.0/3.0);
            double t191077 = t191073*t191074*(5.734716210713804E32/3.774660826274405E31);
            double t191075 = exp(-t191077);
            double t191076 = 1.0/pow(rho_a[index],1.0/3.0);
            double t191078 = omega*omega;
            double t191079 = 1.0/pow(rho_a[index],8.0/3.0);
            double t191080 = t191075-1.0;
            double t191081 = 1.0/pow(rho_a[index],2.0/3.0);
            double t191082 = 1.0/rho_a[index];
            double t191083 = 1.0/sqrt(3.141592653589793);
            double t191084 = 1.0/pow(rho_a[index],5.0/3.0);
            double t191085 = t191082*t191075*(1.0/3.0);
            double t191086 = t191080*t191084*t191078*(1.258220275424802E31/5.734716210713804E32);
            double t191118 = t191073*t191075*t191076*(1.146943242142761E33/1.132398247882321E32);
            double t191087 = -t191118+t191085+t191086;
            double t191088 = t191080*t191081*t191078*(3.774660826274405E31/1.146943242142761E33);
            double t191089 = -t191075+t191088+3.0/2.0;
            double t191090 = 1.0/omega;
            double t191091 = 1.0/pow(rho_a[index],7.0/3.0);
            double t191092 = pow(rho_a[index],1.0/3.0);
            double t191093 = t191090*t191092*(2.394726750740845E16/6.143826841858749E15);
            double t191094 = erf(t191093);
            double t191095 = t191094*(3.991211251234741E15/2.251799813685248E15);
            double t191103 = omega*t191076*t191089*(6.143826841858749E15/2.394726750740845E16);
            double t191096 = -t191103+t191095;
            double t191097 = t191071*t191072;
            double t191098 = log(t191097+sqrt(t191097*t191097+1.0));
            double t191099 = d*t191071*t191072*t191098*6.0;
            double t191100 = t191099+1.0;
            double t191101 = 1.0/t191100;
            double t191102 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t191104 = omega*t191076*t191096*(2.047942280619583E15/5.986816876852112E15);
            double t191105 = t191104-1.0;
            double t191106 = d*gamma_aa[index]*t191101*t191079*2.0;
            double t191107 = t191106+4.190715359480463E15/2.251799813685248E15;
            double t191108 = pow(rho_a[index],4.0/3.0);
            double t191109 = d*gamma_aa[index]*t191101*t191102*(1.6E1/3.0);
            double t191110 = 1.0/(t191100*t191100);
            double t191111 = gamma_aa[index]*t191079;
            double t191112 = t191111+1.0;
            double t191113 = 1.0/sqrt(t191112);
            double t191114 = d*gamma_aa[index]*t191102*t191113*8.0;
            double t191115 = d*t191071*t191091*t191098*8.0;
            double t191116 = t191114+t191115;
            double t191117 = t191109-d*gamma_aa[index]*t191110*t191116*t191079*2.0;
            double t191119 = omega*t191076*t191087*(6.143826841858749E15/2.394726750740845E16);
            double t191120 = omega*t191072*t191089*(2.047942280619583E15/2.394726750740845E16);
            double t191121 = t191081*t191090*t191083*t191075*(1.493415679873386E30/3.242500344799677E29);
            double t191122 = t191120+t191121+t191119;
            double t191123 = omega*t191122*t191076*(2.047942280619583E15/5.986816876852112E15);
            double t191124 = t191123-omega*t191072*t191096*(2.047942280619583E15/1.796045063055634E16);
            double t191125 = 1.0/pow(rho_a[index],1.4E1/3.0);
            v_rho_a_rho_a_[index] = t191107*t191108*(omega*t191076*(omega*t191076*(1.0/(rho_a[index]*rho_a[index]) \
               *t191075*(5.0/9.0)-1.0/(omega*omega*omega*omega)*t191081*t191075*(1.315478800696948E66/1.282325791806952E64) \
               +t191080*t191078*t191079*(2.097033792374669E31/5.734716210713804E32))*(6.143826841858749E15/2.394726750740845E16) \
               +omega*t191072*t191087*(2.047942280619583E15/1.197363375370422E16)+omega*t191091*t191089*(2.047942280619583E15/ \
               1.796045063055634E16)+t191090*t191083*t191075*t191084*(1.493415679873386E30/4.863750517199516E29)+ \
               1.0/(omega*omega*omega)*t191082*t191083*t191075*(2.090897243335959E59/4.482179820811741E57))*(2.047942280619583E15/ \
               5.986816876852112E15)+omega*t191122*t191072*(2.047942280619583E15/8.980225315278168E15)-omega*t191091* \
               t191096*(2.047942280619583E15/1.347033797291725E16))*(-1.0/2.0)+t191105*t191108*(d*gamma_aa[index]* \
               t191101*t191125*(1.76E2/9.0)-d*gamma_aa[index]*t191110*t191079*(d*gamma_aa[index]*t191113*t191125* \
               4.0E1-d*(gamma_aa[index]*gamma_aa[index])*1.0/pow(rho_a[index],2.2E1/3.0)*1.0/pow(t191112,3.0/2.0) \
               *(3.2E1/3.0)+d*1.0/pow(rho_a[index],1.0E1/3.0)*t191071*t191098*(5.6E1/3.0))*2.0+d*gamma_aa[index]* \
               1.0/(t191100*t191100*t191100)*(t191116*t191116)*t191079*4.0-d*gamma_aa[index]*t191110*t191102*t191116* \
               (3.2E1/3.0))*(1.0/2.0)+t191105*t191107*t191081*(2.0/9.0)-t191124*t191108*t191117-t191105*t191117*t191092* \
               (4.0/3.0)+t191124*t191107*t191092*(4.0/3.0);
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t191127 = sqrt(gamma_aa[index]);
                double t191128 = 1.0/pow(rho_a[index],4.0/3.0);
                double t191129 = 1.0/pow(rho_a[index],8.0/3.0);
                double t191130 = t191127*t191128;
                double t191131 = log(t191130+sqrt(t191130*t191130+1.0));
                double t191132 = d*t191131*t191127*t191128*6.0;
                double t191133 = t191132+1.0;
                double t191134 = 1.0/pow(rho_a[index],1.0/3.0);
                double t191135 = 1.0/(omega*omega);
                double t191136 = pow(rho_a[index],2.0/3.0);
                double t191138 = t191135*t191136*(5.734716210713804E32/3.774660826274405E31);
                double t191137 = exp(-t191138);
                double t191139 = omega*omega;
                double t191140 = t191137-1.0;
                double t191141 = 1.0/pow(rho_a[index],2.0/3.0);
                double t191142 = 1.0/omega;
                double t191143 = t191140*t191141*t191139*(3.774660826274405E31/1.146943242142761E33);
                double t191144 = t191143-t191137+3.0/2.0;
                double t191145 = pow(rho_a[index],1.0/3.0);
                double t191146 = t191142*t191145*(2.394726750740845E16/6.143826841858749E15);
                double t191147 = erf(t191146);
                double t191148 = t191147*(3.991211251234741E15/2.251799813685248E15);
                double t191162 = omega*t191134*t191144*(6.143826841858749E15/2.394726750740845E16);
                double t191149 = -t191162+t191148;
                double t191150 = 1.0/t191133;
                double t191151 = d*t191150*t191129*2.0;
                double t191152 = gamma_aa[index]*t191129;
                double t191153 = t191152+1.0;
                double t191154 = 1.0/sqrt(t191153);
                double t191155 = d*t191154*t191129*3.0;
                double t191156 = 1.0/sqrt(gamma_aa[index]);
                double t191157 = d*t191131*t191128*t191156*3.0;
                double t191158 = t191155+t191157;
                double t191159 = 1.0/(t191133*t191133);
                double t191160 = t191151-d*gamma_aa[index]*t191129*t191158*t191159*2.0;
                double t191161 = pow(rho_a[index],4.0/3.0);
                double t191163 = omega*t191134*t191149*(2.047942280619583E15/5.986816876852112E15);
                double t191164 = t191163-1.0;
                double t191165 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t191166 = 1.0/pow(rho_a[index],7.0/3.0);
                double t191167 = d*gamma_aa[index]*t191154*t191165*8.0;
                double t191168 = d*t191131*t191127*t191166*8.0;
                double t191169 = t191167+t191168;
                v_rho_a_gamma_aa_[index] = t191161*t191164*(d*t191150*t191165*(-1.6E1/3.0)+d*t191129*t191159*t191169* \
                   2.0+d*gamma_aa[index]*t191129*t191159*(d*t191154*t191165*1.2E1+d*t191131*t191156*t191166*4.0-d*gamma_aa[index]* \
                   1.0/pow(rho_a[index],1.9E1/3.0)*1.0/pow(t191153,3.0/2.0)*4.0)*2.0+d*gamma_aa[index]*t191165*t191158* \
                   t191159*(1.6E1/3.0)-d*gamma_aa[index]*1.0/(t191133*t191133*t191133)*t191129*t191158*t191169*4.0)*(1.0/ \
                   2.0)+t191160*t191145*t191164*(2.0/3.0)+t191160*t191161*(omega*t191134*(omega*t191134*((t191137*(1.0/ \
                   3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/3.0)*t191140*t191139*(1.258220275424802E31/5.734716210713804E32) \
                   -t191134*t191135*t191137*(1.146943242142761E33/1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16) \
                   +omega*t191144*t191128*(2.047942280619583E15/2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t191141* \
                   t191142*t191137*(1.493415679873386E30/3.242500344799677E29))*(2.047942280619583E15/5.986816876852112E15) \
                   -omega*t191128*t191149*(2.047942280619583E15/1.796045063055634E16))*(1.0/2.0);
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t191171 = 1.0/pow(rho_a[index],1.0/3.0);
                double t191172 = 1.0/(omega*omega);
                double t191173 = pow(rho_a[index],2.0/3.0);
                double t191174 = exp(t191172*t191173*(-5.734716210713804E32/3.774660826274405E31));
                double t191175 = 1.0/pow(rho_a[index],8.0/3.0);
                double t191176 = 1.0/pow(rho_a[index],4.0/3.0);
                double t191177 = sqrt(gamma_aa[index]);
                double t191178 = t191176*t191177;
                double t191179 = log(t191178+sqrt(t191178*t191178+1.0));
                double t191180 = d*t191176*t191177*t191179*6.0;
                double t191181 = t191180+1.0;
                double t191182 = 1.0/(t191181*t191181);
                double t191183 = gamma_aa[index]*t191175;
                double t191184 = t191183+1.0;
                double t191185 = 1.0/sqrt(t191184);
                double t191186 = d*t191175*t191185*3.0;
                double t191187 = 1.0/sqrt(gamma_aa[index]);
                double t191188 = d*t191176*t191187*t191179*3.0;
                double t191189 = t191186+t191188;
                v_gamma_aa_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t191171*(erf((pow(rho_a[index],1.0/ \
                   3.0)*(2.394726750740845E16/6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15) \
                   -omega*t191171*(-t191174+(omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t191174-1.0)*(3.774660826274405E31/ \
                   1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/ \
                   5.986816876852112E15)-1.0)*(d*t191182*t191175*t191189*-4.0+d*gamma_aa[index]*1.0/(t191181*t191181* \
                   t191181)*t191175*(t191189*t191189)*4.0+d*gamma_aa[index]*t191182*t191175*(d*1.0/pow(rho_a[index],1.6E1/ \
                   3.0)*1.0/pow(t191184,3.0/2.0)*(3.0/2.0)-(d*t191175*t191185*(3.0/2.0))/gamma_aa[index]+d*1.0/pow(gamma_aa[index],3.0/ \
                   2.0)*t191176*t191179*(3.0/2.0))*2.0);
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

            }
        }
    }
}
void wBg_X_Functional::computeUKSFunctional(boost::shared_ptr<UKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict rho_b;
    const double* restrict gamma_aa;
    const double* restrict gamma_ab;
    const double* restrict gamma_bb;
    const double* restrict tau_a;
    const double* restrict tau_b;

    rho_a = prop->property_value("RHO_A")->pointer();
    rho_b = prop->property_value("RHO_B")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
        gamma_ab = prop->property_value("GAMMA_AB")->pointer();
        gamma_bb = prop->property_value("GAMMA_BB")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
        tau_b = prop->property_value("TAU_B")->pointer();
    }

    double omega = params_[0].second;
    double d = params_[1].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t190214 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190215 = 1.0/(omega*omega);
            double t190216 = pow(rho_a[index],2.0/3.0);
            double t190217 = exp(t190215*t190216*(-5.734716210713804E32/3.774660826274405E31));
            double t190218 = sqrt(gamma_aa[index]);
            double t190219 = 1.0/pow(rho_a[index],4.0/3.0);
            double t190220 = 1.0/omega;
            double t190221 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190222 = omega*omega;
            double t190223 = pow(rho_b[index],2.0/3.0);
            double t190224 = exp(t190223*t190215*(-5.734716210713804E32/3.774660826274405E31));
            double t190225 = sqrt(gamma_bb[index]);
            double t190226 = 1.0/pow(rho_b[index],4.0/3.0);
            functional_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190221*(erf(pow(rho_b[index],1.0/3.0)*t190220* \
               (2.394726750740845E16/6.143826841858749E15))*(3.991211251234741E15/2.251799813685248E15)-omega*t190221* \
               (-t190224+1.0/pow(rho_b[index],2.0/3.0)*t190222*(t190224-1.0)*(3.774660826274405E31/1.146943242142761E33) \
               +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
               -1.0)*((d*gamma_bb[index]*1.0/pow(rho_b[index],8.0/3.0)*2.0)/(d*t190225*t190226*log(t190225*t190226+ \
               sqrt((t190225*t190225)*(t190226*t190226)+1.0))*6.0+1.0)+4.190715359480463E15/2.251799813685248E15) \
               *(1.0/2.0)+pow(rho_a[index],4.0/3.0)*(omega*t190214*(erf(pow(rho_a[index],1.0/3.0)*t190220*(2.394726750740845E16/ \
               6.143826841858749E15))*(3.991211251234741E15/2.251799813685248E15)-omega*t190214*(-t190217+1.0/pow(rho_a[index],2.0/ \
               3.0)*t190222*(t190217-1.0)*(3.774660826274405E31/1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/ \
               2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15)-1.0)*((d*gamma_aa[index]*1.0/pow(rho_a[index],8.0/ \
               3.0)*2.0)/(d*t190218*t190219*log(t190218*t190219+sqrt((t190218*t190218)*(t190219*t190219)+1.0))*6.0+ \
               1.0)+4.190715359480463E15/2.251799813685248E15)*(1.0/2.0);
        } else if (rho_a[index] > cutoff_) {
            double t190782 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190783 = 1.0/(omega*omega);
            double t190784 = pow(rho_a[index],2.0/3.0);
            double t190785 = exp(t190783*t190784*(-5.734716210713804E32/3.774660826274405E31));
            double t190786 = sqrt(gamma_aa[index]);
            double t190787 = 1.0/pow(rho_a[index],4.0/3.0);
            functional_[index] = pow(rho_a[index],4.0/3.0)*(omega*t190782*(erf((pow(rho_a[index],1.0/3.0)*(2.394726750740845E16/ \
               6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190782*(-t190785+ \
               (omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t190785-1.0)*(3.774660826274405E31/1.146943242142761E33) \
               +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
               -1.0)*((d*gamma_aa[index]*1.0/pow(rho_a[index],8.0/3.0)*2.0)/(d*t190786*t190787*log(t190786*t190787+ \
               sqrt((t190786*t190786)*(t190787*t190787)+1.0))*6.0+1.0)+4.190715359480463E15/2.251799813685248E15) \
               *(1.0/2.0);
        } else if (rho_b[index] > cutoff_) {
            double t190581 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190582 = 1.0/(omega*omega);
            double t190583 = pow(rho_b[index],2.0/3.0);
            double t190584 = exp(t190582*t190583*(-5.734716210713804E32/3.774660826274405E31));
            double t190585 = sqrt(gamma_bb[index]);
            double t190586 = 1.0/pow(rho_b[index],4.0/3.0);
            functional_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190581*(erf((pow(rho_b[index],1.0/3.0)*(2.394726750740845E16/ \
               6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190581*(-t190584+ \
               (omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*(t190584-1.0)*(3.774660826274405E31/1.146943242142761E33) \
               +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
               -1.0)*((d*gamma_bb[index]*1.0/pow(rho_b[index],8.0/3.0)*2.0)/(d*t190585*t190586*log(t190585*t190586+ \
               sqrt((t190585*t190585)*(t190586*t190586)+1.0))*6.0+1.0)+4.190715359480463E15/2.251799813685248E15) \
               *(1.0/2.0);
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t190228 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190229 = 1.0/(omega*omega);
            double t190230 = pow(rho_a[index],2.0/3.0);
            double t190245 = t190230*t190229*(5.734716210713804E32/3.774660826274405E31);
            double t190231 = exp(-t190245);
            double t190232 = sqrt(gamma_aa[index]);
            double t190233 = 1.0/pow(rho_a[index],4.0/3.0);
            double t190234 = t190232*t190233;
            double t190235 = log(t190234+sqrt(t190234*t190234+1.0));
            double t190236 = d*t190232*t190233*t190235*6.0;
            double t190237 = t190236+1.0;
            double t190238 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t190239 = 1.0/pow(rho_a[index],8.0/3.0);
            double t190240 = pow(rho_a[index],1.0/3.0);
            double t190241 = 1.0/omega;
            double t190242 = t190240*t190241*(2.394726750740845E16/6.143826841858749E15);
            double t190243 = erf(t190242);
            double t190244 = t190243*(3.991211251234741E15/2.251799813685248E15);
            double t190246 = omega*omega;
            double t190247 = 1.0/pow(rho_a[index],2.0/3.0);
            double t190248 = t190231-1.0;
            double t190249 = t190246*t190247*t190248*(3.774660826274405E31/1.146943242142761E33);
            double t190250 = -t190231+t190249+3.0/2.0;
            double t190258 = omega*t190250*t190228*(6.143826841858749E15/2.394726750740845E16);
            double t190251 = t190244-t190258;
            double t190252 = omega*t190251*t190228*(2.047942280619583E15/5.986816876852112E15);
            double t190253 = t190252-1.0;
            double t190254 = 1.0/t190237;
            double t190255 = pow(rho_a[index],4.0/3.0);
            double t190256 = d*gamma_aa[index]*t190254*t190239*2.0;
            double t190257 = t190256+4.190715359480463E15/2.251799813685248E15;
            v_rho_a_[index] = t190253*t190255*(d*gamma_aa[index]*t190254*t190238*(1.6E1/3.0)-d*gamma_aa[index]* \
               1.0/(t190237*t190237)*t190239*(d*1.0/pow(rho_a[index],7.0/3.0)*t190232*t190235*8.0+d*gamma_aa[index]* \
               t190238*1.0/sqrt(gamma_aa[index]*t190239+1.0)*8.0)*2.0)*(-1.0/2.0)+t190240*t190253*t190257*(2.0/3.0) \
               +t190255*t190257*(omega*t190228*(omega*t190228*((t190231*(1.0/3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/ \
               3.0)*t190246*t190248*(1.258220275424802E31/5.734716210713804E32)-t190231*t190228*t190229*(1.146943242142761E33/ \
               1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16)+omega*t190250*t190233*(2.047942280619583E15/ \
               2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190231*t190241*t190247*(1.493415679873386E30/3.242500344799677E29) \
               )*(2.047942280619583E15/5.986816876852112E15)-omega*t190233*t190251*(2.047942280619583E15/1.796045063055634E16) \
               )*(1.0/2.0);
        } else if (rho_a[index] > cutoff_) {
            double t190789 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190790 = 1.0/(omega*omega);
            double t190791 = pow(rho_a[index],2.0/3.0);
            double t190806 = t190790*t190791*(5.734716210713804E32/3.774660826274405E31);
            double t190792 = exp(-t190806);
            double t190793 = sqrt(gamma_aa[index]);
            double t190794 = 1.0/pow(rho_a[index],4.0/3.0);
            double t190795 = t190793*t190794;
            double t190796 = log(t190795+sqrt(t190795*t190795+1.0));
            double t190797 = d*t190793*t190794*t190796*6.0;
            double t190798 = t190797+1.0;
            double t190799 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t190800 = 1.0/pow(rho_a[index],8.0/3.0);
            double t190801 = pow(rho_a[index],1.0/3.0);
            double t190802 = 1.0/omega;
            double t190803 = t190801*t190802*(2.394726750740845E16/6.143826841858749E15);
            double t190804 = erf(t190803);
            double t190805 = t190804*(3.991211251234741E15/2.251799813685248E15);
            double t190807 = omega*omega;
            double t190808 = 1.0/pow(rho_a[index],2.0/3.0);
            double t190809 = t190792-1.0;
            double t190810 = t190807*t190808*t190809*(3.774660826274405E31/1.146943242142761E33);
            double t190811 = t190810-t190792+3.0/2.0;
            double t190819 = omega*t190811*t190789*(6.143826841858749E15/2.394726750740845E16);
            double t190812 = t190805-t190819;
            double t190813 = omega*t190812*t190789*(2.047942280619583E15/5.986816876852112E15);
            double t190814 = t190813-1.0;
            double t190815 = 1.0/t190798;
            double t190816 = pow(rho_a[index],4.0/3.0);
            double t190817 = d*gamma_aa[index]*t190800*t190815*2.0;
            double t190818 = t190817+4.190715359480463E15/2.251799813685248E15;
            v_rho_a_[index] = t190814*t190816*(d*gamma_aa[index]*t190815*t190799*(1.6E1/3.0)-d*gamma_aa[index]* \
               t190800*1.0/(t190798*t190798)*(d*1.0/pow(rho_a[index],7.0/3.0)*t190793*t190796*8.0+d*gamma_aa[index]* \
               t190799*1.0/sqrt(gamma_aa[index]*t190800+1.0)*8.0)*2.0)*(-1.0/2.0)+t190801*t190814*t190818*(2.0/3.0) \
               +t190816*t190818*(omega*t190789*(omega*t190789*((t190792*(1.0/3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/ \
               3.0)*t190807*t190809*(1.258220275424802E31/5.734716210713804E32)-t190790*t190792*t190789*(1.146943242142761E33/ \
               1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16)+omega*t190811*t190794*(2.047942280619583E15/ \
               2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190802*t190808*t190792*(1.493415679873386E30/3.242500344799677E29) \
               )*(2.047942280619583E15/5.986816876852112E15)-omega*t190812*t190794*(2.047942280619583E15/1.796045063055634E16) \
               )*(1.0/2.0);
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_[index] = 0.0;
        } else {
            v_rho_a_[index] = 0.0;
        } 

        //V_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t190260 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190261 = 1.0/(omega*omega);
            double t190262 = pow(rho_b[index],2.0/3.0);
            double t190277 = t190261*t190262*(5.734716210713804E32/3.774660826274405E31);
            double t190263 = exp(-t190277);
            double t190264 = sqrt(gamma_bb[index]);
            double t190265 = 1.0/pow(rho_b[index],4.0/3.0);
            double t190266 = t190264*t190265;
            double t190267 = log(t190266+sqrt(t190266*t190266+1.0));
            double t190268 = d*t190264*t190265*t190267*6.0;
            double t190269 = t190268+1.0;
            double t190270 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t190271 = 1.0/pow(rho_b[index],8.0/3.0);
            double t190272 = pow(rho_b[index],1.0/3.0);
            double t190273 = 1.0/omega;
            double t190274 = t190272*t190273*(2.394726750740845E16/6.143826841858749E15);
            double t190275 = erf(t190274);
            double t190276 = t190275*(3.991211251234741E15/2.251799813685248E15);
            double t190278 = omega*omega;
            double t190279 = 1.0/pow(rho_b[index],2.0/3.0);
            double t190280 = t190263-1.0;
            double t190281 = t190280*t190278*t190279*(3.774660826274405E31/1.146943242142761E33);
            double t190282 = -t190263+t190281+3.0/2.0;
            double t190290 = omega*t190260*t190282*(6.143826841858749E15/2.394726750740845E16);
            double t190283 = -t190290+t190276;
            double t190284 = omega*t190260*t190283*(2.047942280619583E15/5.986816876852112E15);
            double t190285 = t190284-1.0;
            double t190286 = 1.0/t190269;
            double t190287 = pow(rho_b[index],4.0/3.0);
            double t190288 = d*gamma_bb[index]*t190271*t190286*2.0;
            double t190289 = t190288+4.190715359480463E15/2.251799813685248E15;
            v_rho_b_[index] = t190285*t190287*(d*gamma_bb[index]*t190270*t190286*(1.6E1/3.0)-d*gamma_bb[index]* \
               t190271*1.0/(t190269*t190269)*(d*1.0/pow(rho_b[index],7.0/3.0)*t190264*t190267*8.0+d*gamma_bb[index]* \
               t190270*1.0/sqrt(gamma_bb[index]*t190271+1.0)*8.0)*2.0)*(-1.0/2.0)+t190272*t190285*t190289*(2.0/3.0) \
               +t190287*t190289*(omega*t190260*(omega*t190260*((t190263*(1.0/3.0))/rho_b[index]+1.0/pow(rho_b[index],5.0/ \
               3.0)*t190280*t190278*(1.258220275424802E31/5.734716210713804E32)-t190260*t190261*t190263*(1.146943242142761E33/ \
               1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16)+omega*t190282*t190265*(2.047942280619583E15/ \
               2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190263*t190273*t190279*(1.493415679873386E30/3.242500344799677E29) \
               )*(2.047942280619583E15/5.986816876852112E15)-omega*t190265*t190283*(2.047942280619583E15/1.796045063055634E16) \
               )*(1.0/2.0);
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t190589 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190590 = 1.0/(omega*omega);
            double t190591 = pow(rho_b[index],2.0/3.0);
            double t190606 = t190590*t190591*(5.734716210713804E32/3.774660826274405E31);
            double t190592 = exp(-t190606);
            double t190593 = sqrt(gamma_bb[index]);
            double t190594 = 1.0/pow(rho_b[index],4.0/3.0);
            double t190595 = t190593*t190594;
            double t190596 = log(t190595+sqrt(t190595*t190595+1.0));
            double t190597 = d*t190593*t190594*t190596*6.0;
            double t190598 = t190597+1.0;
            double t190599 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t190600 = 1.0/pow(rho_b[index],8.0/3.0);
            double t190601 = pow(rho_b[index],1.0/3.0);
            double t190602 = 1.0/omega;
            double t190603 = t190601*t190602*(2.394726750740845E16/6.143826841858749E15);
            double t190604 = erf(t190603);
            double t190605 = t190604*(3.991211251234741E15/2.251799813685248E15);
            double t190607 = omega*omega;
            double t190608 = 1.0/pow(rho_b[index],2.0/3.0);
            double t190609 = t190592-1.0;
            double t190610 = t190607*t190608*t190609*(3.774660826274405E31/1.146943242142761E33);
            double t190611 = t190610-t190592+3.0/2.0;
            double t190619 = omega*t190611*t190589*(6.143826841858749E15/2.394726750740845E16);
            double t190612 = t190605-t190619;
            double t190613 = omega*t190612*t190589*(2.047942280619583E15/5.986816876852112E15);
            double t190614 = t190613-1.0;
            double t190615 = 1.0/t190598;
            double t190616 = pow(rho_b[index],4.0/3.0);
            double t190617 = d*gamma_bb[index]*t190600*t190615*2.0;
            double t190618 = t190617+4.190715359480463E15/2.251799813685248E15;
            v_rho_b_[index] = t190614*t190616*(d*gamma_bb[index]*t190615*t190599*(1.6E1/3.0)-d*gamma_bb[index]* \
               t190600*1.0/(t190598*t190598)*(d*1.0/pow(rho_b[index],7.0/3.0)*t190593*t190596*8.0+d*gamma_bb[index]* \
               t190599*1.0/sqrt(gamma_bb[index]*t190600+1.0)*8.0)*2.0)*(-1.0/2.0)+t190601*t190614*t190618*(2.0/3.0) \
               +t190616*t190618*(omega*t190589*(omega*t190589*((t190592*(1.0/3.0))/rho_b[index]+1.0/pow(rho_b[index],5.0/ \
               3.0)*t190607*t190609*(1.258220275424802E31/5.734716210713804E32)-t190590*t190592*t190589*(1.146943242142761E33/ \
               1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16)+omega*t190611*t190594*(2.047942280619583E15/ \
               2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190602*t190608*t190592*(1.493415679873386E30/3.242500344799677E29) \
               )*(2.047942280619583E15/5.986816876852112E15)-omega*t190612*t190594*(2.047942280619583E15/1.796045063055634E16) \
               )*(1.0/2.0);
        } else {
            v_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190292 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190293 = 1.0/(omega*omega);
                double t190294 = pow(rho_a[index],2.0/3.0);
                double t190295 = exp(t190293*t190294*(-5.734716210713804E32/3.774660826274405E31));
                double t190296 = sqrt(gamma_aa[index]);
                double t190297 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190298 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190299 = t190296*t190297;
                double t190300 = log(t190299+sqrt(t190299*t190299+1.0));
                double t190301 = d*t190300*t190296*t190297*6.0;
                double t190302 = t190301+1.0;
                v_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t190292*(erf((pow(rho_a[index],1.0/3.0)*(2.394726750740845E16/ \
                   6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190292*(-t190295+ \
                   (omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t190295-1.0)*(3.774660826274405E31/1.146943242142761E33) \
                   +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
                   -1.0)*((d*t190298*2.0)/t190302-d*gamma_aa[index]*1.0/(t190302*t190302)*t190298*(d*t190298*1.0/sqrt(gamma_aa[index]* \
                   t190298+1.0)*3.0+d*1.0/sqrt(gamma_aa[index])*t190300*t190297*3.0)*2.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                double t190822 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190823 = 1.0/(omega*omega);
                double t190824 = pow(rho_a[index],2.0/3.0);
                double t190825 = exp(t190823*t190824*(-5.734716210713804E32/3.774660826274405E31));
                double t190826 = sqrt(gamma_aa[index]);
                double t190827 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190828 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190829 = t190826*t190827;
                double t190830 = log(t190829+sqrt(t190829*t190829+1.0));
                double t190831 = d*t190830*t190826*t190827*6.0;
                double t190832 = t190831+1.0;
                v_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t190822*(erf((pow(rho_a[index],1.0/3.0)*(2.394726750740845E16/ \
                   6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190822*(-t190825+ \
                   (omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t190825-1.0)*(3.774660826274405E31/1.146943242142761E33) \
                   +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
                   -1.0)*((d*t190828*2.0)/t190832-d*gamma_aa[index]*1.0/(t190832*t190832)*t190828*(d*t190828*1.0/sqrt(gamma_aa[index]* \
                   t190828+1.0)*3.0+d*1.0/sqrt(gamma_aa[index])*t190830*t190827*3.0)*2.0)*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190305 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190306 = 1.0/(omega*omega);
                double t190307 = pow(rho_b[index],2.0/3.0);
                double t190308 = exp(t190306*t190307*(-5.734716210713804E32/3.774660826274405E31));
                double t190309 = sqrt(gamma_bb[index]);
                double t190310 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190311 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190312 = t190310*t190309;
                double t190313 = log(t190312+sqrt(t190312*t190312+1.0));
                double t190314 = d*t190310*t190313*t190309*6.0;
                double t190315 = t190314+1.0;
                v_gamma_bb_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190305*(erf((pow(rho_b[index],1.0/3.0)*(2.394726750740845E16/ \
                   6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190305*(-t190308+ \
                   (omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*(t190308-1.0)*(3.774660826274405E31/1.146943242142761E33) \
                   +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
                   -1.0)*((d*t190311*2.0)/t190315-d*gamma_bb[index]*t190311*1.0/(t190315*t190315)*(d*t190311*1.0/sqrt(gamma_bb[index]* \
                   t190311+1.0)*3.0+d*1.0/sqrt(gamma_bb[index])*t190310*t190313*3.0)*2.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t190623 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190624 = 1.0/(omega*omega);
                double t190625 = pow(rho_b[index],2.0/3.0);
                double t190626 = exp(t190624*t190625*(-5.734716210713804E32/3.774660826274405E31));
                double t190627 = sqrt(gamma_bb[index]);
                double t190628 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190629 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190630 = t190627*t190628;
                double t190631 = log(t190630+sqrt(t190630*t190630+1.0));
                double t190632 = d*t190631*t190627*t190628*6.0;
                double t190633 = t190632+1.0;
                v_gamma_bb_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190623*(erf((pow(rho_b[index],1.0/3.0)*(2.394726750740845E16/ \
                   6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15)-omega*t190623*(-t190626+ \
                   (omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*(t190626-1.0)*(3.774660826274405E31/1.146943242142761E33) \
                   +3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/5.986816876852112E15) \
                   -1.0)*((d*t190629*2.0)/t190633-d*gamma_bb[index]*1.0/(t190633*t190633)*t190629*(d*t190629*1.0/sqrt(gamma_bb[index]* \
                   t190629+1.0)*3.0+d*1.0/sqrt(gamma_bb[index])*t190631*t190628*3.0)*2.0)*(1.0/2.0);
            } else {
                v_gamma_bb_[index] = 0.0;
            } 
        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else {
                v_tau_b_[index] = 0.0;
            } 
        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t190319 = sqrt(gamma_aa[index]);
            double t190320 = 1.0/pow(rho_a[index],4.0/3.0);
            double t190321 = 1.0/(omega*omega);
            double t190322 = pow(rho_a[index],2.0/3.0);
            double t190325 = t190321*t190322*(5.734716210713804E32/3.774660826274405E31);
            double t190323 = exp(-t190325);
            double t190324 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190326 = omega*omega;
            double t190327 = 1.0/pow(rho_a[index],8.0/3.0);
            double t190328 = t190323-1.0;
            double t190329 = 1.0/pow(rho_a[index],2.0/3.0);
            double t190330 = 1.0/rho_a[index];
            double t190331 = 1.0/sqrt(3.141592653589793);
            double t190332 = 1.0/pow(rho_a[index],5.0/3.0);
            double t190333 = t190330*t190323*(1.0/3.0);
            double t190334 = t190332*t190326*t190328*(1.258220275424802E31/5.734716210713804E32);
            double t190366 = t190321*t190323*t190324*(1.146943242142761E33/1.132398247882321E32);
            double t190335 = t190333+t190334-t190366;
            double t190336 = t190326*t190328*t190329*(3.774660826274405E31/1.146943242142761E33);
            double t190337 = -t190323+t190336+3.0/2.0;
            double t190338 = 1.0/omega;
            double t190339 = 1.0/pow(rho_a[index],7.0/3.0);
            double t190340 = pow(rho_a[index],1.0/3.0);
            double t190341 = t190340*t190338*(2.394726750740845E16/6.143826841858749E15);
            double t190342 = erf(t190341);
            double t190343 = t190342*(3.991211251234741E15/2.251799813685248E15);
            double t190351 = omega*t190324*t190337*(6.143826841858749E15/2.394726750740845E16);
            double t190344 = -t190351+t190343;
            double t190345 = t190320*t190319;
            double t190346 = log(t190345+sqrt(t190345*t190345+1.0));
            double t190347 = d*t190320*t190319*t190346*6.0;
            double t190348 = t190347+1.0;
            double t190349 = 1.0/t190348;
            double t190350 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t190352 = omega*t190324*t190344*(2.047942280619583E15/5.986816876852112E15);
            double t190353 = t190352-1.0;
            double t190354 = d*gamma_aa[index]*t190327*t190349*2.0;
            double t190355 = t190354+4.190715359480463E15/2.251799813685248E15;
            double t190356 = pow(rho_a[index],4.0/3.0);
            double t190357 = d*gamma_aa[index]*t190350*t190349*(1.6E1/3.0);
            double t190358 = 1.0/(t190348*t190348);
            double t190359 = gamma_aa[index]*t190327;
            double t190360 = t190359+1.0;
            double t190361 = 1.0/sqrt(t190360);
            double t190362 = d*gamma_aa[index]*t190350*t190361*8.0;
            double t190363 = d*t190319*t190346*t190339*8.0;
            double t190364 = t190362+t190363;
            double t190365 = t190357-d*gamma_aa[index]*t190327*t190364*t190358*2.0;
            double t190367 = omega*t190324*t190335*(6.143826841858749E15/2.394726750740845E16);
            double t190368 = omega*t190320*t190337*(2.047942280619583E15/2.394726750740845E16);
            double t190369 = t190331*t190323*t190329*t190338*(1.493415679873386E30/3.242500344799677E29);
            double t190370 = t190367+t190368+t190369;
            double t190371 = omega*t190320*t190344*(2.047942280619583E15/1.796045063055634E16);
            double t190372 = t190371-omega*t190324*t190370*(2.047942280619583E15/5.986816876852112E15);
            double t190373 = 1.0/pow(rho_a[index],1.4E1/3.0);
            v_rho_a_rho_a_[index] = t190355*t190356*(omega*t190324*(omega*t190324*(1.0/(rho_a[index]*rho_a[index]) \
               *t190323*(5.0/9.0)-1.0/(omega*omega*omega*omega)*t190323*t190329*(1.315478800696948E66/1.282325791806952E64) \
               +t190326*t190327*t190328*(2.097033792374669E31/5.734716210713804E32))*(6.143826841858749E15/2.394726750740845E16) \
               +omega*t190320*t190335*(2.047942280619583E15/1.197363375370422E16)+omega*t190337*t190339*(2.047942280619583E15/ \
               1.796045063055634E16)+t190331*t190323*t190332*t190338*(1.493415679873386E30/4.863750517199516E29)+ \
               1.0/(omega*omega*omega)*t190330*t190331*t190323*(2.090897243335959E59/4.482179820811741E57))*(2.047942280619583E15/ \
               5.986816876852112E15)+omega*t190320*t190370*(2.047942280619583E15/8.980225315278168E15)-omega*t190344* \
               t190339*(2.047942280619583E15/1.347033797291725E16))*(-1.0/2.0)+t190353*t190356*(d*gamma_aa[index]* \
               t190373*t190349*(1.76E2/9.0)-d*gamma_aa[index]*t190327*t190358*(d*gamma_aa[index]*t190361*t190373* \
               4.0E1-d*(gamma_aa[index]*gamma_aa[index])*1.0/pow(rho_a[index],2.2E1/3.0)*1.0/pow(t190360,3.0/2.0) \
               *(3.2E1/3.0)+d*1.0/pow(rho_a[index],1.0E1/3.0)*t190319*t190346*(5.6E1/3.0))*2.0+d*gamma_aa[index]* \
               t190327*(t190364*t190364)*1.0/(t190348*t190348*t190348)*4.0-d*gamma_aa[index]*t190350*t190364*t190358* \
               (3.2E1/3.0))*(1.0/2.0)-t190340*t190353*t190365*(4.0/3.0)-t190340*t190372*t190355*(4.0/3.0)+t190353* \
               t190355*t190329*(2.0/9.0)+t190372*t190356*t190365;
        } else if (rho_a[index] > cutoff_) {
            double t190838 = sqrt(gamma_aa[index]);
            double t190839 = 1.0/pow(rho_a[index],4.0/3.0);
            double t190840 = 1.0/(omega*omega);
            double t190841 = pow(rho_a[index],2.0/3.0);
            double t190844 = t190840*t190841*(5.734716210713804E32/3.774660826274405E31);
            double t190842 = exp(-t190844);
            double t190843 = 1.0/pow(rho_a[index],1.0/3.0);
            double t190845 = omega*omega;
            double t190846 = 1.0/pow(rho_a[index],8.0/3.0);
            double t190847 = t190842-1.0;
            double t190848 = 1.0/pow(rho_a[index],2.0/3.0);
            double t190849 = 1.0/rho_a[index];
            double t190850 = 1.0/sqrt(3.141592653589793);
            double t190851 = 1.0/pow(rho_a[index],5.0/3.0);
            double t190852 = t190842*t190849*(1.0/3.0);
            double t190853 = t190851*t190845*t190847*(1.258220275424802E31/5.734716210713804E32);
            double t190885 = t190840*t190842*t190843*(1.146943242142761E33/1.132398247882321E32);
            double t190854 = t190852+t190853-t190885;
            double t190855 = t190845*t190847*t190848*(3.774660826274405E31/1.146943242142761E33);
            double t190856 = -t190842+t190855+3.0/2.0;
            double t190857 = 1.0/omega;
            double t190858 = 1.0/pow(rho_a[index],7.0/3.0);
            double t190859 = pow(rho_a[index],1.0/3.0);
            double t190860 = t190857*t190859*(2.394726750740845E16/6.143826841858749E15);
            double t190861 = erf(t190860);
            double t190862 = t190861*(3.991211251234741E15/2.251799813685248E15);
            double t190870 = omega*t190843*t190856*(6.143826841858749E15/2.394726750740845E16);
            double t190863 = -t190870+t190862;
            double t190864 = t190838*t190839;
            double t190865 = log(t190864+sqrt(t190864*t190864+1.0));
            double t190866 = d*t190838*t190865*t190839*6.0;
            double t190867 = t190866+1.0;
            double t190868 = 1.0/t190867;
            double t190869 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t190871 = omega*t190843*t190863*(2.047942280619583E15/5.986816876852112E15);
            double t190872 = t190871-1.0;
            double t190873 = d*gamma_aa[index]*t190846*t190868*2.0;
            double t190874 = t190873+4.190715359480463E15/2.251799813685248E15;
            double t190875 = pow(rho_a[index],4.0/3.0);
            double t190876 = d*gamma_aa[index]*t190868*t190869*(1.6E1/3.0);
            double t190877 = 1.0/(t190867*t190867);
            double t190878 = gamma_aa[index]*t190846;
            double t190879 = t190878+1.0;
            double t190880 = 1.0/sqrt(t190879);
            double t190881 = d*gamma_aa[index]*t190880*t190869*8.0;
            double t190882 = d*t190838*t190865*t190858*8.0;
            double t190883 = t190881+t190882;
            double t190884 = t190876-d*gamma_aa[index]*t190846*t190883*t190877*2.0;
            double t190886 = omega*t190843*t190854*(6.143826841858749E15/2.394726750740845E16);
            double t190887 = omega*t190856*t190839*(2.047942280619583E15/2.394726750740845E16);
            double t190888 = t190850*t190842*t190848*t190857*(1.493415679873386E30/3.242500344799677E29);
            double t190889 = t190886+t190887+t190888;
            double t190890 = omega*t190863*t190839*(2.047942280619583E15/1.796045063055634E16);
            double t190891 = t190890-omega*t190843*t190889*(2.047942280619583E15/5.986816876852112E15);
            double t190892 = 1.0/pow(rho_a[index],1.4E1/3.0);
            v_rho_a_rho_a_[index] = t190874*t190875*(omega*t190843*(omega*t190843*(1.0/(rho_a[index]*rho_a[index]) \
               *t190842*(5.0/9.0)-1.0/(omega*omega*omega*omega)*t190842*t190848*(1.315478800696948E66/1.282325791806952E64) \
               +t190845*t190846*t190847*(2.097033792374669E31/5.734716210713804E32))*(6.143826841858749E15/2.394726750740845E16) \
               +omega*t190854*t190839*(2.047942280619583E15/1.197363375370422E16)+omega*t190856*t190858*(2.047942280619583E15/ \
               1.796045063055634E16)+t190850*t190842*t190851*t190857*(1.493415679873386E30/4.863750517199516E29)+ \
               1.0/(omega*omega*omega)*t190850*t190842*t190849*(2.090897243335959E59/4.482179820811741E57))*(2.047942280619583E15/ \
               5.986816876852112E15)-omega*t190863*t190858*(2.047942280619583E15/1.347033797291725E16)+omega*t190839* \
               t190889*(2.047942280619583E15/8.980225315278168E15))*(-1.0/2.0)+t190872*t190875*(d*gamma_aa[index]* \
               t190892*t190868*(1.76E2/9.0)-d*gamma_aa[index]*t190846*t190877*(d*gamma_aa[index]*t190880*t190892* \
               4.0E1-d*(gamma_aa[index]*gamma_aa[index])*1.0/pow(rho_a[index],2.2E1/3.0)*1.0/pow(t190879,3.0/2.0) \
               *(3.2E1/3.0)+d*1.0/pow(rho_a[index],1.0E1/3.0)*t190838*t190865*(5.6E1/3.0))*2.0+d*gamma_aa[index]* \
               t190846*(t190883*t190883)*1.0/(t190867*t190867*t190867)*4.0-d*gamma_aa[index]*t190883*t190877*t190869* \
               (3.2E1/3.0))*(1.0/2.0)+t190872*t190874*t190848*(2.0/9.0)+t190891*t190875*t190884-t190872*t190884*t190859* \
               (4.0/3.0)-t190891*t190874*t190859*(4.0/3.0);
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_a_[index] = 0.0;
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        //V_rho_a_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_a[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else {
            v_rho_a_rho_b_[index] = 0.0;
        } 

        //V_rho_b_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t190376 = sqrt(gamma_bb[index]);
            double t190377 = 1.0/pow(rho_b[index],4.0/3.0);
            double t190378 = 1.0/(omega*omega);
            double t190379 = pow(rho_b[index],2.0/3.0);
            double t190382 = t190378*t190379*(5.734716210713804E32/3.774660826274405E31);
            double t190380 = exp(-t190382);
            double t190381 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190383 = omega*omega;
            double t190384 = 1.0/pow(rho_b[index],8.0/3.0);
            double t190385 = t190380-1.0;
            double t190386 = 1.0/pow(rho_b[index],2.0/3.0);
            double t190387 = 1.0/rho_b[index];
            double t190388 = 1.0/sqrt(3.141592653589793);
            double t190389 = 1.0/pow(rho_b[index],5.0/3.0);
            double t190390 = t190380*t190387*(1.0/3.0);
            double t190391 = t190383*t190385*t190389*(1.258220275424802E31/5.734716210713804E32);
            double t190423 = t190380*t190381*t190378*(1.146943242142761E33/1.132398247882321E32);
            double t190392 = -t190423+t190390+t190391;
            double t190393 = t190383*t190385*t190386*(3.774660826274405E31/1.146943242142761E33);
            double t190394 = -t190380+t190393+3.0/2.0;
            double t190395 = 1.0/omega;
            double t190396 = 1.0/pow(rho_b[index],7.0/3.0);
            double t190397 = pow(rho_b[index],1.0/3.0);
            double t190398 = t190395*t190397*(2.394726750740845E16/6.143826841858749E15);
            double t190399 = erf(t190398);
            double t190400 = t190399*(3.991211251234741E15/2.251799813685248E15);
            double t190408 = omega*t190381*t190394*(6.143826841858749E15/2.394726750740845E16);
            double t190401 = t190400-t190408;
            double t190402 = t190376*t190377;
            double t190403 = log(t190402+sqrt(t190402*t190402+1.0));
            double t190404 = d*t190403*t190376*t190377*6.0;
            double t190405 = t190404+1.0;
            double t190406 = 1.0/t190405;
            double t190407 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t190409 = omega*t190401*t190381*(2.047942280619583E15/5.986816876852112E15);
            double t190410 = t190409-1.0;
            double t190411 = d*gamma_bb[index]*t190406*t190384*2.0;
            double t190412 = t190411+4.190715359480463E15/2.251799813685248E15;
            double t190413 = pow(rho_b[index],4.0/3.0);
            double t190414 = d*gamma_bb[index]*t190406*t190407*(1.6E1/3.0);
            double t190415 = 1.0/(t190405*t190405);
            double t190416 = gamma_bb[index]*t190384;
            double t190417 = t190416+1.0;
            double t190418 = 1.0/sqrt(t190417);
            double t190419 = d*gamma_bb[index]*t190407*t190418*8.0;
            double t190420 = d*t190403*t190376*t190396*8.0;
            double t190421 = t190420+t190419;
            double t190422 = t190414-d*gamma_bb[index]*t190421*t190415*t190384*2.0;
            double t190424 = omega*t190381*t190392*(6.143826841858749E15/2.394726750740845E16);
            double t190425 = omega*t190394*t190377*(2.047942280619583E15/2.394726750740845E16);
            double t190426 = t190380*t190386*t190395*t190388*(1.493415679873386E30/3.242500344799677E29);
            double t190427 = t190424+t190425+t190426;
            double t190428 = omega*t190401*t190377*(2.047942280619583E15/1.796045063055634E16);
            double t190429 = t190428-omega*t190381*t190427*(2.047942280619583E15/5.986816876852112E15);
            double t190430 = 1.0/pow(rho_b[index],1.4E1/3.0);
            v_rho_b_rho_b_[index] = t190412*t190413*(omega*t190381*(omega*t190381*(1.0/(rho_b[index]*rho_b[index]) \
               *t190380*(5.0/9.0)-1.0/(omega*omega*omega*omega)*t190380*t190386*(1.315478800696948E66/1.282325791806952E64) \
               +t190383*t190384*t190385*(2.097033792374669E31/5.734716210713804E32))*(6.143826841858749E15/2.394726750740845E16) \
               +omega*t190392*t190377*(2.047942280619583E15/1.197363375370422E16)+omega*t190394*t190396*(2.047942280619583E15/ \
               1.796045063055634E16)+t190380*t190395*t190388*t190389*(1.493415679873386E30/4.863750517199516E29)+ \
               1.0/(omega*omega*omega)*t190380*t190387*t190388*(2.090897243335959E59/4.482179820811741E57))*(2.047942280619583E15/ \
               5.986816876852112E15)-omega*t190401*t190396*(2.047942280619583E15/1.347033797291725E16)+omega*t190427* \
               t190377*(2.047942280619583E15/8.980225315278168E15))*(-1.0/2.0)+t190410*t190413*(d*gamma_bb[index]* \
               t190430*t190406*(1.76E2/9.0)-d*gamma_bb[index]*t190415*t190384*(d*gamma_bb[index]*t190430*t190418* \
               4.0E1-d*(gamma_bb[index]*gamma_bb[index])*1.0/pow(rho_b[index],2.2E1/3.0)*1.0/pow(t190417,3.0/2.0) \
               *(3.2E1/3.0)+d*1.0/pow(rho_b[index],1.0E1/3.0)*t190403*t190376*(5.6E1/3.0))*2.0+d*gamma_bb[index]* \
               (t190421*t190421)*1.0/(t190405*t190405*t190405)*t190384*4.0-d*gamma_bb[index]*t190421*t190415*t190407* \
               (3.2E1/3.0))*(1.0/2.0)+t190410*t190412*t190386*(2.0/9.0)+t190413*t190422*t190429-t190410*t190422*t190397* \
               (4.0/3.0)-t190412*t190429*t190397*(4.0/3.0);
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t190639 = sqrt(gamma_bb[index]);
            double t190640 = 1.0/pow(rho_b[index],4.0/3.0);
            double t190641 = 1.0/(omega*omega);
            double t190642 = pow(rho_b[index],2.0/3.0);
            double t190645 = t190641*t190642*(5.734716210713804E32/3.774660826274405E31);
            double t190643 = exp(-t190645);
            double t190644 = 1.0/pow(rho_b[index],1.0/3.0);
            double t190646 = omega*omega;
            double t190647 = 1.0/pow(rho_b[index],8.0/3.0);
            double t190648 = t190643-1.0;
            double t190649 = 1.0/pow(rho_b[index],2.0/3.0);
            double t190650 = 1.0/rho_b[index];
            double t190651 = 1.0/sqrt(3.141592653589793);
            double t190652 = 1.0/pow(rho_b[index],5.0/3.0);
            double t190653 = t190650*t190643*(1.0/3.0);
            double t190654 = t190652*t190646*t190648*(1.258220275424802E31/5.734716210713804E32);
            double t190686 = t190641*t190643*t190644*(1.146943242142761E33/1.132398247882321E32);
            double t190655 = t190653+t190654-t190686;
            double t190656 = t190646*t190648*t190649*(3.774660826274405E31/1.146943242142761E33);
            double t190657 = -t190643+t190656+3.0/2.0;
            double t190658 = 1.0/omega;
            double t190659 = 1.0/pow(rho_b[index],7.0/3.0);
            double t190660 = pow(rho_b[index],1.0/3.0);
            double t190661 = t190660*t190658*(2.394726750740845E16/6.143826841858749E15);
            double t190662 = erf(t190661);
            double t190663 = t190662*(3.991211251234741E15/2.251799813685248E15);
            double t190671 = omega*t190644*t190657*(6.143826841858749E15/2.394726750740845E16);
            double t190664 = -t190671+t190663;
            double t190665 = t190640*t190639;
            double t190666 = log(t190665+sqrt(t190665*t190665+1.0));
            double t190667 = d*t190640*t190639*t190666*6.0;
            double t190668 = t190667+1.0;
            double t190669 = 1.0/t190668;
            double t190670 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t190672 = omega*t190644*t190664*(2.047942280619583E15/5.986816876852112E15);
            double t190673 = t190672-1.0;
            double t190674 = d*gamma_bb[index]*t190647*t190669*2.0;
            double t190675 = t190674+4.190715359480463E15/2.251799813685248E15;
            double t190676 = pow(rho_b[index],4.0/3.0);
            double t190677 = d*gamma_bb[index]*t190670*t190669*(1.6E1/3.0);
            double t190678 = 1.0/(t190668*t190668);
            double t190679 = gamma_bb[index]*t190647;
            double t190680 = t190679+1.0;
            double t190681 = 1.0/sqrt(t190680);
            double t190682 = d*gamma_bb[index]*t190670*t190681*8.0;
            double t190683 = d*t190639*t190666*t190659*8.0;
            double t190684 = t190682+t190683;
            double t190685 = t190677-d*gamma_bb[index]*t190647*t190684*t190678*2.0;
            double t190687 = omega*t190644*t190655*(6.143826841858749E15/2.394726750740845E16);
            double t190688 = omega*t190640*t190657*(2.047942280619583E15/2.394726750740845E16);
            double t190689 = t190651*t190643*t190649*t190658*(1.493415679873386E30/3.242500344799677E29);
            double t190690 = t190687+t190688+t190689;
            double t190691 = omega*t190640*t190664*(2.047942280619583E15/1.796045063055634E16);
            double t190692 = t190691-omega*t190644*t190690*(2.047942280619583E15/5.986816876852112E15);
            double t190693 = 1.0/pow(rho_b[index],1.4E1/3.0);
            v_rho_b_rho_b_[index] = t190675*t190676*(omega*t190644*(omega*t190644*(1.0/(rho_b[index]*rho_b[index]) \
               *t190643*(5.0/9.0)-1.0/(omega*omega*omega*omega)*t190643*t190649*(1.315478800696948E66/1.282325791806952E64) \
               +t190646*t190647*t190648*(2.097033792374669E31/5.734716210713804E32))*(6.143826841858749E15/2.394726750740845E16) \
               +omega*t190640*t190655*(2.047942280619583E15/1.197363375370422E16)+omega*t190657*t190659*(2.047942280619583E15/ \
               1.796045063055634E16)+t190651*t190643*t190652*t190658*(1.493415679873386E30/4.863750517199516E29)+ \
               1.0/(omega*omega*omega)*t190650*t190651*t190643*(2.090897243335959E59/4.482179820811741E57))*(2.047942280619583E15/ \
               5.986816876852112E15)+omega*t190640*t190690*(2.047942280619583E15/8.980225315278168E15)-omega*t190664* \
               t190659*(2.047942280619583E15/1.347033797291725E16))*(-1.0/2.0)+t190673*t190676*(d*gamma_bb[index]* \
               t190693*t190669*(1.76E2/9.0)-d*gamma_bb[index]*t190647*t190678*(d*gamma_bb[index]*t190681*t190693* \
               4.0E1-d*(gamma_bb[index]*gamma_bb[index])*1.0/pow(rho_b[index],2.2E1/3.0)*1.0/pow(t190680,3.0/2.0) \
               *(3.2E1/3.0)+d*1.0/pow(rho_b[index],1.0E1/3.0)*t190639*t190666*(5.6E1/3.0))*2.0+d*gamma_bb[index]* \
               t190647*(t190684*t190684)*1.0/(t190668*t190668*t190668)*4.0-d*gamma_bb[index]*t190670*t190684*t190678* \
               (3.2E1/3.0))*(1.0/2.0)-t190660*t190673*t190685*(4.0/3.0)-t190660*t190692*t190675*(4.0/3.0)+t190673* \
               t190675*t190649*(2.0/9.0)+t190692*t190676*t190685;
        } else {
            v_rho_b_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190432 = sqrt(gamma_aa[index]);
                double t190433 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190434 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190435 = t190432*t190433;
                double t190436 = log(t190435+sqrt(t190435*t190435+1.0));
                double t190437 = d*t190432*t190433*t190436*6.0;
                double t190438 = t190437+1.0;
                double t190439 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190440 = 1.0/(omega*omega);
                double t190441 = pow(rho_a[index],2.0/3.0);
                double t190443 = t190440*t190441*(5.734716210713804E32/3.774660826274405E31);
                double t190442 = exp(-t190443);
                double t190444 = omega*omega;
                double t190445 = t190442-1.0;
                double t190446 = 1.0/pow(rho_a[index],2.0/3.0);
                double t190447 = 1.0/omega;
                double t190448 = t190444*t190445*t190446*(3.774660826274405E31/1.146943242142761E33);
                double t190449 = -t190442+t190448+3.0/2.0;
                double t190450 = pow(rho_a[index],1.0/3.0);
                double t190451 = t190450*t190447*(2.394726750740845E16/6.143826841858749E15);
                double t190452 = erf(t190451);
                double t190453 = t190452*(3.991211251234741E15/2.251799813685248E15);
                double t190467 = omega*t190439*t190449*(6.143826841858749E15/2.394726750740845E16);
                double t190454 = t190453-t190467;
                double t190455 = 1.0/t190438;
                double t190456 = d*t190434*t190455*2.0;
                double t190457 = gamma_aa[index]*t190434;
                double t190458 = t190457+1.0;
                double t190459 = 1.0/sqrt(t190458);
                double t190460 = d*t190434*t190459*3.0;
                double t190461 = 1.0/sqrt(gamma_aa[index]);
                double t190462 = d*t190433*t190461*t190436*3.0;
                double t190463 = t190460+t190462;
                double t190464 = 1.0/(t190438*t190438);
                double t190465 = t190456-d*gamma_aa[index]*t190434*t190463*t190464*2.0;
                double t190466 = pow(rho_a[index],4.0/3.0);
                double t190468 = omega*t190454*t190439*(2.047942280619583E15/5.986816876852112E15);
                double t190469 = t190468-1.0;
                double t190470 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t190471 = 1.0/pow(rho_a[index],7.0/3.0);
                double t190472 = d*gamma_aa[index]*t190470*t190459*8.0;
                double t190473 = d*t190432*t190471*t190436*8.0;
                double t190474 = t190472+t190473;
                v_rho_a_gamma_aa_[index] = t190466*t190469*(d*t190470*t190455*(-1.6E1/3.0)+d*t190434*t190464*t190474* \
                   2.0+d*gamma_aa[index]*t190434*t190464*(d*t190470*t190459*1.2E1+d*t190461*t190471*t190436*4.0-d*gamma_aa[index]* \
                   1.0/pow(rho_a[index],1.9E1/3.0)*1.0/pow(t190458,3.0/2.0)*4.0)*2.0+d*gamma_aa[index]*t190470*t190463* \
                   t190464*(1.6E1/3.0)-d*gamma_aa[index]*t190434*t190463*1.0/(t190438*t190438*t190438)*t190474*4.0)*(1.0/ \
                   2.0)+t190450*t190465*t190469*(2.0/3.0)+t190465*t190466*(omega*t190439*(omega*t190439*((t190442*(1.0/ \
                   3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/3.0)*t190444*t190445*(1.258220275424802E31/5.734716210713804E32) \
                   -t190440*t190442*t190439*(1.146943242142761E33/1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16) \
                   +omega*t190433*t190449*(2.047942280619583E15/2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190442* \
                   t190446*t190447*(1.493415679873386E30/3.242500344799677E29))*(2.047942280619583E15/5.986816876852112E15) \
                   -omega*t190433*t190454*(2.047942280619583E15/1.796045063055634E16))*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                double t190896 = sqrt(gamma_aa[index]);
                double t190897 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190898 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190899 = t190896*t190897;
                double t190900 = log(t190899+sqrt(t190899*t190899+1.0));
                double t190901 = d*t190900*t190896*t190897*6.0;
                double t190902 = t190901+1.0;
                double t190903 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190904 = 1.0/(omega*omega);
                double t190905 = pow(rho_a[index],2.0/3.0);
                double t190907 = t190904*t190905*(5.734716210713804E32/3.774660826274405E31);
                double t190906 = exp(-t190907);
                double t190908 = omega*omega;
                double t190909 = t190906-1.0;
                double t190910 = 1.0/pow(rho_a[index],2.0/3.0);
                double t190911 = 1.0/omega;
                double t190912 = t190910*t190908*t190909*(3.774660826274405E31/1.146943242142761E33);
                double t190913 = t190912-t190906+3.0/2.0;
                double t190914 = pow(rho_a[index],1.0/3.0);
                double t190915 = t190911*t190914*(2.394726750740845E16/6.143826841858749E15);
                double t190916 = erf(t190915);
                double t190917 = t190916*(3.991211251234741E15/2.251799813685248E15);
                double t190931 = omega*t190903*t190913*(6.143826841858749E15/2.394726750740845E16);
                double t190918 = -t190931+t190917;
                double t190919 = 1.0/t190902;
                double t190920 = d*t190919*t190898*2.0;
                double t190921 = gamma_aa[index]*t190898;
                double t190922 = t190921+1.0;
                double t190923 = 1.0/sqrt(t190922);
                double t190924 = d*t190923*t190898*3.0;
                double t190925 = 1.0/sqrt(gamma_aa[index]);
                double t190926 = d*t190900*t190925*t190897*3.0;
                double t190927 = t190924+t190926;
                double t190928 = 1.0/(t190902*t190902);
                double t190929 = t190920-d*gamma_aa[index]*t190927*t190928*t190898*2.0;
                double t190930 = pow(rho_a[index],4.0/3.0);
                double t190932 = omega*t190903*t190918*(2.047942280619583E15/5.986816876852112E15);
                double t190933 = t190932-1.0;
                double t190934 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t190935 = 1.0/pow(rho_a[index],7.0/3.0);
                double t190936 = d*gamma_aa[index]*t190923*t190934*8.0;
                double t190937 = d*t190900*t190935*t190896*8.0;
                double t190938 = t190936+t190937;
                v_rho_a_gamma_aa_[index] = t190930*t190933*(d*t190934*t190919*(-1.6E1/3.0)+d*t190928*t190938*t190898* \
                   2.0+d*gamma_aa[index]*t190928*t190898*(d*t190923*t190934*1.2E1+d*t190900*t190925*t190935*4.0-d*gamma_aa[index]* \
                   1.0/pow(rho_a[index],1.9E1/3.0)*1.0/pow(t190922,3.0/2.0)*4.0)*2.0+d*gamma_aa[index]*t190934*t190927* \
                   t190928*(1.6E1/3.0)-d*gamma_aa[index]*1.0/(t190902*t190902*t190902)*t190927*t190938*t190898*4.0)*(1.0/ \
                   2.0)+t190914*t190933*t190929*(2.0/3.0)+t190930*t190929*(omega*t190903*(omega*t190903*((t190906*(1.0/ \
                   3.0))/rho_a[index]+1.0/pow(rho_a[index],5.0/3.0)*t190908*t190909*(1.258220275424802E31/5.734716210713804E32) \
                   -t190903*t190904*t190906*(1.146943242142761E33/1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16) \
                   +omega*t190913*t190897*(2.047942280619583E15/2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190910* \
                   t190911*t190906*(1.493415679873386E30/3.242500344799677E29))*(2.047942280619583E15/5.986816876852112E15) \
                   -omega*t190918*t190897*(2.047942280619583E15/1.796045063055634E16))*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_aa_[index] = 0.0;
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_rho_a_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else {
                v_rho_a_gamma_ab_[index] = 0.0;
            } 

            //V_rho_a_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else {
                v_rho_a_gamma_bb_[index] = 0.0;
            } 

            //V_rho_b_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else {
                v_rho_b_gamma_aa_[index] = 0.0;
            } 

            //V_rho_b_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else {
                v_rho_b_gamma_ab_[index] = 0.0;
            } 

            //V_rho_b_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190480 = sqrt(gamma_bb[index]);
                double t190481 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190482 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190483 = t190480*t190481;
                double t190484 = log(t190483+sqrt(t190483*t190483+1.0));
                double t190485 = d*t190480*t190481*t190484*6.0;
                double t190486 = t190485+1.0;
                double t190487 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190488 = 1.0/(omega*omega);
                double t190489 = pow(rho_b[index],2.0/3.0);
                double t190491 = t190488*t190489*(5.734716210713804E32/3.774660826274405E31);
                double t190490 = exp(-t190491);
                double t190492 = omega*omega;
                double t190493 = t190490-1.0;
                double t190494 = 1.0/pow(rho_b[index],2.0/3.0);
                double t190495 = 1.0/omega;
                double t190496 = t190492*t190493*t190494*(3.774660826274405E31/1.146943242142761E33);
                double t190497 = -t190490+t190496+3.0/2.0;
                double t190498 = pow(rho_b[index],1.0/3.0);
                double t190499 = t190495*t190498*(2.394726750740845E16/6.143826841858749E15);
                double t190500 = erf(t190499);
                double t190501 = t190500*(3.991211251234741E15/2.251799813685248E15);
                double t190515 = omega*t190487*t190497*(6.143826841858749E15/2.394726750740845E16);
                double t190502 = t190501-t190515;
                double t190503 = 1.0/t190486;
                double t190504 = d*t190503*t190482*2.0;
                double t190505 = gamma_bb[index]*t190482;
                double t190506 = t190505+1.0;
                double t190507 = 1.0/sqrt(t190506);
                double t190508 = d*t190507*t190482*3.0;
                double t190509 = 1.0/sqrt(gamma_bb[index]);
                double t190510 = d*t190481*t190509*t190484*3.0;
                double t190511 = t190510+t190508;
                double t190512 = 1.0/(t190486*t190486);
                double t190513 = t190504-d*gamma_bb[index]*t190511*t190512*t190482*2.0;
                double t190514 = pow(rho_b[index],4.0/3.0);
                double t190516 = omega*t190502*t190487*(2.047942280619583E15/5.986816876852112E15);
                double t190517 = t190516-1.0;
                double t190518 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t190519 = 1.0/pow(rho_b[index],7.0/3.0);
                double t190520 = d*gamma_bb[index]*t190507*t190518*8.0;
                double t190521 = d*t190480*t190519*t190484*8.0;
                double t190522 = t190520+t190521;
                v_rho_b_gamma_bb_[index] = t190514*t190517*(d*t190503*t190518*(-1.6E1/3.0)+d*t190512*t190522*t190482* \
                   2.0+d*gamma_bb[index]*t190512*t190482*(d*t190507*t190518*1.2E1+d*t190509*t190519*t190484*4.0-d*gamma_bb[index]* \
                   1.0/pow(rho_b[index],1.9E1/3.0)*1.0/pow(t190506,3.0/2.0)*4.0)*2.0+d*gamma_bb[index]*t190511*t190512* \
                   t190518*(1.6E1/3.0)-d*gamma_bb[index]*t190511*t190522*t190482*1.0/(t190486*t190486*t190486)*4.0)*(1.0/ \
                   2.0)+t190513*t190517*t190498*(2.0/3.0)+t190513*t190514*(omega*t190487*(omega*t190487*((t190490*(1.0/ \
                   3.0))/rho_b[index]+1.0/pow(rho_b[index],5.0/3.0)*t190492*t190493*(1.258220275424802E31/5.734716210713804E32) \
                   -t190490*t190487*t190488*(1.146943242142761E33/1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16) \
                   +omega*t190481*t190497*(2.047942280619583E15/2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190490* \
                   t190494*t190495*(1.493415679873386E30/3.242500344799677E29))*(2.047942280619583E15/5.986816876852112E15) \
                   -omega*t190502*t190481*(2.047942280619583E15/1.796045063055634E16))*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t190700 = sqrt(gamma_bb[index]);
                double t190701 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190702 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190703 = t190700*t190701;
                double t190704 = log(t190703+sqrt(t190703*t190703+1.0));
                double t190705 = d*t190700*t190701*t190704*6.0;
                double t190706 = t190705+1.0;
                double t190707 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190708 = 1.0/(omega*omega);
                double t190709 = pow(rho_b[index],2.0/3.0);
                double t190711 = t190708*t190709*(5.734716210713804E32/3.774660826274405E31);
                double t190710 = exp(-t190711);
                double t190712 = omega*omega;
                double t190713 = t190710-1.0;
                double t190714 = 1.0/pow(rho_b[index],2.0/3.0);
                double t190715 = 1.0/omega;
                double t190716 = t190712*t190713*t190714*(3.774660826274405E31/1.146943242142761E33);
                double t190717 = -t190710+t190716+3.0/2.0;
                double t190718 = pow(rho_b[index],1.0/3.0);
                double t190719 = t190715*t190718*(2.394726750740845E16/6.143826841858749E15);
                double t190720 = erf(t190719);
                double t190721 = t190720*(3.991211251234741E15/2.251799813685248E15);
                double t190735 = omega*t190707*t190717*(6.143826841858749E15/2.394726750740845E16);
                double t190722 = t190721-t190735;
                double t190723 = 1.0/t190706;
                double t190724 = d*t190702*t190723*2.0;
                double t190725 = gamma_bb[index]*t190702;
                double t190726 = t190725+1.0;
                double t190727 = 1.0/sqrt(t190726);
                double t190728 = d*t190702*t190727*3.0;
                double t190729 = 1.0/sqrt(gamma_bb[index]);
                double t190730 = d*t190701*t190704*t190729*3.0;
                double t190731 = t190730+t190728;
                double t190732 = 1.0/(t190706*t190706);
                double t190733 = t190724-d*gamma_bb[index]*t190702*t190731*t190732*2.0;
                double t190734 = pow(rho_b[index],4.0/3.0);
                double t190736 = omega*t190722*t190707*(2.047942280619583E15/5.986816876852112E15);
                double t190737 = t190736-1.0;
                double t190738 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t190739 = 1.0/pow(rho_b[index],7.0/3.0);
                double t190740 = d*gamma_bb[index]*t190727*t190738*8.0;
                double t190741 = d*t190700*t190704*t190739*8.0;
                double t190742 = t190740+t190741;
                v_rho_b_gamma_bb_[index] = t190734*t190737*(d*t190723*t190738*(-1.6E1/3.0)+d*t190702*t190732*t190742* \
                   2.0+d*gamma_bb[index]*t190702*t190732*(d*t190727*t190738*1.2E1+d*t190704*t190729*t190739*4.0-d*gamma_bb[index]* \
                   1.0/pow(rho_b[index],1.9E1/3.0)*1.0/pow(t190726,3.0/2.0)*4.0)*2.0+d*gamma_bb[index]*t190731*t190732* \
                   t190738*(1.6E1/3.0)-d*gamma_bb[index]*t190702*t190731*1.0/(t190706*t190706*t190706)*t190742*4.0)*(1.0/ \
                   2.0)+t190733*t190718*t190737*(2.0/3.0)+t190733*t190734*(omega*t190707*(omega*t190707*((t190710*(1.0/ \
                   3.0))/rho_b[index]+1.0/pow(rho_b[index],5.0/3.0)*t190712*t190713*(1.258220275424802E31/5.734716210713804E32) \
                   -t190710*t190707*t190708*(1.146943242142761E33/1.132398247882321E32))*(6.143826841858749E15/2.394726750740845E16) \
                   +omega*t190701*t190717*(2.047942280619583E15/2.394726750740845E16)+1.0/sqrt(3.141592653589793)*t190710* \
                   t190714*t190715*(1.493415679873386E30/3.242500344799677E29))*(2.047942280619583E15/5.986816876852112E15) \
                   -omega*t190701*t190722*(2.047942280619583E15/1.796045063055634E16))*(1.0/2.0);
            } else {
                v_rho_b_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190524 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190525 = 1.0/(omega*omega);
                double t190526 = pow(rho_a[index],2.0/3.0);
                double t190527 = exp(t190525*t190526*(-5.734716210713804E32/3.774660826274405E31));
                double t190528 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190529 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190530 = sqrt(gamma_aa[index]);
                double t190531 = t190530*t190529;
                double t190532 = log(t190531+sqrt(t190531*t190531+1.0));
                double t190533 = d*t190530*t190532*t190529*6.0;
                double t190534 = t190533+1.0;
                double t190535 = 1.0/(t190534*t190534);
                double t190536 = gamma_aa[index]*t190528;
                double t190537 = t190536+1.0;
                double t190538 = 1.0/sqrt(t190537);
                double t190539 = d*t190528*t190538*3.0;
                double t190540 = 1.0/sqrt(gamma_aa[index]);
                double t190541 = d*t190540*t190532*t190529*3.0;
                double t190542 = t190541+t190539;
                v_gamma_aa_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t190524*(erf((pow(rho_a[index],1.0/ \
                   3.0)*(2.394726750740845E16/6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15) \
                   -omega*t190524*(-t190527+(omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t190527-1.0)*(3.774660826274405E31/ \
                   1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/ \
                   5.986816876852112E15)-1.0)*(d*t190542*t190535*t190528*-4.0+d*gamma_aa[index]*(t190542*t190542)*1.0/ \
                   (t190534*t190534*t190534)*t190528*4.0+d*gamma_aa[index]*t190535*t190528*(d*1.0/pow(rho_a[index],1.6E1/ \
                   3.0)*1.0/pow(t190537,3.0/2.0)*(3.0/2.0)+d*1.0/pow(gamma_aa[index],3.0/2.0)*t190532*t190529*(3.0/2.0) \
                   -(d*t190528*t190538*(3.0/2.0))/gamma_aa[index])*2.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                double t190945 = 1.0/pow(rho_a[index],1.0/3.0);
                double t190946 = 1.0/(omega*omega);
                double t190947 = pow(rho_a[index],2.0/3.0);
                double t190948 = exp(t190946*t190947*(-5.734716210713804E32/3.774660826274405E31));
                double t190949 = 1.0/pow(rho_a[index],8.0/3.0);
                double t190950 = 1.0/pow(rho_a[index],4.0/3.0);
                double t190951 = sqrt(gamma_aa[index]);
                double t190952 = t190950*t190951;
                double t190953 = log(t190952+sqrt(t190952*t190952+1.0));
                double t190954 = d*t190950*t190951*t190953*6.0;
                double t190955 = t190954+1.0;
                double t190956 = 1.0/(t190955*t190955);
                double t190957 = gamma_aa[index]*t190949;
                double t190958 = t190957+1.0;
                double t190959 = 1.0/sqrt(t190958);
                double t190960 = d*t190949*t190959*3.0;
                double t190961 = 1.0/sqrt(gamma_aa[index]);
                double t190962 = d*t190950*t190961*t190953*3.0;
                double t190963 = t190960+t190962;
                v_gamma_aa_gamma_aa_[index] = pow(rho_a[index],4.0/3.0)*(omega*t190945*(erf((pow(rho_a[index],1.0/ \
                   3.0)*(2.394726750740845E16/6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15) \
                   -omega*t190945*(-t190948+(omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*(t190948-1.0)*(3.774660826274405E31/ \
                   1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/ \
                   5.986816876852112E15)-1.0)*(d*t190963*t190956*t190949*-4.0+d*gamma_aa[index]*(t190963*t190963)*1.0/ \
                   (t190955*t190955*t190955)*t190949*4.0+d*gamma_aa[index]*t190956*t190949*(d*1.0/pow(rho_a[index],1.6E1/ \
                   3.0)*1.0/pow(t190958,3.0/2.0)*(3.0/2.0)+d*1.0/pow(gamma_aa[index],3.0/2.0)*t190950*t190953*(3.0/2.0) \
                   -(d*t190949*t190959*(3.0/2.0))/gamma_aa[index])*2.0)*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_bb_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t190548 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190549 = 1.0/(omega*omega);
                double t190550 = pow(rho_b[index],2.0/3.0);
                double t190551 = exp(t190550*t190549*(-5.734716210713804E32/3.774660826274405E31));
                double t190552 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190553 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190554 = sqrt(gamma_bb[index]);
                double t190555 = t190553*t190554;
                double t190556 = log(t190555+sqrt(t190555*t190555+1.0));
                double t190557 = d*t190553*t190554*t190556*6.0;
                double t190558 = t190557+1.0;
                double t190559 = 1.0/(t190558*t190558);
                double t190560 = gamma_bb[index]*t190552;
                double t190561 = t190560+1.0;
                double t190562 = 1.0/sqrt(t190561);
                double t190563 = d*t190552*t190562*3.0;
                double t190564 = 1.0/sqrt(gamma_bb[index]);
                double t190565 = d*t190553*t190564*t190556*3.0;
                double t190566 = t190563+t190565;
                v_gamma_bb_gamma_bb_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190548*(erf((pow(rho_b[index],1.0/ \
                   3.0)*(2.394726750740845E16/6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15) \
                   -omega*t190548*(-t190551+(omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*(t190551-1.0)*(3.774660826274405E31/ \
                   1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/ \
                   5.986816876852112E15)-1.0)*(d*t190552*t190566*t190559*-4.0+d*gamma_bb[index]*t190552*(t190566*t190566) \
                   *1.0/(t190558*t190558*t190558)*4.0+d*gamma_bb[index]*t190552*t190559*(d*1.0/pow(rho_b[index],1.6E1/ \
                   3.0)*1.0/pow(t190561,3.0/2.0)*(3.0/2.0)-(d*t190552*t190562*(3.0/2.0))/gamma_bb[index]+d*1.0/pow(gamma_bb[index],3.0/ \
                   2.0)*t190553*t190556*(3.0/2.0))*2.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t190749 = 1.0/pow(rho_b[index],1.0/3.0);
                double t190750 = 1.0/(omega*omega);
                double t190751 = pow(rho_b[index],2.0/3.0);
                double t190752 = exp(t190750*t190751*(-5.734716210713804E32/3.774660826274405E31));
                double t190753 = 1.0/pow(rho_b[index],8.0/3.0);
                double t190754 = 1.0/pow(rho_b[index],4.0/3.0);
                double t190755 = sqrt(gamma_bb[index]);
                double t190756 = t190754*t190755;
                double t190757 = log(t190756+sqrt(t190756*t190756+1.0));
                double t190758 = d*t190754*t190755*t190757*6.0;
                double t190759 = t190758+1.0;
                double t190760 = 1.0/(t190759*t190759);
                double t190761 = gamma_bb[index]*t190753;
                double t190762 = t190761+1.0;
                double t190763 = 1.0/sqrt(t190762);
                double t190764 = d*t190753*t190763*3.0;
                double t190765 = 1.0/sqrt(gamma_bb[index]);
                double t190766 = d*t190754*t190765*t190757*3.0;
                double t190767 = t190764+t190766;
                v_gamma_bb_gamma_bb_[index] = pow(rho_b[index],4.0/3.0)*(omega*t190749*(erf((pow(rho_b[index],1.0/ \
                   3.0)*(2.394726750740845E16/6.143826841858749E15))/omega)*(3.991211251234741E15/2.251799813685248E15) \
                   -omega*t190749*(-t190752+(omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*(t190752-1.0)*(3.774660826274405E31/ \
                   1.146943242142761E33)+3.0/2.0)*(6.143826841858749E15/2.394726750740845E16))*(2.047942280619583E15/ \
                   5.986816876852112E15)-1.0)*(d*t190760*t190753*t190767*-4.0+d*gamma_bb[index]*t190753*(t190767*t190767) \
                   *1.0/(t190759*t190759*t190759)*4.0+d*gamma_bb[index]*t190760*t190753*(d*1.0/pow(rho_b[index],1.6E1/ \
                   3.0)*1.0/pow(t190762,3.0/2.0)*(3.0/2.0)-(d*t190753*t190763*(3.0/2.0))/gamma_bb[index]+d*1.0/pow(gamma_bb[index],3.0/ \
                   2.0)*t190754*t190757*(3.0/2.0))*2.0)*(1.0/2.0);
            } else {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_rho_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else {
                v_rho_a_tau_b_[index] = 0.0;
            } 

            //V_rho_b_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else {
                v_rho_b_tau_a_[index] = 0.0;
            } 

            //V_rho_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else {
                v_rho_b_tau_b_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else {
                v_tau_a_tau_b_[index] = 0.0;
            } 

            //V_tau_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else {
                v_tau_b_tau_b_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

                //V_gamma_aa_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } 

                //V_gamma_ab_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } 

                //V_gamma_ab_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } 

                //V_gamma_bb_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } 

                //V_gamma_bb_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } 

            }
        }
    }
}

}}

