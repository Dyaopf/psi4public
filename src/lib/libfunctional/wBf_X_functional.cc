/**********************************************************
* wBf_X_functional.cc: definitions for wBf_X_functional for KS-DFT
* Robert Parrish, robparrish@gmail.com
* Autogenerated by MATLAB Script on 07-Mar-2012
*
***********************************************************/
#include <libmints/mints.h>
#include <libfock/points.h>
#include "wBf_X_functional.h"
#include <stdlib.h>
#include <cmath>
#include <string>
#include <string>
#include <vector>

using namespace psi;
using namespace boost;
using namespace std;

namespace psi { namespace functional {

wBf_X_Functional::wBf_X_Functional(int npoints, int deriv) : Functional(npoints, deriv)
{

    name_ = "wBf_X";
    description_ = "SR Becke Exchange (Fake)";
    citation_ = "A.D. Becke, Phys. Rev. A, 38(6):3098-3100, 1988";

    double omega = 2.9999999999999999E-01;
    params_.push_back(make_pair("omega",omega));
    double d = 4.1999999999999997E-03;
    params_.push_back(make_pair("d",d));

    is_gga_ = true;
    is_meta_ = false;

    //Required allocateion
    allocate();
}
wBf_X_Functional::~wBf_X_Functional()
{
}
void wBf_X_Functional::computeRKSFunctional(boost::shared_ptr<RKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict gamma_aa;
    const double* restrict tau_a;

    rho_a = prop->property_value("RHO_A")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
    }

    double omega = params_[0].second;
    double d = params_[1].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_) {
            double t168039 = sqrt(gamma_aa[index]);
            double t168040 = 1.0/pow(rho_a[index],4.0/3.0);
            double t168041 = 1.0/pow(rho_a[index],1.0/3.0);
            double t168042 = 1.0/pow(rho_a[index],8.0/3.0);
            double t168043 = t168040*t168039;
            double t168044 = log(t168043+sqrt(t168043*t168043+1.0));
            double t168045 = d*t168040*t168044*t168039*6.0;
            double t168046 = t168045+1.0;
            double t168047 = 1.0/t168046;
            double t168048 = d*gamma_aa[index]*t168042*t168047*2.0;
            double t168049 = t168048+4.190715359480463E15/2.251799813685248E15;
            double t168050 = 1.0/(omega*omega);
            double t168051 = pow(rho_a[index],2.0/3.0);
            double t168052 = 1.0/t168049;
            double t168053 = exp(t168050*t168051*t168052*(-1.4000771998813E29/4.951760157141521E27));
            double t168054 = sqrt(t168049);
            functional_[index] = pow(rho_a[index],4.0/3.0)*t168049*(omega*t168041*t168054*(erf((pow(rho_a[index],1.0/ \
               3.0)*1.0/sqrt(t168049)*(3.74176054803257E14/7.0368744177664E13))/omega)*(3.991211251234741E15/2.251799813685248E15) \
               -omega*t168041*t168054*(-t168053+(omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*t168049*(t168053-1.0) \
               *(2.475880078570761E27/1.4000771998813E29)+3.0/2.0)*(7.0368744177664E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)-1.0);
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_) {
            double t168056 = sqrt(gamma_aa[index]);
            double t168057 = 1.0/pow(rho_a[index],4.0/3.0);
            double t168058 = 1.0/pow(rho_a[index],8.0/3.0);
            double t168059 = t168056*t168057;
            double t168060 = log(t168059+sqrt(t168059*t168059+1.0));
            double t168061 = d*t168060*t168056*t168057*6.0;
            double t168062 = t168061+1.0;
            double t168063 = 1.0/t168062;
            double t168064 = d*gamma_aa[index]*t168063*t168058*2.0;
            double t168065 = t168064+4.190715359480463E15/2.251799813685248E15;
            double t168066 = 1.0/(omega*omega);
            double t168067 = pow(rho_a[index],2.0/3.0);
            double t168068 = 1.0/t168065;
            double t168072 = t168066*t168067*t168068*(1.4000771998813E29/4.951760157141521E27);
            double t168069 = exp(-t168072);
            double t168070 = sqrt(t168065);
            double t168071 = 1.0/pow(rho_a[index],1.0/3.0);
            double t168073 = 1.0/omega;
            double t168074 = 1.0/pow(rho_a[index],2.0/3.0);
            double t168075 = 1.0/sqrt(t168065);
            double t168076 = pow(rho_a[index],1.0/3.0);
            double t168077 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t168078 = d*gamma_aa[index]*t168063*t168077*(1.6E1/3.0);
            double t168079 = 1.0/(t168062*t168062);
            double t168080 = gamma_aa[index]*t168058;
            double t168081 = t168080+1.0;
            double t168082 = 1.0/sqrt(t168081);
            double t168083 = d*gamma_aa[index]*t168082*t168077*8.0;
            double t168084 = 1.0/pow(rho_a[index],7.0/3.0);
            double t168085 = d*t168060*t168056*t168084*8.0;
            double t168086 = t168083+t168085;
            double t168090 = d*gamma_aa[index]*t168058*t168086*t168079*2.0;
            double t168087 = -t168090+t168078;
            double t168088 = omega*omega;
            double t168089 = t168069-1.0;
            double t168091 = t168071*t168066*t168068*(1.4000771998813E29/7.427640235712282E27);
            double t168092 = 1.0/(t168065*t168065);
            double t168093 = t168092*t168066*t168067*t168087*(1.4000771998813E29/4.951760157141521E27);
            double t168094 = t168091+t168093;
            double t168095 = t168065*t168074*t168088*t168089*(2.475880078570761E27/1.4000771998813E29);
            double t168096 = t168095-t168069+3.0/2.0;
            double t168097 = t168073*t168075*t168076*(3.74176054803257E14/7.0368744177664E13);
            double t168098 = erf(t168097);
            double t168099 = t168098*(3.991211251234741E15/2.251799813685248E15);
            double t168102 = omega*t168070*t168071*t168096*(7.0368744177664E13/3.74176054803257E14);
            double t168100 = -t168102+t168099;
            double t168101 = pow(rho_a[index],4.0/3.0);
            double t168103 = omega*t168100*t168070*t168071*(2.81474976710656E14/1.122528164409771E15);
            double t168104 = t168103-1.0;
            v_rho_a_[index] = t168101*t168065*(omega*t168100*t168070*t168057*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t168070*t168071*(1.0/sqrt(3.141592653589793)*t168069*(t168073*t168074*t168075*(3.74176054803257E14/ \
               2.11106232532992E14)+t168073*1.0/pow(t168065,3.0/2.0)*t168076*t168087*(3.74176054803257E14/1.40737488355328E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t168070*t168057*t168096*(7.0368744177664E13/1.122528164409771E15) \
               +omega*t168070*t168071*(-t168094*t168069+t168074*t168087*t168088*t168089*(2.475880078570761E27/1.4000771998813E29) \
               +1.0/pow(rho_a[index],5.0/3.0)*t168065*t168088*t168089*(4.951760157141521E27/4.2002315996439E29)+t168065* \
               t168074*t168094*t168069*t168088*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14) \
               +omega*t168071*t168075*t168087*t168096*(3.5184372088832E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)+omega*t168100*t168071*t168075*t168087*(1.40737488355328E14/1.122528164409771E15) \
               )*(-1.0/2.0)-t168101*t168104*t168087*(1.0/2.0)+t168104*t168065*t168076*(2.0/3.0);
        } else {
            v_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            if (rho_a[index] > cutoff_) {
                double t168106 = sqrt(gamma_aa[index]);
                double t168107 = 1.0/pow(rho_a[index],4.0/3.0);
                double t168108 = 1.0/pow(rho_a[index],1.0/3.0);
                double t168109 = 1.0/pow(rho_a[index],8.0/3.0);
                double t168110 = t168106*t168107;
                double t168111 = log(t168110+sqrt(t168110*t168110+1.0));
                double t168112 = d*t168111*t168106*t168107*6.0;
                double t168113 = t168112+1.0;
                double t168114 = 1.0/t168113;
                double t168115 = d*gamma_aa[index]*t168114*t168109*2.0;
                double t168116 = t168115+4.190715359480463E15/2.251799813685248E15;
                double t168117 = 1.0/(omega*omega);
                double t168118 = pow(rho_a[index],2.0/3.0);
                double t168119 = 1.0/t168116;
                double t168123 = t168117*t168118*t168119*(1.4000771998813E29/4.951760157141521E27);
                double t168120 = exp(-t168123);
                double t168121 = sqrt(t168116);
                double t168122 = pow(rho_a[index],4.0/3.0);
                double t168124 = d*t168114*t168109*2.0;
                double t168125 = gamma_aa[index]*t168109;
                double t168126 = t168125+1.0;
                double t168127 = 1.0/sqrt(t168126);
                double t168128 = d*t168109*t168127*3.0;
                double t168129 = 1.0/sqrt(gamma_aa[index]);
                double t168130 = d*t168111*t168107*t168129*3.0;
                double t168131 = t168130+t168128;
                double t168132 = 1.0/(t168113*t168113);
                double t168137 = d*gamma_aa[index]*t168131*t168132*t168109*2.0;
                double t168133 = t168124-t168137;
                double t168134 = omega*omega;
                double t168135 = 1.0/pow(rho_a[index],2.0/3.0);
                double t168136 = t168120-1.0;
                double t168138 = 1.0/sqrt(t168116);
                double t168139 = t168116*t168134*t168135*t168136*(2.475880078570761E27/1.4000771998813E29);
                double t168140 = -t168120+t168139+3.0/2.0;
                double t168141 = 1.0/omega;
                double t168142 = pow(rho_a[index],1.0/3.0);
                double t168143 = t168141*t168142*t168138*(3.74176054803257E14/7.0368744177664E13);
                double t168144 = erf(t168143);
                double t168145 = t168144*(3.991211251234741E15/2.251799813685248E15);
                double t168146 = t168145-omega*t168121*t168140*t168108*(7.0368744177664E13/3.74176054803257E14);
                v_gamma_aa_[index] = -t168122*t168116*(omega*t168121*t168108*(omega*t168121*t168108*(t168120*t168133* \
                   t168119*(1.0/2.0)+t168133*t168134*t168135*t168136*(2.475880078570761E27/1.4000771998813E29)-t168120* \
                   t168133*1.0/(t168116*t168116)*t168117*t168118*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t168140*t168133*t168108*t168138*(3.5184372088832E13/3.74176054803257E14) \
                   +1.0/sqrt(3.141592653589793)*t168120*t168141*t168133*t168142*1.0/pow(t168116,3.0/2.0)*(1.493415679873386E30/ \
                   1.584563250285287E29))*(2.81474976710656E14/1.122528164409771E15)-omega*t168133*t168108*t168146*t168138* \
                   (1.40737488355328E14/1.122528164409771E15))+t168122*t168133*(omega*t168121*t168108*t168146*(2.81474976710656E14/ \
                   1.122528164409771E15)-1.0);
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_) {
            double t168149 = sqrt(gamma_aa[index]);
            double t168150 = 1.0/pow(rho_a[index],4.0/3.0);
            double t168151 = t168150*t168149;
            double t168152 = log(t168151+sqrt(t168151*t168151+1.0));
            double t168153 = d*t168150*t168152*t168149*6.0;
            double t168154 = t168153+1.0;
            double t168155 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t168156 = 1.0/pow(rho_a[index],8.0/3.0);
            double t168157 = 1.0/t168154;
            double t168158 = d*gamma_aa[index]*t168156*t168157*2.0;
            double t168159 = t168158+4.190715359480463E15/2.251799813685248E15;
            double t168160 = 1.0/(omega*omega);
            double t168161 = pow(rho_a[index],2.0/3.0);
            double t168162 = 1.0/t168159;
            double t168166 = t168160*t168161*t168162*(1.4000771998813E29/4.951760157141521E27);
            double t168163 = exp(-t168166);
            double t168164 = sqrt(t168159);
            double t168165 = 1.0/pow(rho_a[index],1.0/3.0);
            double t168167 = 1.0/omega;
            double t168168 = 1.0/pow(rho_a[index],2.0/3.0);
            double t168169 = 1.0/sqrt(t168159);
            double t168170 = pow(rho_a[index],1.0/3.0);
            double t168171 = d*gamma_aa[index]*t168155*t168157*(1.6E1/3.0);
            double t168172 = 1.0/(t168154*t168154);
            double t168173 = gamma_aa[index]*t168156;
            double t168174 = t168173+1.0;
            double t168175 = 1.0/sqrt(t168174);
            double t168176 = d*gamma_aa[index]*t168155*t168175*8.0;
            double t168177 = 1.0/pow(rho_a[index],7.0/3.0);
            double t168178 = d*t168152*t168149*t168177*8.0;
            double t168179 = t168176+t168178;
            double t168181 = d*gamma_aa[index]*t168172*t168156*t168179*2.0;
            double t168180 = t168171-t168181;
            double t168182 = omega*omega;
            double t168183 = t168163-1.0;
            double t168184 = t168160*t168162*t168165*(1.4000771998813E29/7.427640235712282E27);
            double t168185 = 1.0/(t168159*t168159);
            double t168186 = t168160*t168161*t168180*t168185*(1.4000771998813E29/4.951760157141521E27);
            double t168187 = t168184+t168186;
            double t168188 = t168182*t168183*t168159*t168168*(2.475880078570761E27/1.4000771998813E29);
            double t168189 = -t168163+t168188+3.0/2.0;
            double t168190 = t168170*t168167*t168169*(3.74176054803257E14/7.0368744177664E13);
            double t168191 = erf(t168190);
            double t168192 = t168191*(3.991211251234741E15/2.251799813685248E15);
            double t168195 = omega*t168164*t168165*t168189*(7.0368744177664E13/3.74176054803257E14);
            double t168193 = t168192-t168195;
            double t168194 = pow(rho_a[index],4.0/3.0);
            double t168196 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t168197 = omega*t168150*t168164*t168193*(2.81474976710656E14/3.367584493229313E15);
            double t168198 = 1.0/sqrt(3.141592653589793);
            double t168199 = t168167*t168168*t168169*(3.74176054803257E14/2.11106232532992E14);
            double t168200 = 1.0/pow(t168159,3.0/2.0);
            double t168201 = t168200*t168170*t168180*t168167*(3.74176054803257E14/1.40737488355328E14);
            double t168202 = t168201+t168199;
            double t168203 = t168202*t168163*t168198*(3.991211251234741E15/1.125899906842624E15);
            double t168204 = t168180*t168182*t168183*t168168*(2.475880078570761E27/1.4000771998813E29);
            double t168205 = 1.0/pow(rho_a[index],5.0/3.0);
            double t168206 = t168205*t168182*t168183*t168159*(4.951760157141521E27/4.2002315996439E29);
            double t168207 = t168163*t168182*t168159*t168168*t168187*(2.475880078570761E27/1.4000771998813E29) \
               ;
            double t168217 = t168163*t168187;
            double t168208 = t168204+t168206+t168207-t168217;
            double t168209 = omega*t168208*t168164*t168165*(7.0368744177664E13/3.74176054803257E14);
            double t168210 = omega*t168150*t168164*t168189*(7.0368744177664E13/1.122528164409771E15);
            double t168211 = omega*t168180*t168165*t168169*t168189*(3.5184372088832E13/3.74176054803257E14);
            double t168212 = t168210+t168211+t168203+t168209;
            double t168213 = omega*t168180*t168165*t168193*t168169*(1.40737488355328E14/1.122528164409771E15) \
               ;
            double t168214 = t168213+t168197-omega*t168212*t168164*t168165*(2.81474976710656E14/1.122528164409771E15) \
               ;
            double t168215 = omega*t168164*t168165*t168193*(2.81474976710656E14/1.122528164409771E15);
            double t168216 = t168215-1.0;
            double t168218 = d*gamma_aa[index]*t168157*t168196*(1.76E2/9.0);
            double t168219 = 1.0/(t168154*t168154*t168154);
            double t168220 = t168179*t168179;
            double t168221 = d*gamma_aa[index]*t168220*t168156*t168219*4.0;
            double t168222 = d*gamma_aa[index]*t168175*t168196*4.0E1;
            double t168223 = gamma_aa[index]*gamma_aa[index];
            double t168224 = 1.0/pow(rho_a[index],2.2E1/3.0);
            double t168225 = 1.0/pow(t168174,3.0/2.0);
            double t168226 = 1.0/pow(rho_a[index],1.0E1/3.0);
            double t168227 = d*t168152*t168226*t168149*(5.6E1/3.0);
            double t168231 = d*t168223*t168224*t168225*(3.2E1/3.0);
            double t168228 = t168222-t168231+t168227;
            double t168232 = d*gamma_aa[index]*t168172*t168156*t168228*2.0;
            double t168233 = d*gamma_aa[index]*t168172*t168155*t168179*(3.2E1/3.0);
            double t168229 = t168221-t168232-t168233+t168218;
            double t168230 = t168180*t168180;
            double t168234 = t168150*t168160*t168162*(1.4000771998813E29/2.228292070713684E28);
            double t168235 = 1.0/(t168159*t168159*t168159);
            double t168236 = t168160*t168161*t168229*t168185*(1.4000771998813E29/4.951760157141521E27);
            double t168237 = t168234+t168236-t168230*t168160*t168161*t168235*(1.4000771998813E29/2.475880078570761E27) \
               -t168160*t168180*t168165*t168185*(1.4000771998813E29/3.713820117856141E27);
            double t168238 = t168187*t168187;
            v_rho_a_rho_a_[index] = t168194*t168159*(omega*t168212*t168150*t168164*(5.62949953421312E14/3.367584493229313E15) \
               -omega*t168164*t168193*t168177*(1.125899906842624E15/1.010275347968794E16)+omega*t168164*t168165*(t168163* \
               t168198*(t168205*t168167*t168169*(3.74176054803257E14/3.16659348799488E14)+t168200*t168170*t168229* \
               t168167*(3.74176054803257E14/1.40737488355328E14)-t168200*t168180*t168167*t168168*(3.74176054803257E14/ \
               2.11106232532992E14)-t168230*t168170*t168167*1.0/pow(t168159,5.0/2.0)*(1.122528164409771E15/2.81474976710656E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t168150*t168208*t168164*(1.40737488355328E14/1.122528164409771E15) \
               +omega*t168164*t168177*t168189*(2.81474976710656E14/3.367584493229313E15)+t168202*t168163*t168187* \
               t168198*(3.991211251234741E15/1.125899906842624E15)+omega*t168164*t168165*(-t168163*t168237-t168163* \
               t168238+t168205*t168180*t168182*t168183*(9.903520314283042E27/4.2002315996439E29)+t168182*t168156* \
               t168183*t168159*(2.475880078570761E28/1.26006947989317E30)+t168182*t168183*t168229*t168168*(2.475880078570761E27/ \
               1.4000771998813E29)+t168205*t168163*t168182*t168159*t168187*(9.903520314283042E27/4.2002315996439E29) \
               +t168180*t168163*t168182*t168168*t168187*(4.951760157141521E27/1.4000771998813E29)+t168163*t168182* \
               t168237*t168159*t168168*(2.475880078570761E27/1.4000771998813E29)+t168163*t168182*t168238*t168159* \
               t168168*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14)-omega* \
               t168200*t168230*t168165*t168189*(1.7592186044416E13/3.74176054803257E14)+omega*t168180*t168208*t168165* \
               t168169*(7.0368744177664E13/3.74176054803257E14)+omega*t168150*t168180*t168169*t168189*(7.0368744177664E13/ \
               1.122528164409771E15)+omega*t168165*t168229*t168169*t168189*(3.5184372088832E13/3.74176054803257E14) \
               )*(2.81474976710656E14/1.122528164409771E15)+omega*t168200*t168230*t168165*t168193*(7.0368744177664E13/ \
               1.122528164409771E15)+omega*t168212*t168180*t168165*t168169*(2.81474976710656E14/1.122528164409771E15) \
               -omega*t168150*t168180*t168193*t168169*(2.81474976710656E14/3.367584493229313E15)-omega*t168165*t168193* \
               t168229*t168169*(1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)-t168170*t168180*t168216*(4.0/ \
               3.0)-t168214*t168170*t168159*(4.0/3.0)+t168214*t168180*t168194+t168216*t168229*t168194*(1.0/2.0)+t168216* \
               t168159*t168168*(2.0/9.0);
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t168240 = sqrt(gamma_aa[index]);
                double t168241 = 1.0/pow(rho_a[index],4.0/3.0);
                double t168242 = 1.0/pow(rho_a[index],8.0/3.0);
                double t168243 = t168240*t168241;
                double t168244 = log(t168243+sqrt(t168243*t168243+1.0));
                double t168245 = d*t168240*t168241*t168244*6.0;
                double t168246 = t168245+1.0;
                double t168247 = 1.0/t168246;
                double t168248 = d*gamma_aa[index]*t168242*t168247*2.0;
                double t168249 = t168248+4.190715359480463E15/2.251799813685248E15;
                double t168250 = 1.0/(omega*omega);
                double t168251 = pow(rho_a[index],2.0/3.0);
                double t168252 = 1.0/t168249;
                double t168256 = t168250*t168251*t168252*(1.4000771998813E29/4.951760157141521E27);
                double t168253 = exp(-t168256);
                double t168254 = sqrt(t168249);
                double t168255 = 1.0/pow(rho_a[index],1.0/3.0);
                double t168257 = 1.0/omega;
                double t168258 = 1.0/pow(rho_a[index],2.0/3.0);
                double t168259 = 1.0/sqrt(t168249);
                double t168260 = pow(rho_a[index],1.0/3.0);
                double t168261 = 1.0/(t168246*t168246);
                double t168262 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t168263 = gamma_aa[index]*t168242;
                double t168264 = t168263+1.0;
                double t168265 = 1.0/sqrt(t168264);
                double t168266 = d*gamma_aa[index]*t168262*t168247*(1.6E1/3.0);
                double t168267 = d*gamma_aa[index]*t168262*t168265*8.0;
                double t168268 = 1.0/pow(rho_a[index],7.0/3.0);
                double t168269 = d*t168240*t168244*t168268*8.0;
                double t168270 = t168267+t168269;
                double t168274 = d*gamma_aa[index]*t168242*t168261*t168270*2.0;
                double t168271 = -t168274+t168266;
                double t168272 = omega*omega;
                double t168273 = t168253-1.0;
                double t168275 = t168250*t168252*t168255*(1.4000771998813E29/7.427640235712282E27);
                double t168276 = 1.0/(t168249*t168249);
                double t168277 = t168250*t168251*t168271*t168276*(1.4000771998813E29/4.951760157141521E27);
                double t168278 = t168275+t168277;
                double t168279 = t168272*t168273*t168249*t168258*(2.475880078570761E27/1.4000771998813E29);
                double t168280 = -t168253+t168279+3.0/2.0;
                double t168281 = t168260*t168257*t168259*(3.74176054803257E14/7.0368744177664E13);
                double t168282 = erf(t168281);
                double t168283 = t168282*(3.991211251234741E15/2.251799813685248E15);
                double t168331 = omega*t168280*t168254*t168255*(7.0368744177664E13/3.74176054803257E14);
                double t168284 = -t168331+t168283;
                double t168285 = pow(rho_a[index],4.0/3.0);
                double t168286 = 1.0/sqrt(3.141592653589793);
                double t168287 = 1.0/pow(t168249,3.0/2.0);
                double t168288 = d*t168242*t168247*2.0;
                double t168289 = d*t168242*t168265*3.0;
                double t168290 = 1.0/sqrt(gamma_aa[index]);
                double t168291 = d*t168241*t168244*t168290*3.0;
                double t168292 = t168291+t168289;
                double t168294 = d*gamma_aa[index]*t168242*t168261*t168292*2.0;
                double t168293 = -t168294+t168288;
                double t168295 = d*t168242*t168261*t168270*2.0;
                double t168296 = d*gamma_aa[index]*t168261*t168262*t168292*(1.6E1/3.0);
                double t168297 = d*t168262*t168265*1.2E1;
                double t168298 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t168299 = 1.0/pow(t168264,3.0/2.0);
                double t168300 = d*t168244*t168290*t168268*4.0;
                double t168307 = d*gamma_aa[index]*t168298*t168299*4.0;
                double t168301 = t168300-t168307+t168297;
                double t168302 = d*gamma_aa[index]*t168301*t168242*t168261*2.0;
                double t168303 = 1.0/(t168246*t168246*t168246);
                double t168306 = d*t168262*t168247*(1.6E1/3.0);
                double t168308 = d*gamma_aa[index]*t168303*t168242*t168270*t168292*4.0;
                double t168304 = t168302-t168306-t168308+t168295+t168296;
                double t168305 = 1.0/pow(rho_a[index],5.0/3.0);
                double t168309 = t168250*t168255*t168293*t168276*(1.4000771998813E29/7.427640235712282E27);
                double t168310 = t168250*t168304*t168251*t168276*(1.4000771998813E29/4.951760157141521E27);
                double t168311 = 1.0/(t168249*t168249*t168249);
                double t168312 = t168311*t168250*t168251*t168271*t168293*(1.4000771998813E29/2.475880078570761E27) \
                   ;
                double t168313 = t168310+t168312+t168309;
                double t168314 = t168252*t168253*t168293*(1.0/2.0);
                double t168315 = t168272*t168273*t168293*t168258*(2.475880078570761E27/1.4000771998813E29);
                double t168324 = t168250*t168251*t168253*t168293*t168276*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t168316 = t168314+t168315-t168324;
                double t168317 = t168271*t168272*t168273*t168258*(2.475880078570761E27/1.4000771998813E29);
                double t168318 = t168305*t168272*t168273*t168249*(4.951760157141521E27/4.2002315996439E29);
                double t168319 = t168253*t168272*t168249*t168258*t168278*(2.475880078570761E27/1.4000771998813E29) \
                   ;
                double t168326 = t168253*t168278;
                double t168320 = t168317-t168326+t168318+t168319;
                double t168321 = t168257*t168258*t168259*(3.74176054803257E14/2.11106232532992E14);
                double t168322 = t168260*t168271*t168257*t168287*(3.74176054803257E14/1.40737488355328E14);
                double t168323 = t168321+t168322;
                double t168325 = t168323*t168253*t168286*(3.991211251234741E15/1.125899906842624E15);
                double t168327 = omega*t168320*t168254*t168255*(7.0368744177664E13/3.74176054803257E14);
                double t168328 = omega*t168241*t168280*t168254*(7.0368744177664E13/1.122528164409771E15);
                double t168329 = omega*t168271*t168280*t168255*t168259*(3.5184372088832E13/3.74176054803257E14);
                double t168330 = t168325+t168327+t168328+t168329;
                double t168332 = omega*t168316*t168254*t168255*(7.0368744177664E13/3.74176054803257E14);
                double t168333 = omega*t168280*t168255*t168293*t168259*(3.5184372088832E13/3.74176054803257E14);
                double t168334 = t168260*t168253*t168257*t168293*t168286*t168287*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t168335 = t168332+t168333+t168334;
                double t168336 = omega*t168254*t168255*t168284*(2.81474976710656E14/1.122528164409771E15);
                double t168337 = t168336-1.0;
                double t168338 = omega*t168254*t168335*t168255*(2.81474976710656E14/1.122528164409771E15);
                double t168339 = t168338-omega*t168255*t168284*t168293*t168259*(1.40737488355328E14/1.122528164409771E15) \
                   ;
                v_rho_a_gamma_aa_[index] = t168249*t168285*(omega*t168254*t168255*(t168253*t168286*(t168304*t168260* \
                   t168257*t168287*(3.74176054803257E14/1.40737488355328E14)+t168257*t168293*t168258*t168287*(3.74176054803257E14/ \
                   4.22212465065984E14)+t168260*t168271*t168257*t168293*1.0/pow(t168249,5.0/2.0)*(1.122528164409771E15/ \
                   2.81474976710656E14))*(-3.991211251234741E15/1.125899906842624E15)+omega*t168241*t168316*t168254*(7.0368744177664E13/ \
                   1.122528164409771E15)+omega*t168254*t168255*(t168313*t168253-t168304*t168272*t168273*t168258*(2.475880078570761E27/ \
                   1.4000771998813E29)+t168305*t168272*t168273*t168293*(4.951760157141521E27/4.2002315996439E29)+t168253* \
                   t168271*t168293*t168276*(1.0/2.0)+t168252*t168253*t168293*t168278*(1.0/2.0)+(t168252*t168253*t168293* \
                   (1.0/3.0))/rho_a[index]-t168313*t168253*t168272*t168249*t168258*(2.475880078570761E27/1.4000771998813E29) \
                   +t168253*t168272*t168293*t168258*t168278*(2.475880078570761E27/1.4000771998813E29)-t168250*t168251* \
                   t168253*t168293*t168276*t168278*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/3.74176054803257E14) \
                   -omega*t168304*t168280*t168255*t168259*(3.5184372088832E13/3.74176054803257E14)+omega*t168320*t168255* \
                   t168293*t168259*(3.5184372088832E13/3.74176054803257E14)+omega*t168241*t168280*t168293*t168259*(3.5184372088832E13/ \
                   1.122528164409771E15)+omega*t168271*t168316*t168255*t168259*(3.5184372088832E13/3.74176054803257E14) \
                   -omega*t168271*t168280*t168255*t168293*t168287*(1.7592186044416E13/3.74176054803257E14)+t168250*t168251* \
                   t168323*t168253*t168293*t168276*t168286*(5.588003872763475E44/5.575186299632656E42))*(2.81474976710656E14/ \
                   1.122528164409771E15)+omega*t168241*t168254*t168335*(2.81474976710656E14/3.367584493229313E15)+omega* \
                   t168330*t168255*t168293*t168259*(1.40737488355328E14/1.122528164409771E15)+omega*t168304*t168255*t168284* \
                   t168259*(1.40737488355328E14/1.122528164409771E15)+omega*t168271*t168335*t168255*t168259*(1.40737488355328E14/ \
                   1.122528164409771E15)-omega*t168241*t168284*t168293*t168259*(1.40737488355328E14/3.367584493229313E15) \
                   +omega*t168271*t168255*t168284*t168293*t168287*(7.0368744177664E13/1.122528164409771E15))*(1.0/2.0) \
                   -t168293*t168285*(omega*t168330*t168254*t168255*(-2.81474976710656E14/1.122528164409771E15)+omega* \
                   t168241*t168254*t168284*(2.81474976710656E14/3.367584493229313E15)+omega*t168271*t168255*t168284*t168259* \
                   (1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)+t168304*t168337*t168285*(1.0/2.0)+t168260*t168337* \
                   t168293*(2.0/3.0)-t168260*t168249*t168339*(2.0/3.0)+t168271*t168285*t168339*(1.0/2.0);
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t168341 = sqrt(gamma_aa[index]);
                double t168342 = 1.0/pow(rho_a[index],4.0/3.0);
                double t168343 = 1.0/pow(rho_a[index],1.0/3.0);
                double t168344 = 1.0/pow(rho_a[index],8.0/3.0);
                double t168345 = t168341*t168342;
                double t168346 = log(t168345+sqrt(t168345*t168345+1.0));
                double t168347 = d*t168341*t168342*t168346*6.0;
                double t168348 = t168347+1.0;
                double t168349 = 1.0/t168348;
                double t168350 = d*gamma_aa[index]*t168344*t168349*2.0;
                double t168351 = t168350+4.190715359480463E15/2.251799813685248E15;
                double t168352 = 1.0/(omega*omega);
                double t168353 = pow(rho_a[index],2.0/3.0);
                double t168354 = 1.0/t168351;
                double t168366 = t168352*t168353*t168354*(1.4000771998813E29/4.951760157141521E27);
                double t168355 = exp(-t168366);
                double t168356 = sqrt(t168351);
                double t168357 = 1.0/(t168348*t168348);
                double t168358 = gamma_aa[index]*t168344;
                double t168359 = t168358+1.0;
                double t168360 = 1.0/sqrt(t168359);
                double t168361 = d*t168360*t168344*3.0;
                double t168362 = 1.0/sqrt(gamma_aa[index]);
                double t168363 = d*t168342*t168362*t168346*3.0;
                double t168364 = t168361+t168363;
                double t168365 = pow(rho_a[index],4.0/3.0);
                double t168367 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t168368 = 1.0/pow(t168359,3.0/2.0);
                double t168369 = d*t168367*t168368*(3.0/2.0);
                double t168370 = 1.0/gamma_aa[index];
                double t168371 = 1.0/pow(gamma_aa[index],3.0/2.0);
                double t168372 = d*t168342*t168371*t168346*(3.0/2.0);
                double t168383 = d*t168360*t168370*t168344*(3.0/2.0);
                double t168373 = t168372-t168383+t168369;
                double t168374 = d*gamma_aa[index]*t168344*t168373*t168357*2.0;
                double t168375 = t168364*t168364;
                double t168376 = 1.0/(t168348*t168348*t168348);
                double t168377 = d*gamma_aa[index]*t168344*t168375*t168376*4.0;
                double t168382 = d*t168344*t168364*t168357*4.0;
                double t168378 = -t168382+t168374+t168377;
                double t168379 = omega*omega;
                double t168380 = 1.0/pow(rho_a[index],2.0/3.0);
                double t168381 = t168355-1.0;
                double t168385 = d*t168344*t168349*2.0;
                double t168386 = d*gamma_aa[index]*t168344*t168364*t168357*2.0;
                double t168384 = t168385-t168386;
                double t168387 = t168384*t168384;
                double t168388 = 1.0/sqrt(t168351);
                double t168389 = 1.0/(t168351*t168351);
                double t168390 = t168351*t168380*t168381*t168379*(2.475880078570761E27/1.4000771998813E29);
                double t168391 = t168390-t168355+3.0/2.0;
                double t168392 = 1.0/omega;
                double t168393 = pow(rho_a[index],1.0/3.0);
                double t168394 = 1.0/pow(t168351,3.0/2.0);
                double t168395 = 1.0/sqrt(3.141592653589793);
                double t168396 = t168392*t168393*t168388*(3.74176054803257E14/7.0368744177664E13);
                double t168397 = erf(t168396);
                double t168398 = t168397*(3.991211251234741E15/2.251799813685248E15);
                double t168403 = omega*t168343*t168391*t168356*(7.0368744177664E13/3.74176054803257E14);
                double t168399 = -t168403+t168398;
                double t168400 = t168354*t168355*t168384*(1.0/2.0);
                double t168401 = t168380*t168381*t168384*t168379*(2.475880078570761E27/1.4000771998813E29);
                double t168404 = t168352*t168353*t168355*t168384*t168389*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t168402 = t168400+t168401-t168404;
                double t168405 = omega*t168402*t168343*t168356*(7.0368744177664E13/3.74176054803257E14);
                double t168406 = omega*t168343*t168391*t168384*t168388*(3.5184372088832E13/3.74176054803257E14);
                double t168407 = t168355*t168392*t168384*t168393*t168394*t168395*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t168408 = t168405+t168406+t168407;
                v_gamma_aa_gamma_aa_[index] = t168365*t168384*(omega*t168343*t168408*t168356*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t168343*t168384*t168388*t168399*(1.40737488355328E14/1.122528164409771E15) \
                   )*-2.0-t168351*t168365*(omega*t168343*t168356*(omega*t168343*t168356*(t168354*t168355*t168378*(1.0/ \
                   2.0)+t168380*t168381*t168378*t168379*(2.475880078570761E27/1.4000771998813E29)+1.0/(t168351*t168351* \
                   t168351)*t168352*t168353*t168355*t168387*(7.000385999406499E29/9.903520314283042E27)-1.0/(omega*omega* \
                   omega*omega)*1.0/(t168351*t168351*t168351*t168351)*t168355*t168365*t168387*(1.960216165627461E58/2.451992865385422E55) \
                   -t168352*t168353*t168355*t168378*t168389*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t168402*t168343*t168384*t168388*(7.0368744177664E13/3.74176054803257E14) \
                   -omega*t168343*t168391*t168394*t168387*(1.7592186044416E13/3.74176054803257E14)+omega*t168343*t168391* \
                   t168378*t168388*(3.5184372088832E13/3.74176054803257E14)+t168355*t168392*t168393*t168394*t168395*t168378* \
                   (1.493415679873386E30/1.584563250285287E29)-1.0/pow(t168351,5.0/2.0)*t168355*t168392*t168393*t168395* \
                   t168387*(4.480247039620159E30/3.169126500570574E29)+1.0/(omega*omega*omega)*rho_a[index]*1.0/pow(t168351,7.0/ \
                   2.0)*t168355*t168395*t168387*(2.090897243335959E59/7.846377169233351E56))*(2.81474976710656E14/1.122528164409771E15) \
                   +omega*t168343*t168408*t168384*t168388*(2.81474976710656E14/1.122528164409771E15)+omega*t168343*t168394* \
                   t168387*t168399*(7.0368744177664E13/1.122528164409771E15)-omega*t168343*t168378*t168388*t168399*(1.40737488355328E14/ \
                   1.122528164409771E15))+t168365*t168378*(omega*t168343*t168356*t168399*(2.81474976710656E14/1.122528164409771E15) \
                   -1.0);
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

            }
        }
    }
}
void wBf_X_Functional::computeUKSFunctional(boost::shared_ptr<UKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict rho_b;
    const double* restrict gamma_aa;
    const double* restrict gamma_ab;
    const double* restrict gamma_bb;
    const double* restrict tau_a;
    const double* restrict tau_b;

    rho_a = prop->property_value("RHO_A")->pointer();
    rho_b = prop->property_value("RHO_B")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
        gamma_ab = prop->property_value("GAMMA_AB")->pointer();
        gamma_bb = prop->property_value("GAMMA_BB")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
        tau_b = prop->property_value("TAU_B")->pointer();
    }

    double omega = params_[0].second;
    double d = params_[1].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t166438 = sqrt(gamma_aa[index]);
            double t166439 = 1.0/pow(rho_a[index],4.0/3.0);
            double t166440 = 1.0/pow(rho_a[index],1.0/3.0);
            double t166441 = 1.0/pow(rho_a[index],8.0/3.0);
            double t166442 = t166438*t166439;
            double t166443 = log(t166442+sqrt(t166442*t166442+1.0));
            double t166444 = d*t166443*t166438*t166439*6.0;
            double t166445 = t166444+1.0;
            double t166446 = 1.0/t166445;
            double t166447 = d*gamma_aa[index]*t166441*t166446*2.0;
            double t166448 = t166447+4.190715359480463E15/2.251799813685248E15;
            double t166449 = 1.0/(omega*omega);
            double t166450 = pow(rho_a[index],2.0/3.0);
            double t166451 = 1.0/t166448;
            double t166452 = exp(t166450*t166451*t166449*(-1.4000771998813E29/4.951760157141521E27));
            double t166453 = sqrt(t166448);
            double t166454 = 1.0/omega;
            double t166455 = sqrt(gamma_bb[index]);
            double t166456 = 1.0/pow(rho_b[index],4.0/3.0);
            double t166457 = 1.0/pow(rho_b[index],1.0/3.0);
            double t166458 = 1.0/pow(rho_b[index],8.0/3.0);
            double t166459 = t166455*t166456;
            double t166460 = log(t166459+sqrt(t166459*t166459+1.0));
            double t166461 = d*t166460*t166455*t166456*6.0;
            double t166462 = t166461+1.0;
            double t166463 = 1.0/t166462;
            double t166464 = d*gamma_bb[index]*t166463*t166458*2.0;
            double t166465 = t166464+4.190715359480463E15/2.251799813685248E15;
            double t166466 = omega*omega;
            double t166467 = pow(rho_b[index],2.0/3.0);
            double t166468 = 1.0/t166465;
            double t166469 = exp(t166449*t166467*t166468*(-1.4000771998813E29/4.951760157141521E27));
            double t166470 = sqrt(t166465);
            functional_[index] = pow(rho_a[index],4.0/3.0)*t166448*(omega*t166440*t166453*(erf(pow(rho_a[index],1.0/ \
               3.0)*t166454*1.0/sqrt(t166448)*(3.74176054803257E14/7.0368744177664E13))*(3.991211251234741E15/2.251799813685248E15) \
               -omega*t166440*t166453*(-t166452+1.0/pow(rho_a[index],2.0/3.0)*t166448*t166466*(t166452-1.0)*(2.475880078570761E27/ \
               1.4000771998813E29)+3.0/2.0)*(7.0368744177664E13/3.74176054803257E14))*(2.81474976710656E14/1.122528164409771E15) \
               -1.0)*(1.0/2.0)+pow(rho_b[index],4.0/3.0)*t166465*(omega*t166470*t166457*(erf(pow(rho_b[index],1.0/ \
               3.0)*t166454*1.0/sqrt(t166465)*(3.74176054803257E14/7.0368744177664E13))*(3.991211251234741E15/2.251799813685248E15) \
               -omega*t166470*t166457*(-t166469+1.0/pow(rho_b[index],2.0/3.0)*t166465*t166466*(t166469-1.0)*(2.475880078570761E27/ \
               1.4000771998813E29)+3.0/2.0)*(7.0368744177664E13/3.74176054803257E14))*(2.81474976710656E14/1.122528164409771E15) \
               -1.0)*(1.0/2.0);
        } else if (rho_a[index] > cutoff_) {
            double t167603 = sqrt(gamma_aa[index]);
            double t167604 = 1.0/pow(rho_a[index],4.0/3.0);
            double t167605 = 1.0/pow(rho_a[index],1.0/3.0);
            double t167606 = 1.0/pow(rho_a[index],8.0/3.0);
            double t167607 = t167603*t167604;
            double t167608 = log(t167607+sqrt(t167607*t167607+1.0));
            double t167609 = d*t167603*t167604*t167608*6.0;
            double t167610 = t167609+1.0;
            double t167611 = 1.0/t167610;
            double t167612 = d*gamma_aa[index]*t167611*t167606*2.0;
            double t167613 = t167612+4.190715359480463E15/2.251799813685248E15;
            double t167614 = 1.0/(omega*omega);
            double t167615 = pow(rho_a[index],2.0/3.0);
            double t167616 = 1.0/t167613;
            double t167617 = exp(t167614*t167615*t167616*(-1.4000771998813E29/4.951760157141521E27));
            double t167618 = sqrt(t167613);
            functional_[index] = pow(rho_a[index],4.0/3.0)*t167613*(omega*t167605*t167618*(erf((pow(rho_a[index],1.0/ \
               3.0)*1.0/sqrt(t167613)*(3.74176054803257E14/7.0368744177664E13))/omega)*(3.991211251234741E15/2.251799813685248E15) \
               -omega*t167605*t167618*(-t167617+(omega*omega)*1.0/pow(rho_a[index],2.0/3.0)*t167613*(t167617-1.0) \
               *(2.475880078570761E27/1.4000771998813E29)+3.0/2.0)*(7.0368744177664E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)-1.0)*(1.0/2.0);
        } else if (rho_b[index] > cutoff_) {
            double t167203 = sqrt(gamma_bb[index]);
            double t167204 = 1.0/pow(rho_b[index],4.0/3.0);
            double t167205 = 1.0/pow(rho_b[index],1.0/3.0);
            double t167206 = 1.0/pow(rho_b[index],8.0/3.0);
            double t167207 = t167203*t167204;
            double t167208 = log(t167207+sqrt(t167207*t167207+1.0));
            double t167209 = d*t167203*t167204*t167208*6.0;
            double t167210 = t167209+1.0;
            double t167211 = 1.0/t167210;
            double t167212 = d*gamma_bb[index]*t167211*t167206*2.0;
            double t167213 = t167212+4.190715359480463E15/2.251799813685248E15;
            double t167214 = 1.0/(omega*omega);
            double t167215 = pow(rho_b[index],2.0/3.0);
            double t167216 = 1.0/t167213;
            double t167217 = exp(t167214*t167215*t167216*(-1.4000771998813E29/4.951760157141521E27));
            double t167218 = sqrt(t167213);
            functional_[index] = pow(rho_b[index],4.0/3.0)*t167213*(omega*t167205*t167218*(erf((pow(rho_b[index],1.0/ \
               3.0)*1.0/sqrt(t167213)*(3.74176054803257E14/7.0368744177664E13))/omega)*(3.991211251234741E15/2.251799813685248E15) \
               -omega*t167205*t167218*(-t167217+(omega*omega)*1.0/pow(rho_b[index],2.0/3.0)*t167213*(t167217-1.0) \
               *(2.475880078570761E27/1.4000771998813E29)+3.0/2.0)*(7.0368744177664E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)-1.0)*(1.0/2.0);
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t166472 = sqrt(gamma_aa[index]);
            double t166473 = 1.0/pow(rho_a[index],4.0/3.0);
            double t166474 = 1.0/pow(rho_a[index],8.0/3.0);
            double t166475 = t166472*t166473;
            double t166476 = log(t166475+sqrt(t166475*t166475+1.0));
            double t166477 = d*t166472*t166473*t166476*6.0;
            double t166478 = t166477+1.0;
            double t166479 = 1.0/t166478;
            double t166480 = d*gamma_aa[index]*t166474*t166479*2.0;
            double t166481 = t166480+4.190715359480463E15/2.251799813685248E15;
            double t166482 = 1.0/(omega*omega);
            double t166483 = pow(rho_a[index],2.0/3.0);
            double t166484 = 1.0/t166481;
            double t166488 = t166482*t166483*t166484*(1.4000771998813E29/4.951760157141521E27);
            double t166485 = exp(-t166488);
            double t166486 = sqrt(t166481);
            double t166487 = 1.0/pow(rho_a[index],1.0/3.0);
            double t166489 = 1.0/omega;
            double t166490 = 1.0/pow(rho_a[index],2.0/3.0);
            double t166491 = 1.0/sqrt(t166481);
            double t166492 = pow(rho_a[index],1.0/3.0);
            double t166493 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t166494 = d*gamma_aa[index]*t166493*t166479*(1.6E1/3.0);
            double t166495 = 1.0/(t166478*t166478);
            double t166496 = gamma_aa[index]*t166474;
            double t166497 = t166496+1.0;
            double t166498 = 1.0/sqrt(t166497);
            double t166499 = d*gamma_aa[index]*t166493*t166498*8.0;
            double t166500 = 1.0/pow(rho_a[index],7.0/3.0);
            double t166501 = d*t166500*t166472*t166476*8.0;
            double t166502 = t166501+t166499;
            double t166506 = d*gamma_aa[index]*t166502*t166474*t166495*2.0;
            double t166503 = -t166506+t166494;
            double t166504 = omega*omega;
            double t166505 = t166485-1.0;
            double t166507 = t166482*t166484*t166487*(1.4000771998813E29/7.427640235712282E27);
            double t166508 = 1.0/(t166481*t166481);
            double t166509 = t166503*t166508*t166482*t166483*(1.4000771998813E29/4.951760157141521E27);
            double t166510 = t166507+t166509;
            double t166511 = t166504*t166505*t166481*t166490*(2.475880078570761E27/1.4000771998813E29);
            double t166512 = t166511-t166485+3.0/2.0;
            double t166513 = t166491*t166492*t166489*(3.74176054803257E14/7.0368744177664E13);
            double t166514 = erf(t166513);
            double t166515 = t166514*(3.991211251234741E15/2.251799813685248E15);
            double t166518 = omega*t166512*t166486*t166487*(7.0368744177664E13/3.74176054803257E14);
            double t166516 = t166515-t166518;
            double t166517 = pow(rho_a[index],4.0/3.0);
            double t166519 = omega*t166516*t166486*t166487*(2.81474976710656E14/1.122528164409771E15);
            double t166520 = t166519-1.0;
            v_rho_a_[index] = t166481*t166517*(omega*t166516*t166473*t166486*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t166486*t166487*(1.0/sqrt(3.141592653589793)*t166485*(t166490*t166491*t166489*(3.74176054803257E14/ \
               2.11106232532992E14)+t166503*1.0/pow(t166481,3.0/2.0)*t166492*t166489*(3.74176054803257E14/1.40737488355328E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t166512*t166473*t166486*(7.0368744177664E13/1.122528164409771E15) \
               +omega*t166486*t166487*(-t166510*t166485+t166503*t166504*t166505*t166490*(2.475880078570761E27/1.4000771998813E29) \
               +1.0/pow(rho_a[index],5.0/3.0)*t166504*t166505*t166481*(4.951760157141521E27/4.2002315996439E29)+t166510* \
               t166504*t166481*t166490*t166485*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14) \
               +omega*t166503*t166512*t166491*t166487*(3.5184372088832E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)+omega*t166503*t166516*t166491*t166487*(1.40737488355328E14/1.122528164409771E15) \
               )*(-1.0/2.0)-t166520*t166503*t166517*(1.0/2.0)+t166520*t166481*t166492*(2.0/3.0);
        } else if (rho_a[index] > cutoff_) {
            double t167620 = sqrt(gamma_aa[index]);
            double t167621 = 1.0/pow(rho_a[index],4.0/3.0);
            double t167622 = 1.0/pow(rho_a[index],8.0/3.0);
            double t167623 = t167620*t167621;
            double t167624 = log(t167623+sqrt(t167623*t167623+1.0));
            double t167625 = d*t167620*t167621*t167624*6.0;
            double t167626 = t167625+1.0;
            double t167627 = 1.0/t167626;
            double t167628 = d*gamma_aa[index]*t167622*t167627*2.0;
            double t167629 = t167628+4.190715359480463E15/2.251799813685248E15;
            double t167630 = 1.0/(omega*omega);
            double t167631 = pow(rho_a[index],2.0/3.0);
            double t167632 = 1.0/t167629;
            double t167636 = t167630*t167631*t167632*(1.4000771998813E29/4.951760157141521E27);
            double t167633 = exp(-t167636);
            double t167634 = sqrt(t167629);
            double t167635 = 1.0/pow(rho_a[index],1.0/3.0);
            double t167637 = 1.0/omega;
            double t167638 = 1.0/pow(rho_a[index],2.0/3.0);
            double t167639 = 1.0/sqrt(t167629);
            double t167640 = pow(rho_a[index],1.0/3.0);
            double t167641 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t167642 = d*gamma_aa[index]*t167641*t167627*(1.6E1/3.0);
            double t167643 = 1.0/(t167626*t167626);
            double t167644 = gamma_aa[index]*t167622;
            double t167645 = t167644+1.0;
            double t167646 = 1.0/sqrt(t167645);
            double t167647 = d*gamma_aa[index]*t167641*t167646*8.0;
            double t167648 = 1.0/pow(rho_a[index],7.0/3.0);
            double t167649 = d*t167620*t167624*t167648*8.0;
            double t167650 = t167647+t167649;
            double t167654 = d*gamma_aa[index]*t167622*t167650*t167643*2.0;
            double t167651 = t167642-t167654;
            double t167652 = omega*omega;
            double t167653 = t167633-1.0;
            double t167655 = t167630*t167632*t167635*(1.4000771998813E29/7.427640235712282E27);
            double t167656 = 1.0/(t167629*t167629);
            double t167657 = t167630*t167631*t167651*t167656*(1.4000771998813E29/4.951760157141521E27);
            double t167658 = t167655+t167657;
            double t167659 = t167652*t167653*t167629*t167638*(2.475880078570761E27/1.4000771998813E29);
            double t167660 = -t167633+t167659+3.0/2.0;
            double t167661 = t167640*t167637*t167639*(3.74176054803257E14/7.0368744177664E13);
            double t167662 = erf(t167661);
            double t167663 = t167662*(3.991211251234741E15/2.251799813685248E15);
            double t167666 = omega*t167660*t167634*t167635*(7.0368744177664E13/3.74176054803257E14);
            double t167664 = t167663-t167666;
            double t167665 = pow(rho_a[index],4.0/3.0);
            double t167667 = omega*t167634*t167635*t167664*(2.81474976710656E14/1.122528164409771E15);
            double t167668 = t167667-1.0;
            v_rho_a_[index] = t167629*t167665*(omega*t167621*t167634*t167664*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t167634*t167635*(1.0/sqrt(3.141592653589793)*t167633*(t167637*t167638*t167639*(3.74176054803257E14/ \
               2.11106232532992E14)+t167640*t167651*t167637*1.0/pow(t167629,3.0/2.0)*(3.74176054803257E14/1.40737488355328E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t167621*t167660*t167634*(7.0368744177664E13/1.122528164409771E15) \
               +omega*t167634*t167635*(-t167633*t167658+t167651*t167652*t167653*t167638*(2.475880078570761E27/1.4000771998813E29) \
               +1.0/pow(rho_a[index],5.0/3.0)*t167652*t167653*t167629*(4.951760157141521E27/4.2002315996439E29)+t167633* \
               t167652*t167629*t167638*t167658*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14) \
               +omega*t167651*t167660*t167635*t167639*(3.5184372088832E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)+omega*t167651*t167635*t167664*t167639*(1.40737488355328E14/1.122528164409771E15) \
               )*(-1.0/2.0)+t167640*t167629*t167668*(2.0/3.0)-t167651*t167665*t167668*(1.0/2.0);
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_[index] = 0.0;
        } else {
            v_rho_a_[index] = 0.0;
        } 

        //V_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t166522 = sqrt(gamma_bb[index]);
            double t166523 = 1.0/pow(rho_b[index],4.0/3.0);
            double t166524 = 1.0/pow(rho_b[index],8.0/3.0);
            double t166525 = t166522*t166523;
            double t166526 = log(t166525+sqrt(t166525*t166525+1.0));
            double t166527 = d*t166522*t166523*t166526*6.0;
            double t166528 = t166527+1.0;
            double t166529 = 1.0/t166528;
            double t166530 = d*gamma_bb[index]*t166524*t166529*2.0;
            double t166531 = t166530+4.190715359480463E15/2.251799813685248E15;
            double t166532 = 1.0/(omega*omega);
            double t166533 = pow(rho_b[index],2.0/3.0);
            double t166534 = 1.0/t166531;
            double t166538 = t166532*t166533*t166534*(1.4000771998813E29/4.951760157141521E27);
            double t166535 = exp(-t166538);
            double t166536 = sqrt(t166531);
            double t166537 = 1.0/pow(rho_b[index],1.0/3.0);
            double t166539 = 1.0/omega;
            double t166540 = 1.0/pow(rho_b[index],2.0/3.0);
            double t166541 = 1.0/sqrt(t166531);
            double t166542 = pow(rho_b[index],1.0/3.0);
            double t166543 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t166544 = d*gamma_bb[index]*t166543*t166529*(1.6E1/3.0);
            double t166545 = 1.0/(t166528*t166528);
            double t166546 = gamma_bb[index]*t166524;
            double t166547 = t166546+1.0;
            double t166548 = 1.0/sqrt(t166547);
            double t166549 = d*gamma_bb[index]*t166543*t166548*8.0;
            double t166550 = 1.0/pow(rho_b[index],7.0/3.0);
            double t166551 = d*t166522*t166550*t166526*8.0;
            double t166552 = t166551+t166549;
            double t166556 = d*gamma_bb[index]*t166524*t166552*t166545*2.0;
            double t166553 = t166544-t166556;
            double t166554 = omega*omega;
            double t166555 = t166535-1.0;
            double t166557 = t166532*t166534*t166537*(1.4000771998813E29/7.427640235712282E27);
            double t166558 = 1.0/(t166531*t166531);
            double t166559 = t166532*t166533*t166553*t166558*(1.4000771998813E29/4.951760157141521E27);
            double t166560 = t166557+t166559;
            double t166561 = t166531*t166540*t166554*t166555*(2.475880078570761E27/1.4000771998813E29);
            double t166562 = t166561-t166535+3.0/2.0;
            double t166563 = t166541*t166542*t166539*(3.74176054803257E14/7.0368744177664E13);
            double t166564 = erf(t166563);
            double t166565 = t166564*(3.991211251234741E15/2.251799813685248E15);
            double t166568 = omega*t166562*t166536*t166537*(7.0368744177664E13/3.74176054803257E14);
            double t166566 = t166565-t166568;
            double t166567 = pow(rho_b[index],4.0/3.0);
            double t166569 = omega*t166536*t166537*t166566*(2.81474976710656E14/1.122528164409771E15);
            double t166570 = t166569-1.0;
            v_rho_b_[index] = t166531*t166567*(omega*t166523*t166536*t166566*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t166536*t166537*(1.0/sqrt(3.141592653589793)*t166535*(t166540*t166541*t166539*(3.74176054803257E14/ \
               2.11106232532992E14)+1.0/pow(t166531,3.0/2.0)*t166542*t166553*t166539*(3.74176054803257E14/1.40737488355328E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t166523*t166562*t166536*(7.0368744177664E13/1.122528164409771E15) \
               +omega*t166536*t166537*(-t166560*t166535+t166540*t166553*t166554*t166555*(2.475880078570761E27/1.4000771998813E29) \
               +1.0/pow(rho_b[index],5.0/3.0)*t166531*t166554*t166555*(4.951760157141521E27/4.2002315996439E29)+t166531* \
               t166540*t166560*t166535*t166554*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14) \
               +omega*t166541*t166553*t166562*t166537*(3.5184372088832E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)+omega*t166541*t166553*t166537*t166566*(1.40737488355328E14/1.122528164409771E15) \
               )*(-1.0/2.0)+t166531*t166542*t166570*(2.0/3.0)-t166570*t166553*t166567*(1.0/2.0);
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t167221 = sqrt(gamma_bb[index]);
            double t167222 = 1.0/pow(rho_b[index],4.0/3.0);
            double t167223 = 1.0/pow(rho_b[index],8.0/3.0);
            double t167224 = t167221*t167222;
            double t167225 = log(t167224+sqrt(t167224*t167224+1.0));
            double t167226 = d*t167221*t167222*t167225*6.0;
            double t167227 = t167226+1.0;
            double t167228 = 1.0/t167227;
            double t167229 = d*gamma_bb[index]*t167223*t167228*2.0;
            double t167230 = t167229+4.190715359480463E15/2.251799813685248E15;
            double t167231 = 1.0/(omega*omega);
            double t167232 = pow(rho_b[index],2.0/3.0);
            double t167233 = 1.0/t167230;
            double t167237 = t167231*t167232*t167233*(1.4000771998813E29/4.951760157141521E27);
            double t167234 = exp(-t167237);
            double t167235 = sqrt(t167230);
            double t167236 = 1.0/pow(rho_b[index],1.0/3.0);
            double t167238 = 1.0/omega;
            double t167239 = 1.0/pow(rho_b[index],2.0/3.0);
            double t167240 = 1.0/sqrt(t167230);
            double t167241 = pow(rho_b[index],1.0/3.0);
            double t167242 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t167243 = d*gamma_bb[index]*t167242*t167228*(1.6E1/3.0);
            double t167244 = 1.0/(t167227*t167227);
            double t167245 = gamma_bb[index]*t167223;
            double t167246 = t167245+1.0;
            double t167247 = 1.0/sqrt(t167246);
            double t167248 = d*gamma_bb[index]*t167242*t167247*8.0;
            double t167249 = 1.0/pow(rho_b[index],7.0/3.0);
            double t167250 = d*t167221*t167225*t167249*8.0;
            double t167251 = t167250+t167248;
            double t167255 = d*gamma_bb[index]*t167223*t167251*t167244*2.0;
            double t167252 = t167243-t167255;
            double t167253 = omega*omega;
            double t167254 = t167234-1.0;
            double t167256 = t167231*t167233*t167236*(1.4000771998813E29/7.427640235712282E27);
            double t167257 = 1.0/(t167230*t167230);
            double t167258 = t167231*t167232*t167252*t167257*(1.4000771998813E29/4.951760157141521E27);
            double t167259 = t167256+t167258;
            double t167260 = t167230*t167253*t167254*t167239*(2.475880078570761E27/1.4000771998813E29);
            double t167261 = t167260-t167234+3.0/2.0;
            double t167262 = t167240*t167241*t167238*(3.74176054803257E14/7.0368744177664E13);
            double t167263 = erf(t167262);
            double t167264 = t167263*(3.991211251234741E15/2.251799813685248E15);
            double t167267 = omega*t167261*t167235*t167236*(7.0368744177664E13/3.74176054803257E14);
            double t167265 = t167264-t167267;
            double t167266 = pow(rho_b[index],4.0/3.0);
            double t167268 = omega*t167235*t167236*t167265*(2.81474976710656E14/1.122528164409771E15);
            double t167269 = t167268-1.0;
            v_rho_b_[index] = t167230*t167266*(omega*t167222*t167235*t167265*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t167235*t167236*(1.0/sqrt(3.141592653589793)*t167234*(t167240*t167238*t167239*(3.74176054803257E14/ \
               2.11106232532992E14)+1.0/pow(t167230,3.0/2.0)*t167241*t167252*t167238*(3.74176054803257E14/1.40737488355328E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t167222*t167261*t167235*(7.0368744177664E13/1.122528164409771E15) \
               +omega*t167235*t167236*(-t167234*t167259+t167252*t167253*t167254*t167239*(2.475880078570761E27/1.4000771998813E29) \
               +1.0/pow(rho_b[index],5.0/3.0)*t167230*t167253*t167254*(4.951760157141521E27/4.2002315996439E29)+t167230* \
               t167234*t167253*t167239*t167259*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14) \
               +omega*t167240*t167252*t167261*t167236*(3.5184372088832E13/3.74176054803257E14))*(2.81474976710656E14/ \
               1.122528164409771E15)+omega*t167240*t167252*t167236*t167265*(1.40737488355328E14/1.122528164409771E15) \
               )*(-1.0/2.0)+t167230*t167241*t167269*(2.0/3.0)-t167252*t167266*t167269*(1.0/2.0);
        } else {
            v_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t166572 = sqrt(gamma_aa[index]);
                double t166573 = 1.0/pow(rho_a[index],4.0/3.0);
                double t166574 = 1.0/pow(rho_a[index],1.0/3.0);
                double t166575 = 1.0/pow(rho_a[index],8.0/3.0);
                double t166576 = t166572*t166573;
                double t166577 = log(t166576+sqrt(t166576*t166576+1.0));
                double t166578 = d*t166572*t166573*t166577*6.0;
                double t166579 = t166578+1.0;
                double t166580 = 1.0/t166579;
                double t166581 = d*gamma_aa[index]*t166580*t166575*2.0;
                double t166582 = t166581+4.190715359480463E15/2.251799813685248E15;
                double t166583 = 1.0/(omega*omega);
                double t166584 = pow(rho_a[index],2.0/3.0);
                double t166585 = 1.0/t166582;
                double t166589 = t166583*t166584*t166585*(1.4000771998813E29/4.951760157141521E27);
                double t166586 = exp(-t166589);
                double t166587 = sqrt(t166582);
                double t166588 = pow(rho_a[index],4.0/3.0);
                double t166590 = d*t166580*t166575*2.0;
                double t166591 = gamma_aa[index]*t166575;
                double t166592 = t166591+1.0;
                double t166593 = 1.0/sqrt(t166592);
                double t166594 = d*t166575*t166593*3.0;
                double t166595 = 1.0/sqrt(gamma_aa[index]);
                double t166596 = d*t166573*t166577*t166595*3.0;
                double t166597 = t166594+t166596;
                double t166598 = 1.0/(t166579*t166579);
                double t166603 = d*gamma_aa[index]*t166575*t166597*t166598*2.0;
                double t166599 = -t166603+t166590;
                double t166600 = omega*omega;
                double t166601 = 1.0/pow(rho_a[index],2.0/3.0);
                double t166602 = t166586-1.0;
                double t166604 = 1.0/sqrt(t166582);
                double t166605 = t166600*t166601*t166602*t166582*(2.475880078570761E27/1.4000771998813E29);
                double t166606 = t166605-t166586+3.0/2.0;
                double t166607 = 1.0/omega;
                double t166608 = pow(rho_a[index],1.0/3.0);
                double t166609 = t166604*t166607*t166608*(3.74176054803257E14/7.0368744177664E13);
                double t166610 = erf(t166609);
                double t166611 = t166610*(3.991211251234741E15/2.251799813685248E15);
                double t166612 = t166611-omega*t166606*t166574*t166587*(7.0368744177664E13/3.74176054803257E14);
                v_gamma_aa_[index] = t166582*t166588*(omega*t166574*t166587*(omega*t166574*t166587*(t166585*t166586* \
                   t166599*(1.0/2.0)+t166600*t166601*t166602*t166599*(2.475880078570761E27/1.4000771998813E29)-1.0/(t166582* \
                   t166582)*t166583*t166584*t166586*t166599*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t166604*t166606*t166574*t166599*(3.5184372088832E13/3.74176054803257E14) \
                   +1.0/sqrt(3.141592653589793)*t166607*t166608*1.0/pow(t166582,3.0/2.0)*t166586*t166599*(1.493415679873386E30/ \
                   1.584563250285287E29))*(2.81474976710656E14/1.122528164409771E15)-omega*t166612*t166604*t166574*t166599* \
                   (1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t166588*t166599*(omega*t166612*t166574*t166587* \
                   (2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                double t167671 = sqrt(gamma_aa[index]);
                double t167672 = 1.0/pow(rho_a[index],4.0/3.0);
                double t167673 = 1.0/pow(rho_a[index],1.0/3.0);
                double t167674 = 1.0/pow(rho_a[index],8.0/3.0);
                double t167675 = t167671*t167672;
                double t167676 = log(t167675+sqrt(t167675*t167675+1.0));
                double t167677 = d*t167671*t167672*t167676*6.0;
                double t167678 = t167677+1.0;
                double t167679 = 1.0/t167678;
                double t167680 = d*gamma_aa[index]*t167674*t167679*2.0;
                double t167681 = t167680+4.190715359480463E15/2.251799813685248E15;
                double t167682 = 1.0/(omega*omega);
                double t167683 = pow(rho_a[index],2.0/3.0);
                double t167684 = 1.0/t167681;
                double t167688 = t167682*t167683*t167684*(1.4000771998813E29/4.951760157141521E27);
                double t167685 = exp(-t167688);
                double t167686 = sqrt(t167681);
                double t167687 = pow(rho_a[index],4.0/3.0);
                double t167689 = d*t167674*t167679*2.0;
                double t167690 = gamma_aa[index]*t167674;
                double t167691 = t167690+1.0;
                double t167692 = 1.0/sqrt(t167691);
                double t167693 = d*t167674*t167692*3.0;
                double t167694 = 1.0/sqrt(gamma_aa[index]);
                double t167695 = d*t167672*t167676*t167694*3.0;
                double t167696 = t167693+t167695;
                double t167697 = 1.0/(t167678*t167678);
                double t167702 = d*gamma_aa[index]*t167674*t167696*t167697*2.0;
                double t167698 = -t167702+t167689;
                double t167699 = omega*omega;
                double t167700 = 1.0/pow(rho_a[index],2.0/3.0);
                double t167701 = t167685-1.0;
                double t167703 = 1.0/sqrt(t167681);
                double t167704 = t167700*t167701*t167681*t167699*(2.475880078570761E27/1.4000771998813E29);
                double t167705 = t167704-t167685+3.0/2.0;
                double t167706 = 1.0/omega;
                double t167707 = pow(rho_a[index],1.0/3.0);
                double t167708 = t167703*t167706*t167707*(3.74176054803257E14/7.0368744177664E13);
                double t167709 = erf(t167708);
                double t167710 = t167709*(3.991211251234741E15/2.251799813685248E15);
                double t167711 = t167710-omega*t167705*t167673*t167686*(7.0368744177664E13/3.74176054803257E14);
                v_gamma_aa_[index] = t167681*t167687*(omega*t167673*t167686*(omega*t167673*t167686*(t167684*t167685* \
                   t167698*(1.0/2.0)+t167700*t167701*t167698*t167699*(2.475880078570761E27/1.4000771998813E29)-1.0/(t167681* \
                   t167681)*t167682*t167683*t167685*t167698*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t167703*t167705*t167673*t167698*(3.5184372088832E13/3.74176054803257E14) \
                   +1.0/sqrt(3.141592653589793)*t167706*t167707*1.0/pow(t167681,3.0/2.0)*t167685*t167698*(1.493415679873386E30/ \
                   1.584563250285287E29))*(2.81474976710656E14/1.122528164409771E15)-omega*t167711*t167703*t167673*t167698* \
                   (1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t167687*t167698*(omega*t167711*t167673*t167686* \
                   (2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t166615 = sqrt(gamma_bb[index]);
                double t166616 = 1.0/pow(rho_b[index],4.0/3.0);
                double t166617 = 1.0/pow(rho_b[index],1.0/3.0);
                double t166618 = 1.0/pow(rho_b[index],8.0/3.0);
                double t166619 = t166615*t166616;
                double t166620 = log(t166619+sqrt(t166619*t166619+1.0));
                double t166621 = d*t166620*t166615*t166616*6.0;
                double t166622 = t166621+1.0;
                double t166623 = 1.0/t166622;
                double t166624 = d*gamma_bb[index]*t166623*t166618*2.0;
                double t166625 = t166624+4.190715359480463E15/2.251799813685248E15;
                double t166626 = 1.0/(omega*omega);
                double t166627 = pow(rho_b[index],2.0/3.0);
                double t166628 = 1.0/t166625;
                double t166632 = t166626*t166627*t166628*(1.4000771998813E29/4.951760157141521E27);
                double t166629 = exp(-t166632);
                double t166630 = sqrt(t166625);
                double t166631 = pow(rho_b[index],4.0/3.0);
                double t166633 = d*t166623*t166618*2.0;
                double t166634 = gamma_bb[index]*t166618;
                double t166635 = t166634+1.0;
                double t166636 = 1.0/sqrt(t166635);
                double t166637 = d*t166618*t166636*3.0;
                double t166638 = 1.0/sqrt(gamma_bb[index]);
                double t166639 = d*t166620*t166616*t166638*3.0;
                double t166640 = t166637+t166639;
                double t166641 = 1.0/(t166622*t166622);
                double t166646 = d*gamma_bb[index]*t166640*t166641*t166618*2.0;
                double t166642 = t166633-t166646;
                double t166643 = omega*omega;
                double t166644 = 1.0/pow(rho_b[index],2.0/3.0);
                double t166645 = t166629-1.0;
                double t166647 = 1.0/sqrt(t166625);
                double t166648 = t166625*t166643*t166644*t166645*(2.475880078570761E27/1.4000771998813E29);
                double t166649 = -t166629+t166648+3.0/2.0;
                double t166650 = 1.0/omega;
                double t166651 = pow(rho_b[index],1.0/3.0);
                double t166652 = t166650*t166651*t166647*(3.74176054803257E14/7.0368744177664E13);
                double t166653 = erf(t166652);
                double t166654 = t166653*(3.991211251234741E15/2.251799813685248E15);
                double t166655 = t166654-omega*t166630*t166617*t166649*(7.0368744177664E13/3.74176054803257E14);
                v_gamma_bb_[index] = t166631*t166625*(omega*t166630*t166617*(omega*t166630*t166617*(t166642*t166628* \
                   t166629*(1.0/2.0)+t166642*t166643*t166644*t166645*(2.475880078570761E27/1.4000771998813E29)-t166642* \
                   1.0/(t166625*t166625)*t166626*t166627*t166629*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t166642*t166617*t166647*t166649*(3.5184372088832E13/3.74176054803257E14) \
                   +1.0/sqrt(3.141592653589793)*t166650*t166642*t166651*1.0/pow(t166625,3.0/2.0)*t166629*(1.493415679873386E30/ \
                   1.584563250285287E29))*(2.81474976710656E14/1.122528164409771E15)-omega*t166642*t166617*t166655*t166647* \
                   (1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t166631*t166642*(omega*t166630*t166617*t166655* \
                   (2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t167273 = sqrt(gamma_bb[index]);
                double t167274 = 1.0/pow(rho_b[index],4.0/3.0);
                double t167275 = 1.0/pow(rho_b[index],1.0/3.0);
                double t167276 = 1.0/pow(rho_b[index],8.0/3.0);
                double t167277 = t167273*t167274;
                double t167278 = log(t167277+sqrt(t167277*t167277+1.0));
                double t167279 = d*t167273*t167274*t167278*6.0;
                double t167280 = t167279+1.0;
                double t167281 = 1.0/t167280;
                double t167282 = d*gamma_bb[index]*t167281*t167276*2.0;
                double t167283 = t167282+4.190715359480463E15/2.251799813685248E15;
                double t167284 = 1.0/(omega*omega);
                double t167285 = pow(rho_b[index],2.0/3.0);
                double t167286 = 1.0/t167283;
                double t167290 = t167284*t167285*t167286*(1.4000771998813E29/4.951760157141521E27);
                double t167287 = exp(-t167290);
                double t167288 = sqrt(t167283);
                double t167289 = pow(rho_b[index],4.0/3.0);
                double t167291 = d*t167281*t167276*2.0;
                double t167292 = gamma_bb[index]*t167276;
                double t167293 = t167292+1.0;
                double t167294 = 1.0/sqrt(t167293);
                double t167295 = d*t167276*t167294*3.0;
                double t167296 = 1.0/sqrt(gamma_bb[index]);
                double t167297 = d*t167274*t167278*t167296*3.0;
                double t167298 = t167295+t167297;
                double t167299 = 1.0/(t167280*t167280);
                double t167304 = d*gamma_bb[index]*t167276*t167298*t167299*2.0;
                double t167300 = -t167304+t167291;
                double t167301 = omega*omega;
                double t167302 = 1.0/pow(rho_b[index],2.0/3.0);
                double t167303 = t167287-1.0;
                double t167305 = 1.0/sqrt(t167283);
                double t167306 = t167301*t167302*t167303*t167283*(2.475880078570761E27/1.4000771998813E29);
                double t167307 = t167306-t167287+3.0/2.0;
                double t167308 = 1.0/omega;
                double t167309 = pow(rho_b[index],1.0/3.0);
                double t167310 = t167305*t167308*t167309*(3.74176054803257E14/7.0368744177664E13);
                double t167311 = erf(t167310);
                double t167312 = t167311*(3.991211251234741E15/2.251799813685248E15);
                double t167313 = t167312-omega*t167307*t167275*t167288*(7.0368744177664E13/3.74176054803257E14);
                v_gamma_bb_[index] = t167283*t167289*(omega*t167275*t167288*(omega*t167275*t167288*(t167300*t167286* \
                   t167287*(1.0/2.0)+t167300*t167301*t167302*t167303*(2.475880078570761E27/1.4000771998813E29)-t167300* \
                   1.0/(t167283*t167283)*t167284*t167285*t167287*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t167300*t167305*t167307*t167275*(3.5184372088832E13/3.74176054803257E14) \
                   +1.0/sqrt(3.141592653589793)*t167300*t167308*t167309*1.0/pow(t167283,3.0/2.0)*t167287*(1.493415679873386E30/ \
                   1.584563250285287E29))*(2.81474976710656E14/1.122528164409771E15)-omega*t167300*t167313*t167305*t167275* \
                   (1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t167300*t167289*(omega*t167313*t167275*t167288* \
                   (2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else {
                v_gamma_bb_[index] = 0.0;
            } 
        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else {
                v_tau_b_[index] = 0.0;
            } 
        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t166659 = sqrt(gamma_aa[index]);
            double t166660 = 1.0/pow(rho_a[index],4.0/3.0);
            double t166661 = t166660*t166659;
            double t166662 = log(t166661+sqrt(t166661*t166661+1.0));
            double t166663 = d*t166660*t166662*t166659*6.0;
            double t166664 = t166663+1.0;
            double t166665 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t166666 = 1.0/pow(rho_a[index],8.0/3.0);
            double t166667 = 1.0/t166664;
            double t166668 = d*gamma_aa[index]*t166666*t166667*2.0;
            double t166669 = t166668+4.190715359480463E15/2.251799813685248E15;
            double t166670 = 1.0/(omega*omega);
            double t166671 = pow(rho_a[index],2.0/3.0);
            double t166672 = 1.0/t166669;
            double t166676 = t166670*t166671*t166672*(1.4000771998813E29/4.951760157141521E27);
            double t166673 = exp(-t166676);
            double t166674 = sqrt(t166669);
            double t166675 = 1.0/pow(rho_a[index],1.0/3.0);
            double t166677 = 1.0/omega;
            double t166678 = 1.0/pow(rho_a[index],2.0/3.0);
            double t166679 = 1.0/sqrt(t166669);
            double t166680 = pow(rho_a[index],1.0/3.0);
            double t166681 = d*gamma_aa[index]*t166665*t166667*(1.6E1/3.0);
            double t166682 = 1.0/(t166664*t166664);
            double t166683 = gamma_aa[index]*t166666;
            double t166684 = t166683+1.0;
            double t166685 = 1.0/sqrt(t166684);
            double t166686 = d*gamma_aa[index]*t166665*t166685*8.0;
            double t166687 = 1.0/pow(rho_a[index],7.0/3.0);
            double t166688 = d*t166662*t166659*t166687*8.0;
            double t166689 = t166686+t166688;
            double t166691 = d*gamma_aa[index]*t166682*t166666*t166689*2.0;
            double t166690 = t166681-t166691;
            double t166692 = omega*omega;
            double t166693 = t166673-1.0;
            double t166694 = t166670*t166672*t166675*(1.4000771998813E29/7.427640235712282E27);
            double t166695 = 1.0/(t166669*t166669);
            double t166696 = t166670*t166671*t166690*t166695*(1.4000771998813E29/4.951760157141521E27);
            double t166697 = t166694+t166696;
            double t166698 = t166692*t166693*t166669*t166678*(2.475880078570761E27/1.4000771998813E29);
            double t166699 = -t166673+t166698+3.0/2.0;
            double t166700 = t166680*t166677*t166679*(3.74176054803257E14/7.0368744177664E13);
            double t166701 = erf(t166700);
            double t166702 = t166701*(3.991211251234741E15/2.251799813685248E15);
            double t166705 = omega*t166674*t166675*t166699*(7.0368744177664E13/3.74176054803257E14);
            double t166703 = t166702-t166705;
            double t166704 = pow(rho_a[index],4.0/3.0);
            double t166706 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t166707 = omega*t166703*t166660*t166674*(2.81474976710656E14/3.367584493229313E15);
            double t166708 = 1.0/sqrt(3.141592653589793);
            double t166709 = t166677*t166678*t166679*(3.74176054803257E14/2.11106232532992E14);
            double t166710 = 1.0/pow(t166669,3.0/2.0);
            double t166711 = t166710*t166680*t166690*t166677*(3.74176054803257E14/1.40737488355328E14);
            double t166712 = t166711+t166709;
            double t166713 = t166712*t166708*t166673*(3.991211251234741E15/1.125899906842624E15);
            double t166714 = t166690*t166692*t166693*t166678*(2.475880078570761E27/1.4000771998813E29);
            double t166715 = 1.0/pow(rho_a[index],5.0/3.0);
            double t166716 = t166715*t166692*t166693*t166669*(4.951760157141521E27/4.2002315996439E29);
            double t166717 = t166673*t166692*t166669*t166678*t166697*(2.475880078570761E27/1.4000771998813E29) \
               ;
            double t166727 = t166673*t166697;
            double t166718 = t166714+t166716+t166717-t166727;
            double t166719 = omega*t166718*t166674*t166675*(7.0368744177664E13/3.74176054803257E14);
            double t166720 = omega*t166660*t166674*t166699*(7.0368744177664E13/1.122528164409771E15);
            double t166721 = omega*t166690*t166675*t166679*t166699*(3.5184372088832E13/3.74176054803257E14);
            double t166722 = t166720+t166721+t166713+t166719;
            double t166723 = omega*t166703*t166690*t166675*t166679*(1.40737488355328E14/1.122528164409771E15) \
               ;
            double t166724 = t166723+t166707-omega*t166722*t166674*t166675*(2.81474976710656E14/1.122528164409771E15) \
               ;
            double t166725 = omega*t166703*t166674*t166675*(2.81474976710656E14/1.122528164409771E15);
            double t166726 = t166725-1.0;
            double t166728 = d*gamma_aa[index]*t166706*t166667*(1.76E2/9.0);
            double t166729 = 1.0/(t166664*t166664*t166664);
            double t166730 = t166689*t166689;
            double t166731 = d*gamma_aa[index]*t166730*t166666*t166729*4.0;
            double t166732 = d*gamma_aa[index]*t166706*t166685*4.0E1;
            double t166733 = gamma_aa[index]*gamma_aa[index];
            double t166734 = 1.0/pow(rho_a[index],2.2E1/3.0);
            double t166735 = 1.0/pow(t166684,3.0/2.0);
            double t166736 = 1.0/pow(rho_a[index],1.0E1/3.0);
            double t166737 = d*t166662*t166736*t166659*(5.6E1/3.0);
            double t166741 = d*t166733*t166734*t166735*(3.2E1/3.0);
            double t166738 = t166732-t166741+t166737;
            double t166742 = d*gamma_aa[index]*t166682*t166666*t166738*2.0;
            double t166743 = d*gamma_aa[index]*t166682*t166665*t166689*(3.2E1/3.0);
            double t166739 = t166731-t166742-t166743+t166728;
            double t166740 = t166690*t166690;
            double t166744 = t166660*t166670*t166672*(1.4000771998813E29/2.228292070713684E28);
            double t166745 = 1.0/(t166669*t166669*t166669);
            double t166746 = t166670*t166671*t166739*t166695*(1.4000771998813E29/4.951760157141521E27);
            double t166747 = t166744+t166746-t166740*t166670*t166671*t166745*(1.4000771998813E29/2.475880078570761E27) \
               -t166670*t166690*t166675*t166695*(1.4000771998813E29/3.713820117856141E27);
            double t166748 = t166697*t166697;
            v_rho_a_rho_a_[index] = t166704*t166669*(omega*t166722*t166660*t166674*(5.62949953421312E14/3.367584493229313E15) \
               -omega*t166703*t166674*t166687*(1.125899906842624E15/1.010275347968794E16)+omega*t166674*t166675*(t166708* \
               t166673*(t166715*t166677*t166679*(3.74176054803257E14/3.16659348799488E14)+t166710*t166680*t166739* \
               t166677*(3.74176054803257E14/1.40737488355328E14)-t166710*t166690*t166677*t166678*(3.74176054803257E14/ \
               2.11106232532992E14)-t166740*t166680*t166677*1.0/pow(t166669,5.0/2.0)*(1.122528164409771E15/2.81474976710656E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t166660*t166718*t166674*(1.40737488355328E14/1.122528164409771E15) \
               +omega*t166674*t166687*t166699*(2.81474976710656E14/3.367584493229313E15)+t166712*t166708*t166673* \
               t166697*(3.991211251234741E15/1.125899906842624E15)+omega*t166674*t166675*(-t166673*t166747-t166673* \
               t166748+t166715*t166690*t166692*t166693*(9.903520314283042E27/4.2002315996439E29)+t166692*t166666* \
               t166693*t166669*(2.475880078570761E28/1.26006947989317E30)+t166692*t166693*t166739*t166678*(2.475880078570761E27/ \
               1.4000771998813E29)+t166715*t166673*t166692*t166669*t166697*(9.903520314283042E27/4.2002315996439E29) \
               +t166690*t166673*t166692*t166678*t166697*(4.951760157141521E27/1.4000771998813E29)+t166673*t166692* \
               t166747*t166669*t166678*(2.475880078570761E27/1.4000771998813E29)+t166673*t166692*t166748*t166669* \
               t166678*(2.475880078570761E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14)-omega* \
               t166710*t166740*t166675*t166699*(1.7592186044416E13/3.74176054803257E14)+omega*t166690*t166718*t166675* \
               t166679*(7.0368744177664E13/3.74176054803257E14)+omega*t166660*t166690*t166679*t166699*(7.0368744177664E13/ \
               1.122528164409771E15)+omega*t166675*t166739*t166679*t166699*(3.5184372088832E13/3.74176054803257E14) \
               )*(2.81474976710656E14/1.122528164409771E15)+omega*t166710*t166703*t166740*t166675*(7.0368744177664E13/ \
               1.122528164409771E15)-omega*t166703*t166660*t166690*t166679*(2.81474976710656E14/3.367584493229313E15) \
               +omega*t166722*t166690*t166675*t166679*(2.81474976710656E14/1.122528164409771E15)-omega*t166703*t166675* \
               t166739*t166679*(1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t166704*t166724*t166690-t166680* \
               t166690*t166726*(4.0/3.0)+t166704*t166726*t166739*(1.0/2.0)-t166724*t166680*t166669*(4.0/3.0)+t166726* \
               t166669*t166678*(2.0/9.0);
        } else if (rho_a[index] > cutoff_) {
            double t167717 = sqrt(gamma_aa[index]);
            double t167718 = 1.0/pow(rho_a[index],4.0/3.0);
            double t167719 = t167717*t167718;
            double t167720 = log(t167719+sqrt(t167719*t167719+1.0));
            double t167721 = d*t167720*t167717*t167718*6.0;
            double t167722 = t167721+1.0;
            double t167723 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t167724 = 1.0/pow(rho_a[index],8.0/3.0);
            double t167725 = 1.0/t167722;
            double t167726 = d*gamma_aa[index]*t167724*t167725*2.0;
            double t167727 = t167726+4.190715359480463E15/2.251799813685248E15;
            double t167728 = 1.0/(omega*omega);
            double t167729 = pow(rho_a[index],2.0/3.0);
            double t167730 = 1.0/t167727;
            double t167734 = t167730*t167728*t167729*(1.4000771998813E29/4.951760157141521E27);
            double t167731 = exp(-t167734);
            double t167732 = sqrt(t167727);
            double t167733 = 1.0/pow(rho_a[index],1.0/3.0);
            double t167735 = 1.0/omega;
            double t167736 = 1.0/pow(rho_a[index],2.0/3.0);
            double t167737 = 1.0/sqrt(t167727);
            double t167738 = pow(rho_a[index],1.0/3.0);
            double t167739 = d*gamma_aa[index]*t167723*t167725*(1.6E1/3.0);
            double t167740 = 1.0/(t167722*t167722);
            double t167741 = gamma_aa[index]*t167724;
            double t167742 = t167741+1.0;
            double t167743 = 1.0/sqrt(t167742);
            double t167744 = d*gamma_aa[index]*t167723*t167743*8.0;
            double t167745 = 1.0/pow(rho_a[index],7.0/3.0);
            double t167746 = d*t167720*t167717*t167745*8.0;
            double t167747 = t167744+t167746;
            double t167749 = d*gamma_aa[index]*t167740*t167724*t167747*2.0;
            double t167748 = t167739-t167749;
            double t167750 = omega*omega;
            double t167751 = t167731-1.0;
            double t167752 = t167730*t167733*t167728*(1.4000771998813E29/7.427640235712282E27);
            double t167753 = 1.0/(t167727*t167727);
            double t167754 = t167753*t167728*t167729*t167748*(1.4000771998813E29/4.951760157141521E27);
            double t167755 = t167752+t167754;
            double t167756 = t167750*t167751*t167727*t167736*(2.475880078570761E27/1.4000771998813E29);
            double t167757 = -t167731+t167756+3.0/2.0;
            double t167758 = t167735*t167737*t167738*(3.74176054803257E14/7.0368744177664E13);
            double t167759 = erf(t167758);
            double t167760 = t167759*(3.991211251234741E15/2.251799813685248E15);
            double t167763 = omega*t167732*t167733*t167757*(7.0368744177664E13/3.74176054803257E14);
            double t167761 = t167760-t167763;
            double t167762 = pow(rho_a[index],4.0/3.0);
            double t167764 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t167765 = omega*t167732*t167761*t167718*(2.81474976710656E14/3.367584493229313E15);
            double t167766 = 1.0/sqrt(3.141592653589793);
            double t167767 = t167735*t167736*t167737*(3.74176054803257E14/2.11106232532992E14);
            double t167768 = 1.0/pow(t167727,3.0/2.0);
            double t167769 = t167735*t167738*t167748*t167768*(3.74176054803257E14/1.40737488355328E14);
            double t167770 = t167767+t167769;
            double t167771 = t167731*t167770*t167766*(3.991211251234741E15/1.125899906842624E15);
            double t167772 = t167750*t167751*t167736*t167748*(2.475880078570761E27/1.4000771998813E29);
            double t167773 = 1.0/pow(rho_a[index],5.0/3.0);
            double t167774 = t167750*t167751*t167727*t167773*(4.951760157141521E27/4.2002315996439E29);
            double t167775 = t167731*t167750*t167727*t167736*t167755*(2.475880078570761E27/1.4000771998813E29) \
               ;
            double t167785 = t167731*t167755;
            double t167776 = t167772+t167774+t167775-t167785;
            double t167777 = omega*t167732*t167733*t167776*(7.0368744177664E13/3.74176054803257E14);
            double t167778 = omega*t167732*t167718*t167757*(7.0368744177664E13/1.122528164409771E15);
            double t167779 = omega*t167733*t167737*t167748*t167757*(3.5184372088832E13/3.74176054803257E14);
            double t167780 = t167771+t167777+t167778+t167779;
            double t167781 = omega*t167733*t167761*t167737*t167748*(1.40737488355328E14/1.122528164409771E15) \
               ;
            double t167782 = t167781+t167765-omega*t167732*t167733*t167780*(2.81474976710656E14/1.122528164409771E15) \
               ;
            double t167783 = omega*t167732*t167733*t167761*(2.81474976710656E14/1.122528164409771E15);
            double t167784 = t167783-1.0;
            double t167786 = d*gamma_aa[index]*t167725*t167764*(1.76E2/9.0);
            double t167787 = 1.0/(t167722*t167722*t167722);
            double t167788 = t167747*t167747;
            double t167789 = d*gamma_aa[index]*t167724*t167787*t167788*4.0;
            double t167790 = d*gamma_aa[index]*t167743*t167764*4.0E1;
            double t167791 = gamma_aa[index]*gamma_aa[index];
            double t167792 = 1.0/pow(rho_a[index],2.2E1/3.0);
            double t167793 = 1.0/pow(t167742,3.0/2.0);
            double t167794 = 1.0/pow(rho_a[index],1.0E1/3.0);
            double t167795 = d*t167720*t167717*t167794*(5.6E1/3.0);
            double t167799 = d*t167791*t167792*t167793*(3.2E1/3.0);
            double t167796 = t167790+t167795-t167799;
            double t167800 = d*gamma_aa[index]*t167740*t167724*t167796*2.0;
            double t167801 = d*gamma_aa[index]*t167740*t167723*t167747*(3.2E1/3.0);
            double t167797 = -t167800-t167801+t167786+t167789;
            double t167798 = t167748*t167748;
            double t167802 = t167730*t167718*t167728*(1.4000771998813E29/2.228292070713684E28);
            double t167803 = 1.0/(t167727*t167727*t167727);
            double t167804 = t167753*t167728*t167729*t167797*(1.4000771998813E29/4.951760157141521E27);
            double t167805 = t167802+t167804-t167733*t167753*t167728*t167748*(1.4000771998813E29/3.713820117856141E27) \
               -t167803*t167728*t167729*t167798*(1.4000771998813E29/2.475880078570761E27);
            double t167806 = t167755*t167755;
            v_rho_a_rho_a_[index] = t167762*t167727*(omega*t167732*t167761*t167745*(-1.125899906842624E15/1.010275347968794E16) \
               +omega*t167732*t167780*t167718*(5.62949953421312E14/3.367584493229313E15)+omega*t167732*t167733*(t167731* \
               t167766*(t167735*t167737*t167773*(3.74176054803257E14/3.16659348799488E14)-t167735*t167736*t167748* \
               t167768*(3.74176054803257E14/2.11106232532992E14)+t167735*t167738*t167768*t167797*(3.74176054803257E14/ \
               1.40737488355328E14)-t167735*1.0/pow(t167727,5.0/2.0)*t167738*t167798*(1.122528164409771E15/2.81474976710656E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t167732*t167745*t167757*(2.81474976710656E14/3.367584493229313E15) \
               +omega*t167732*t167718*t167776*(1.40737488355328E14/1.122528164409771E15)+t167731*t167770*t167755* \
               t167766*(3.991211251234741E15/1.125899906842624E15)+omega*t167732*t167733*(-t167731*t167805-t167731* \
               t167806+t167750*t167724*t167751*t167727*(2.475880078570761E28/1.26006947989317E30)+t167750*t167751* \
               t167773*t167748*(9.903520314283042E27/4.2002315996439E29)+t167750*t167751*t167736*t167797*(2.475880078570761E27/ \
               1.4000771998813E29)+t167731*t167750*t167805*t167727*t167736*(2.475880078570761E27/1.4000771998813E29) \
               +t167731*t167750*t167806*t167727*t167736*(2.475880078570761E27/1.4000771998813E29)+t167731*t167750* \
               t167727*t167755*t167773*(9.903520314283042E27/4.2002315996439E29)+t167731*t167750*t167736*t167755* \
               t167748*(4.951760157141521E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14)+omega* \
               t167733*t167737*t167748*t167776*(7.0368744177664E13/3.74176054803257E14)+omega*t167718*t167737*t167748* \
               t167757*(7.0368744177664E13/1.122528164409771E15)+omega*t167733*t167737*t167757*t167797*(3.5184372088832E13/ \
               3.74176054803257E14)-omega*t167733*t167757*t167768*t167798*(1.7592186044416E13/3.74176054803257E14) \
               )*(2.81474976710656E14/1.122528164409771E15)+omega*t167733*t167780*t167737*t167748*(2.81474976710656E14/ \
               1.122528164409771E15)-omega*t167761*t167718*t167737*t167748*(2.81474976710656E14/3.367584493229313E15) \
               -omega*t167733*t167761*t167737*t167797*(1.40737488355328E14/1.122528164409771E15)+omega*t167733*t167761* \
               t167768*t167798*(7.0368744177664E13/1.122528164409771E15))*(-1.0/2.0)+t167762*t167782*t167748+t167727* \
               t167736*t167784*(2.0/9.0)-t167727*t167782*t167738*(4.0/3.0)-t167738*t167748*t167784*(4.0/3.0)+t167762* \
               t167784*t167797*(1.0/2.0);
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_a_[index] = 0.0;
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        //V_rho_a_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_a[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else {
            v_rho_a_rho_b_[index] = 0.0;
        } 

        //V_rho_b_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t166751 = sqrt(gamma_bb[index]);
            double t166752 = 1.0/pow(rho_b[index],4.0/3.0);
            double t166753 = t166751*t166752;
            double t166754 = log(t166753+sqrt(t166753*t166753+1.0));
            double t166755 = d*t166751*t166752*t166754*6.0;
            double t166756 = t166755+1.0;
            double t166757 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t166758 = 1.0/pow(rho_b[index],8.0/3.0);
            double t166759 = 1.0/t166756;
            double t166760 = d*gamma_bb[index]*t166758*t166759*2.0;
            double t166761 = t166760+4.190715359480463E15/2.251799813685248E15;
            double t166762 = 1.0/(omega*omega);
            double t166763 = pow(rho_b[index],2.0/3.0);
            double t166764 = 1.0/t166761;
            double t166768 = t166762*t166763*t166764*(1.4000771998813E29/4.951760157141521E27);
            double t166765 = exp(-t166768);
            double t166766 = sqrt(t166761);
            double t166767 = 1.0/pow(rho_b[index],1.0/3.0);
            double t166769 = 1.0/omega;
            double t166770 = 1.0/pow(rho_b[index],2.0/3.0);
            double t166771 = 1.0/sqrt(t166761);
            double t166772 = pow(rho_b[index],1.0/3.0);
            double t166773 = d*gamma_bb[index]*t166757*t166759*(1.6E1/3.0);
            double t166774 = 1.0/(t166756*t166756);
            double t166775 = gamma_bb[index]*t166758;
            double t166776 = t166775+1.0;
            double t166777 = 1.0/sqrt(t166776);
            double t166778 = d*gamma_bb[index]*t166757*t166777*8.0;
            double t166779 = 1.0/pow(rho_b[index],7.0/3.0);
            double t166780 = d*t166751*t166754*t166779*8.0;
            double t166781 = t166780+t166778;
            double t166783 = d*gamma_bb[index]*t166781*t166774*t166758*2.0;
            double t166782 = t166773-t166783;
            double t166784 = omega*omega;
            double t166785 = t166765-1.0;
            double t166786 = t166762*t166764*t166767*(1.4000771998813E29/7.427640235712282E27);
            double t166787 = 1.0/(t166761*t166761);
            double t166788 = t166762*t166763*t166782*t166787*(1.4000771998813E29/4.951760157141521E27);
            double t166789 = t166786+t166788;
            double t166790 = t166761*t166770*t166784*t166785*(2.475880078570761E27/1.4000771998813E29);
            double t166791 = t166790-t166765+3.0/2.0;
            double t166792 = t166771*t166772*t166769*(3.74176054803257E14/7.0368744177664E13);
            double t166793 = erf(t166792);
            double t166794 = t166793*(3.991211251234741E15/2.251799813685248E15);
            double t166797 = omega*t166791*t166766*t166767*(7.0368744177664E13/3.74176054803257E14);
            double t166795 = t166794-t166797;
            double t166796 = pow(rho_b[index],4.0/3.0);
            double t166798 = 1.0/pow(rho_b[index],1.4E1/3.0);
            double t166799 = omega*t166752*t166766*t166795*(2.81474976710656E14/3.367584493229313E15);
            double t166800 = 1.0/sqrt(3.141592653589793);
            double t166801 = t166770*t166771*t166769*(3.74176054803257E14/2.11106232532992E14);
            double t166802 = 1.0/pow(t166761,3.0/2.0);
            double t166803 = t166802*t166772*t166782*t166769*(3.74176054803257E14/1.40737488355328E14);
            double t166804 = t166801+t166803;
            double t166805 = t166800*t166804*t166765*(3.991211251234741E15/1.125899906842624E15);
            double t166806 = t166770*t166782*t166784*t166785*(2.475880078570761E27/1.4000771998813E29);
            double t166807 = 1.0/pow(rho_b[index],5.0/3.0);
            double t166808 = t166761*t166807*t166784*t166785*(4.951760157141521E27/4.2002315996439E29);
            double t166809 = t166761*t166770*t166765*t166784*t166789*(2.475880078570761E27/1.4000771998813E29) \
               ;
            double t166819 = t166765*t166789;
            double t166810 = t166806+t166808+t166809-t166819;
            double t166811 = omega*t166810*t166766*t166767*(7.0368744177664E13/3.74176054803257E14);
            double t166812 = omega*t166752*t166791*t166766*(7.0368744177664E13/1.122528164409771E15);
            double t166813 = omega*t166771*t166782*t166791*t166767*(3.5184372088832E13/3.74176054803257E14);
            double t166814 = t166811+t166812+t166813+t166805;
            double t166815 = omega*t166771*t166782*t166767*t166795*(1.40737488355328E14/1.122528164409771E15) \
               ;
            double t166816 = t166815+t166799-omega*t166814*t166766*t166767*(2.81474976710656E14/1.122528164409771E15) \
               ;
            double t166817 = omega*t166766*t166767*t166795*(2.81474976710656E14/1.122528164409771E15);
            double t166818 = t166817-1.0;
            double t166820 = d*gamma_bb[index]*t166759*t166798*(1.76E2/9.0);
            double t166821 = 1.0/(t166756*t166756*t166756);
            double t166822 = t166781*t166781;
            double t166823 = d*gamma_bb[index]*t166821*t166822*t166758*4.0;
            double t166824 = d*gamma_bb[index]*t166777*t166798*4.0E1;
            double t166825 = gamma_bb[index]*gamma_bb[index];
            double t166826 = 1.0/pow(rho_b[index],2.2E1/3.0);
            double t166827 = 1.0/pow(t166776,3.0/2.0);
            double t166828 = 1.0/pow(rho_b[index],1.0E1/3.0);
            double t166829 = d*t166751*t166754*t166828*(5.6E1/3.0);
            double t166833 = d*t166825*t166826*t166827*(3.2E1/3.0);
            double t166830 = t166824-t166833+t166829;
            double t166834 = d*gamma_bb[index]*t166830*t166774*t166758*2.0;
            double t166835 = d*gamma_bb[index]*t166781*t166774*t166757*(3.2E1/3.0);
            double t166831 = t166820+t166823-t166834-t166835;
            double t166832 = t166782*t166782;
            double t166836 = t166752*t166762*t166764*(1.4000771998813E29/2.228292070713684E28);
            double t166837 = 1.0/(t166761*t166761*t166761);
            double t166838 = t166831*t166762*t166763*t166787*(1.4000771998813E29/4.951760157141521E27);
            double t166839 = t166836+t166838-t166832*t166762*t166763*t166837*(1.4000771998813E29/2.475880078570761E27) \
               -t166762*t166782*t166767*t166787*(1.4000771998813E29/3.713820117856141E27);
            double t166840 = t166789*t166789;
            v_rho_b_rho_b_[index] = t166761*t166796*(omega*t166814*t166752*t166766*(5.62949953421312E14/3.367584493229313E15) \
               -omega*t166766*t166795*t166779*(1.125899906842624E15/1.010275347968794E16)+omega*t166766*t166767*(t166800* \
               t166765*(t166771*t166807*t166769*(3.74176054803257E14/3.16659348799488E14)+t166802*t166831*t166772* \
               t166769*(3.74176054803257E14/1.40737488355328E14)-t166802*t166770*t166782*t166769*(3.74176054803257E14/ \
               2.11106232532992E14)-t166832*1.0/pow(t166761,5.0/2.0)*t166772*t166769*(1.122528164409771E15/2.81474976710656E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t166810*t166752*t166766*(1.40737488355328E14/1.122528164409771E15) \
               +omega*t166791*t166766*t166779*(2.81474976710656E14/3.367584493229313E15)+t166800*t166804*t166765* \
               t166789*(3.991211251234741E15/1.125899906842624E15)+omega*t166766*t166767*(-t166840*t166765-t166765* \
               t166839+t166831*t166770*t166784*t166785*(2.475880078570761E27/1.4000771998813E29)+t166807*t166782* \
               t166784*t166785*(9.903520314283042E27/4.2002315996439E29)+t166761*t166784*t166758*t166785*(2.475880078570761E28/ \
               1.26006947989317E30)+t166840*t166761*t166770*t166765*t166784*(2.475880078570761E27/1.4000771998813E29) \
               +t166761*t166770*t166765*t166784*t166839*(2.475880078570761E27/1.4000771998813E29)+t166761*t166807* \
               t166765*t166784*t166789*(9.903520314283042E27/4.2002315996439E29)+t166770*t166782*t166765*t166784* \
               t166789*(4.951760157141521E27/1.4000771998813E29))*(7.0368744177664E13/3.74176054803257E14)-omega* \
               t166802*t166832*t166791*t166767*(1.7592186044416E13/3.74176054803257E14)+omega*t166810*t166771*t166782* \
               t166767*(7.0368744177664E13/3.74176054803257E14)+omega*t166752*t166771*t166782*t166791*(7.0368744177664E13/ \
               1.122528164409771E15)+omega*t166831*t166771*t166791*t166767*(3.5184372088832E13/3.74176054803257E14) \
               )*(2.81474976710656E14/1.122528164409771E15)+omega*t166802*t166832*t166767*t166795*(7.0368744177664E13/ \
               1.122528164409771E15)+omega*t166814*t166771*t166782*t166767*(2.81474976710656E14/1.122528164409771E15) \
               -omega*t166752*t166771*t166782*t166795*(2.81474976710656E14/3.367584493229313E15)-omega*t166831*t166771* \
               t166767*t166795*(1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)+t166761*t166770*t166818*(2.0/ \
               9.0)-t166761*t166816*t166772*(4.0/3.0)-t166772*t166782*t166818*(4.0/3.0)+t166831*t166818*t166796*(1.0/ \
               2.0)+t166816*t166782*t166796;
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t167319 = sqrt(gamma_bb[index]);
            double t167320 = 1.0/pow(rho_b[index],4.0/3.0);
            double t167321 = t167320*t167319;
            double t167322 = log(t167321+sqrt(t167321*t167321+1.0));
            double t167323 = d*t167320*t167322*t167319*6.0;
            double t167324 = t167323+1.0;
            double t167325 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t167326 = 1.0/pow(rho_b[index],8.0/3.0);
            double t167327 = 1.0/t167324;
            double t167328 = d*gamma_bb[index]*t167326*t167327*2.0;
            double t167329 = t167328+4.190715359480463E15/2.251799813685248E15;
            double t167330 = 1.0/(omega*omega);
            double t167331 = pow(rho_b[index],2.0/3.0);
            double t167332 = 1.0/t167329;
            double t167336 = t167330*t167331*t167332*(1.4000771998813E29/4.951760157141521E27);
            double t167333 = exp(-t167336);
            double t167334 = sqrt(t167329);
            double t167335 = 1.0/pow(rho_b[index],1.0/3.0);
            double t167337 = 1.0/omega;
            double t167338 = 1.0/pow(rho_b[index],2.0/3.0);
            double t167339 = 1.0/sqrt(t167329);
            double t167340 = pow(rho_b[index],1.0/3.0);
            double t167341 = d*gamma_bb[index]*t167325*t167327*(1.6E1/3.0);
            double t167342 = 1.0/(t167324*t167324);
            double t167343 = gamma_bb[index]*t167326;
            double t167344 = t167343+1.0;
            double t167345 = 1.0/sqrt(t167344);
            double t167346 = d*gamma_bb[index]*t167325*t167345*8.0;
            double t167347 = 1.0/pow(rho_b[index],7.0/3.0);
            double t167348 = d*t167322*t167319*t167347*8.0;
            double t167349 = t167346+t167348;
            double t167351 = d*gamma_bb[index]*t167342*t167326*t167349*2.0;
            double t167350 = t167341-t167351;
            double t167352 = omega*omega;
            double t167353 = t167333-1.0;
            double t167354 = t167330*t167332*t167335*(1.4000771998813E29/7.427640235712282E27);
            double t167355 = 1.0/(t167329*t167329);
            double t167356 = t167330*t167331*t167350*t167355*(1.4000771998813E29/4.951760157141521E27);
            double t167357 = t167354+t167356;
            double t167358 = t167352*t167353*t167329*t167338*(2.475880078570761E27/1.4000771998813E29);
            double t167359 = -t167333+t167358+3.0/2.0;
            double t167360 = t167340*t167337*t167339*(3.74176054803257E14/7.0368744177664E13);
            double t167361 = erf(t167360);
            double t167362 = t167361*(3.991211251234741E15/2.251799813685248E15);
            double t167365 = omega*t167334*t167335*t167359*(7.0368744177664E13/3.74176054803257E14);
            double t167363 = t167362-t167365;
            double t167364 = pow(rho_b[index],4.0/3.0);
            double t167366 = 1.0/pow(rho_b[index],1.4E1/3.0);
            double t167367 = omega*t167320*t167334*t167363*(2.81474976710656E14/3.367584493229313E15);
            double t167368 = 1.0/sqrt(3.141592653589793);
            double t167369 = t167337*t167338*t167339*(3.74176054803257E14/2.11106232532992E14);
            double t167370 = 1.0/pow(t167329,3.0/2.0);
            double t167371 = t167340*t167350*t167370*t167337*(3.74176054803257E14/1.40737488355328E14);
            double t167372 = t167371+t167369;
            double t167373 = t167333*t167372*t167368*(3.991211251234741E15/1.125899906842624E15);
            double t167374 = t167350*t167352*t167353*t167338*(2.475880078570761E27/1.4000771998813E29);
            double t167375 = 1.0/pow(rho_b[index],5.0/3.0);
            double t167376 = t167352*t167353*t167329*t167375*(4.951760157141521E27/4.2002315996439E29);
            double t167377 = t167333*t167352*t167329*t167338*t167357*(2.475880078570761E27/1.4000771998813E29) \
               ;
            double t167387 = t167333*t167357;
            double t167378 = t167374+t167376+t167377-t167387;
            double t167379 = omega*t167334*t167335*t167378*(7.0368744177664E13/3.74176054803257E14);
            double t167380 = omega*t167320*t167334*t167359*(7.0368744177664E13/1.122528164409771E15);
            double t167381 = omega*t167350*t167335*t167339*t167359*(3.5184372088832E13/3.74176054803257E14);
            double t167382 = t167380+t167381+t167373+t167379;
            double t167383 = omega*t167350*t167335*t167363*t167339*(1.40737488355328E14/1.122528164409771E15) \
               ;
            double t167384 = t167383+t167367-omega*t167334*t167335*t167382*(2.81474976710656E14/1.122528164409771E15) \
               ;
            double t167385 = omega*t167334*t167335*t167363*(2.81474976710656E14/1.122528164409771E15);
            double t167386 = t167385-1.0;
            double t167388 = d*gamma_bb[index]*t167327*t167366*(1.76E2/9.0);
            double t167389 = 1.0/(t167324*t167324*t167324);
            double t167390 = t167349*t167349;
            double t167391 = d*gamma_bb[index]*t167326*t167390*t167389*4.0;
            double t167392 = d*gamma_bb[index]*t167345*t167366*4.0E1;
            double t167393 = gamma_bb[index]*gamma_bb[index];
            double t167394 = 1.0/pow(rho_b[index],2.2E1/3.0);
            double t167395 = 1.0/pow(t167344,3.0/2.0);
            double t167396 = 1.0/pow(rho_b[index],1.0E1/3.0);
            double t167397 = d*t167322*t167319*t167396*(5.6E1/3.0);
            double t167401 = d*t167393*t167394*t167395*(3.2E1/3.0);
            double t167398 = -t167401+t167392+t167397;
            double t167402 = d*gamma_bb[index]*t167342*t167326*t167398*2.0;
            double t167403 = d*gamma_bb[index]*t167342*t167325*t167349*(3.2E1/3.0);
            double t167399 = -t167402-t167403+t167391+t167388;
            double t167400 = t167350*t167350;
            double t167404 = t167320*t167330*t167332*(1.4000771998813E29/2.228292070713684E28);
            double t167405 = 1.0/(t167329*t167329*t167329);
            double t167406 = t167330*t167331*t167355*t167399*(1.4000771998813E29/4.951760157141521E27);
            double t167407 = t167404+t167406-t167400*t167330*t167331*t167405*(1.4000771998813E29/2.475880078570761E27) \
               -t167330*t167350*t167335*t167355*(1.4000771998813E29/3.713820117856141E27);
            double t167408 = t167357*t167357;
            v_rho_b_rho_b_[index] = t167364*t167329*(omega*t167320*t167334*t167382*(5.62949953421312E14/3.367584493229313E15) \
               -omega*t167334*t167363*t167347*(1.125899906842624E15/1.010275347968794E16)+omega*t167334*t167335*(t167333* \
               t167368*(t167337*t167339*t167375*(3.74176054803257E14/3.16659348799488E14)-t167350*t167370*t167337* \
               t167338*(3.74176054803257E14/2.11106232532992E14)+t167340*t167370*t167337*t167399*(3.74176054803257E14/ \
               1.40737488355328E14)-t167400*t167340*t167337*1.0/pow(t167329,5.0/2.0)*(1.122528164409771E15/2.81474976710656E14) \
               )*(3.991211251234741E15/1.125899906842624E15)+omega*t167320*t167334*t167378*(1.40737488355328E14/1.122528164409771E15) \
               +omega*t167334*t167347*t167359*(2.81474976710656E14/3.367584493229313E15)+t167333*t167372*t167357* \
               t167368*(3.991211251234741E15/1.125899906842624E15)+omega*t167334*t167335*(-t167333*t167407-t167333* \
               t167408+t167350*t167352*t167353*t167375*(9.903520314283042E27/4.2002315996439E29)+t167352*t167326* \
               t167353*t167329*(2.475880078570761E28/1.26006947989317E30)+t167352*t167353*t167338*t167399*(2.475880078570761E27/ \
               1.4000771998813E29)+t167350*t167333*t167352*t167338*t167357*(4.951760157141521E27/1.4000771998813E29) \
               +t167333*t167352*t167407*t167329*t167338*(2.475880078570761E27/1.4000771998813E29)+t167333*t167352* \
               t167408*t167329*t167338*(2.475880078570761E27/1.4000771998813E29)+t167333*t167352*t167329*t167357* \
               t167375*(9.903520314283042E27/4.2002315996439E29))*(7.0368744177664E13/3.74176054803257E14)-omega* \
               t167400*t167370*t167335*t167359*(1.7592186044416E13/3.74176054803257E14)+omega*t167320*t167350*t167339* \
               t167359*(7.0368744177664E13/1.122528164409771E15)+omega*t167350*t167335*t167339*t167378*(7.0368744177664E13/ \
               3.74176054803257E14)+omega*t167335*t167339*t167359*t167399*(3.5184372088832E13/3.74176054803257E14) \
               )*(2.81474976710656E14/1.122528164409771E15)+omega*t167400*t167370*t167335*t167363*(7.0368744177664E13/ \
               1.122528164409771E15)-omega*t167320*t167350*t167363*t167339*(2.81474976710656E14/3.367584493229313E15) \
               +omega*t167350*t167335*t167382*t167339*(2.81474976710656E14/1.122528164409771E15)-omega*t167335*t167363* \
               t167339*t167399*(1.40737488355328E14/1.122528164409771E15))*(-1.0/2.0)-t167340*t167350*t167386*(4.0/ \
               3.0)-t167340*t167329*t167384*(4.0/3.0)+t167350*t167364*t167384+t167329*t167338*t167386*(2.0/9.0)+t167364* \
               t167386*t167399*(1.0/2.0);
        } else {
            v_rho_b_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t166842 = sqrt(gamma_aa[index]);
                double t166843 = 1.0/pow(rho_a[index],4.0/3.0);
                double t166844 = 1.0/pow(rho_a[index],8.0/3.0);
                double t166845 = t166842*t166843;
                double t166846 = log(t166845+sqrt(t166845*t166845+1.0));
                double t166847 = d*t166842*t166843*t166846*6.0;
                double t166848 = t166847+1.0;
                double t166849 = 1.0/t166848;
                double t166850 = d*gamma_aa[index]*t166844*t166849*2.0;
                double t166851 = t166850+4.190715359480463E15/2.251799813685248E15;
                double t166852 = 1.0/(omega*omega);
                double t166853 = pow(rho_a[index],2.0/3.0);
                double t166854 = 1.0/t166851;
                double t166858 = t166852*t166853*t166854*(1.4000771998813E29/4.951760157141521E27);
                double t166855 = exp(-t166858);
                double t166856 = sqrt(t166851);
                double t166857 = 1.0/pow(rho_a[index],1.0/3.0);
                double t166859 = 1.0/omega;
                double t166860 = 1.0/pow(rho_a[index],2.0/3.0);
                double t166861 = 1.0/sqrt(t166851);
                double t166862 = pow(rho_a[index],1.0/3.0);
                double t166863 = 1.0/(t166848*t166848);
                double t166864 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t166865 = gamma_aa[index]*t166844;
                double t166866 = t166865+1.0;
                double t166867 = 1.0/sqrt(t166866);
                double t166868 = d*gamma_aa[index]*t166864*t166849*(1.6E1/3.0);
                double t166869 = d*gamma_aa[index]*t166864*t166867*8.0;
                double t166870 = 1.0/pow(rho_a[index],7.0/3.0);
                double t166871 = d*t166842*t166870*t166846*8.0;
                double t166872 = t166871+t166869;
                double t166876 = d*gamma_aa[index]*t166844*t166863*t166872*2.0;
                double t166873 = -t166876+t166868;
                double t166874 = omega*omega;
                double t166875 = t166855-1.0;
                double t166877 = t166852*t166854*t166857*(1.4000771998813E29/7.427640235712282E27);
                double t166878 = 1.0/(t166851*t166851);
                double t166879 = t166852*t166853*t166873*t166878*(1.4000771998813E29/4.951760157141521E27);
                double t166880 = t166877+t166879;
                double t166881 = t166851*t166860*t166874*t166875*(2.475880078570761E27/1.4000771998813E29);
                double t166882 = t166881-t166855+3.0/2.0;
                double t166883 = t166861*t166862*t166859*(3.74176054803257E14/7.0368744177664E13);
                double t166884 = erf(t166883);
                double t166885 = t166884*(3.991211251234741E15/2.251799813685248E15);
                double t166933 = omega*t166882*t166856*t166857*(7.0368744177664E13/3.74176054803257E14);
                double t166886 = -t166933+t166885;
                double t166887 = pow(rho_a[index],4.0/3.0);
                double t166888 = 1.0/sqrt(3.141592653589793);
                double t166889 = 1.0/pow(t166851,3.0/2.0);
                double t166890 = d*t166844*t166849*2.0;
                double t166891 = d*t166844*t166867*3.0;
                double t166892 = 1.0/sqrt(gamma_aa[index]);
                double t166893 = d*t166843*t166846*t166892*3.0;
                double t166894 = t166891+t166893;
                double t166896 = d*gamma_aa[index]*t166844*t166863*t166894*2.0;
                double t166895 = t166890-t166896;
                double t166897 = d*t166844*t166863*t166872*2.0;
                double t166898 = d*gamma_aa[index]*t166863*t166864*t166894*(1.6E1/3.0);
                double t166899 = d*t166864*t166867*1.2E1;
                double t166900 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t166901 = 1.0/pow(t166866,3.0/2.0);
                double t166902 = d*t166870*t166846*t166892*4.0;
                double t166909 = d*gamma_aa[index]*t166900*t166901*4.0;
                double t166903 = t166902-t166909+t166899;
                double t166904 = d*gamma_aa[index]*t166903*t166844*t166863*2.0;
                double t166905 = 1.0/(t166848*t166848*t166848);
                double t166908 = d*t166864*t166849*(1.6E1/3.0);
                double t166910 = d*gamma_aa[index]*t166905*t166844*t166872*t166894*4.0;
                double t166906 = -t166910+t166904-t166908+t166897+t166898;
                double t166907 = 1.0/pow(rho_a[index],5.0/3.0);
                double t166911 = t166852*t166857*t166895*t166878*(1.4000771998813E29/7.427640235712282E27);
                double t166912 = t166852*t166906*t166853*t166878*(1.4000771998813E29/4.951760157141521E27);
                double t166913 = 1.0/(t166851*t166851*t166851);
                double t166914 = t166913*t166852*t166853*t166873*t166895*(1.4000771998813E29/2.475880078570761E27) \
                   ;
                double t166915 = t166911+t166912+t166914;
                double t166916 = t166854*t166855*t166895*(1.0/2.0);
                double t166917 = t166860*t166874*t166875*t166895*(2.475880078570761E27/1.4000771998813E29);
                double t166926 = t166852*t166853*t166855*t166895*t166878*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t166918 = t166916+t166917-t166926;
                double t166919 = t166860*t166873*t166874*t166875*(2.475880078570761E27/1.4000771998813E29);
                double t166920 = t166851*t166907*t166874*t166875*(4.951760157141521E27/4.2002315996439E29);
                double t166921 = t166851*t166860*t166880*t166855*t166874*(2.475880078570761E27/1.4000771998813E29) \
                   ;
                double t166928 = t166880*t166855;
                double t166922 = t166920+t166921+t166919-t166928;
                double t166923 = t166860*t166861*t166859*(3.74176054803257E14/2.11106232532992E14);
                double t166924 = t166862*t166873*t166859*t166889*(3.74176054803257E14/1.40737488355328E14);
                double t166925 = t166923+t166924;
                double t166927 = t166925*t166855*t166888*(3.991211251234741E15/1.125899906842624E15);
                double t166929 = omega*t166922*t166856*t166857*(7.0368744177664E13/3.74176054803257E14);
                double t166930 = omega*t166843*t166882*t166856*(7.0368744177664E13/1.122528164409771E15);
                double t166931 = omega*t166861*t166873*t166882*t166857*(3.5184372088832E13/3.74176054803257E14);
                double t166932 = t166930+t166931+t166927+t166929;
                double t166934 = omega*t166918*t166856*t166857*(7.0368744177664E13/3.74176054803257E14);
                double t166935 = omega*t166861*t166882*t166857*t166895*(3.5184372088832E13/3.74176054803257E14);
                double t166936 = t166862*t166855*t166859*t166895*t166888*t166889*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t166937 = t166934+t166935+t166936;
                double t166938 = omega*t166856*t166857*t166886*(2.81474976710656E14/1.122528164409771E15);
                double t166939 = t166938-1.0;
                double t166940 = omega*t166856*t166937*t166857*(2.81474976710656E14/1.122528164409771E15);
                double t166941 = t166940-omega*t166861*t166857*t166886*t166895*(1.40737488355328E14/1.122528164409771E15) \
                   ;
                v_rho_a_gamma_aa_[index] = t166851*t166887*(omega*t166856*t166857*(t166855*t166888*(t166906*t166862* \
                   t166859*t166889*(3.74176054803257E14/1.40737488355328E14)+t166860*t166859*t166895*t166889*(3.74176054803257E14/ \
                   4.22212465065984E14)+1.0/pow(t166851,5.0/2.0)*t166862*t166873*t166859*t166895*(1.122528164409771E15/ \
                   2.81474976710656E14))*(-3.991211251234741E15/1.125899906842624E15)+omega*t166843*t166918*t166856*(7.0368744177664E13/ \
                   1.122528164409771E15)+omega*t166856*t166857*(t166915*t166855-t166860*t166906*t166874*t166875*(2.475880078570761E27/ \
                   1.4000771998813E29)+t166880*t166854*t166855*t166895*(1.0/2.0)+t166907*t166874*t166875*t166895*(4.951760157141521E27/ \
                   4.2002315996439E29)+t166855*t166873*t166895*t166878*(1.0/2.0)+(t166854*t166855*t166895*(1.0/3.0))/ \
                   rho_a[index]-t166851*t166860*t166915*t166855*t166874*(2.475880078570761E27/1.4000771998813E29)+t166860* \
                   t166880*t166855*t166874*t166895*(2.475880078570761E27/1.4000771998813E29)-t166852*t166853*t166880* \
                   t166855*t166895*t166878*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/3.74176054803257E14) \
                   -omega*t166861*t166906*t166882*t166857*(3.5184372088832E13/3.74176054803257E14)+omega*t166922*t166861* \
                   t166857*t166895*(3.5184372088832E13/3.74176054803257E14)+omega*t166843*t166861*t166882*t166895*(3.5184372088832E13/ \
                   1.122528164409771E15)+omega*t166861*t166873*t166918*t166857*(3.5184372088832E13/3.74176054803257E14) \
                   -omega*t166873*t166882*t166857*t166895*t166889*(1.7592186044416E13/3.74176054803257E14)+t166852*t166853* \
                   t166925*t166855*t166895*t166878*t166888*(5.588003872763475E44/5.575186299632656E42))*(2.81474976710656E14/ \
                   1.122528164409771E15)+omega*t166843*t166856*t166937*(2.81474976710656E14/3.367584493229313E15)+omega* \
                   t166932*t166861*t166857*t166895*(1.40737488355328E14/1.122528164409771E15)+omega*t166861*t166906*t166857* \
                   t166886*(1.40737488355328E14/1.122528164409771E15)+omega*t166861*t166873*t166937*t166857*(1.40737488355328E14/ \
                   1.122528164409771E15)-omega*t166843*t166861*t166886*t166895*(1.40737488355328E14/3.367584493229313E15) \
                   +omega*t166873*t166857*t166886*t166895*t166889*(7.0368744177664E13/1.122528164409771E15))*(1.0/2.0) \
                   -t166895*t166887*(omega*t166932*t166856*t166857*(-2.81474976710656E14/1.122528164409771E15)+omega* \
                   t166843*t166856*t166886*(2.81474976710656E14/3.367584493229313E15)+omega*t166861*t166873*t166857*t166886* \
                   (1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)-t166851*t166941*t166862*(2.0/3.0)+t166941*t166873* \
                   t166887*(1.0/2.0)+t166906*t166939*t166887*(1.0/2.0)+t166862*t166939*t166895*(2.0/3.0);
            } else if (rho_a[index] > cutoff_) {
                double t167810 = sqrt(gamma_aa[index]);
                double t167811 = 1.0/pow(rho_a[index],4.0/3.0);
                double t167812 = 1.0/pow(rho_a[index],8.0/3.0);
                double t167813 = t167810*t167811;
                double t167814 = log(t167813+sqrt(t167813*t167813+1.0));
                double t167815 = d*t167810*t167811*t167814*6.0;
                double t167816 = t167815+1.0;
                double t167817 = 1.0/t167816;
                double t167818 = d*gamma_aa[index]*t167812*t167817*2.0;
                double t167819 = t167818+4.190715359480463E15/2.251799813685248E15;
                double t167820 = 1.0/(omega*omega);
                double t167821 = pow(rho_a[index],2.0/3.0);
                double t167822 = 1.0/t167819;
                double t167826 = t167820*t167821*t167822*(1.4000771998813E29/4.951760157141521E27);
                double t167823 = exp(-t167826);
                double t167824 = sqrt(t167819);
                double t167825 = 1.0/pow(rho_a[index],1.0/3.0);
                double t167827 = 1.0/omega;
                double t167828 = 1.0/pow(rho_a[index],2.0/3.0);
                double t167829 = 1.0/sqrt(t167819);
                double t167830 = pow(rho_a[index],1.0/3.0);
                double t167831 = 1.0/(t167816*t167816);
                double t167832 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t167833 = gamma_aa[index]*t167812;
                double t167834 = t167833+1.0;
                double t167835 = 1.0/sqrt(t167834);
                double t167836 = d*gamma_aa[index]*t167832*t167817*(1.6E1/3.0);
                double t167837 = d*gamma_aa[index]*t167832*t167835*8.0;
                double t167838 = 1.0/pow(rho_a[index],7.0/3.0);
                double t167839 = d*t167810*t167814*t167838*8.0;
                double t167840 = t167837+t167839;
                double t167844 = d*gamma_aa[index]*t167812*t167831*t167840*2.0;
                double t167841 = -t167844+t167836;
                double t167842 = omega*omega;
                double t167843 = t167823-1.0;
                double t167845 = t167820*t167822*t167825*(1.4000771998813E29/7.427640235712282E27);
                double t167846 = 1.0/(t167819*t167819);
                double t167847 = t167820*t167821*t167841*t167846*(1.4000771998813E29/4.951760157141521E27);
                double t167848 = t167845+t167847;
                double t167849 = t167842*t167843*t167819*t167828*(2.475880078570761E27/1.4000771998813E29);
                double t167850 = -t167823+t167849+3.0/2.0;
                double t167851 = t167830*t167827*t167829*(3.74176054803257E14/7.0368744177664E13);
                double t167852 = erf(t167851);
                double t167853 = t167852*(3.991211251234741E15/2.251799813685248E15);
                double t167901 = omega*t167850*t167824*t167825*(7.0368744177664E13/3.74176054803257E14);
                double t167854 = -t167901+t167853;
                double t167855 = pow(rho_a[index],4.0/3.0);
                double t167856 = 1.0/sqrt(3.141592653589793);
                double t167857 = 1.0/pow(t167819,3.0/2.0);
                double t167858 = d*t167812*t167817*2.0;
                double t167859 = d*t167812*t167835*3.0;
                double t167860 = 1.0/sqrt(gamma_aa[index]);
                double t167861 = d*t167811*t167814*t167860*3.0;
                double t167862 = t167861+t167859;
                double t167864 = d*gamma_aa[index]*t167812*t167831*t167862*2.0;
                double t167863 = -t167864+t167858;
                double t167865 = d*t167812*t167831*t167840*2.0;
                double t167866 = d*gamma_aa[index]*t167831*t167832*t167862*(1.6E1/3.0);
                double t167867 = d*t167832*t167835*1.2E1;
                double t167868 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t167869 = 1.0/pow(t167834,3.0/2.0);
                double t167870 = d*t167814*t167860*t167838*4.0;
                double t167877 = d*gamma_aa[index]*t167868*t167869*4.0;
                double t167871 = t167870+t167867-t167877;
                double t167872 = d*gamma_aa[index]*t167812*t167831*t167871*2.0;
                double t167873 = 1.0/(t167816*t167816*t167816);
                double t167876 = d*t167832*t167817*(1.6E1/3.0);
                double t167878 = d*gamma_aa[index]*t167812*t167840*t167862*t167873*4.0;
                double t167874 = t167872+t167865+t167866-t167876-t167878;
                double t167875 = 1.0/pow(rho_a[index],5.0/3.0);
                double t167879 = t167820*t167825*t167863*t167846*(1.4000771998813E29/7.427640235712282E27);
                double t167880 = t167820*t167821*t167846*t167874*(1.4000771998813E29/4.951760157141521E27);
                double t167881 = 1.0/(t167819*t167819*t167819);
                double t167882 = t167820*t167821*t167841*t167863*t167881*(1.4000771998813E29/2.475880078570761E27) \
                   ;
                double t167883 = t167880+t167882+t167879;
                double t167884 = t167822*t167823*t167863*(1.0/2.0);
                double t167885 = t167842*t167843*t167863*t167828*(2.475880078570761E27/1.4000771998813E29);
                double t167894 = t167820*t167821*t167823*t167863*t167846*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167886 = t167884+t167885-t167894;
                double t167887 = t167841*t167842*t167843*t167828*(2.475880078570761E27/1.4000771998813E29);
                double t167888 = t167842*t167843*t167819*t167875*(4.951760157141521E27/4.2002315996439E29);
                double t167889 = t167823*t167842*t167819*t167828*t167848*(2.475880078570761E27/1.4000771998813E29) \
                   ;
                double t167896 = t167823*t167848;
                double t167890 = t167887-t167896+t167888+t167889;
                double t167891 = t167827*t167828*t167829*(3.74176054803257E14/2.11106232532992E14);
                double t167892 = t167830*t167841*t167827*t167857*(3.74176054803257E14/1.40737488355328E14);
                double t167893 = t167891+t167892;
                double t167895 = t167823*t167856*t167893*(3.991211251234741E15/1.125899906842624E15);
                double t167897 = omega*t167824*t167825*t167890*(7.0368744177664E13/3.74176054803257E14);
                double t167898 = omega*t167811*t167850*t167824*(7.0368744177664E13/1.122528164409771E15);
                double t167899 = omega*t167841*t167850*t167825*t167829*(3.5184372088832E13/3.74176054803257E14);
                double t167900 = t167895+t167897+t167898+t167899;
                double t167902 = omega*t167824*t167825*t167886*(7.0368744177664E13/3.74176054803257E14);
                double t167903 = omega*t167850*t167825*t167863*t167829*(3.5184372088832E13/3.74176054803257E14);
                double t167904 = t167830*t167823*t167827*t167863*t167856*t167857*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167905 = t167902+t167903+t167904;
                double t167906 = omega*t167824*t167825*t167854*(2.81474976710656E14/1.122528164409771E15);
                double t167907 = t167906-1.0;
                double t167908 = omega*t167824*t167905*t167825*(2.81474976710656E14/1.122528164409771E15);
                double t167909 = t167908-omega*t167825*t167854*t167863*t167829*(1.40737488355328E14/1.122528164409771E15) \
                   ;
                v_rho_a_gamma_aa_[index] = t167819*t167855*(omega*t167824*t167825*(t167823*t167856*(t167830*t167827* \
                   t167874*t167857*(3.74176054803257E14/1.40737488355328E14)+t167827*t167863*t167828*t167857*(3.74176054803257E14/ \
                   4.22212465065984E14)+t167830*t167841*t167827*t167863*1.0/pow(t167819,5.0/2.0)*(1.122528164409771E15/ \
                   2.81474976710656E14))*(-3.991211251234741E15/1.125899906842624E15)+omega*t167811*t167824*t167886*(7.0368744177664E13/ \
                   1.122528164409771E15)+omega*t167824*t167825*(t167823*t167883+t167823*t167841*t167863*t167846*(1.0/ \
                   2.0)+t167822*t167823*t167863*t167848*(1.0/2.0)+t167842*t167843*t167863*t167875*(4.951760157141521E27/ \
                   4.2002315996439E29)-t167842*t167843*t167828*t167874*(2.475880078570761E27/1.4000771998813E29)+(t167822* \
                   t167823*t167863*(1.0/3.0))/rho_a[index]+t167823*t167842*t167863*t167828*t167848*(2.475880078570761E27/ \
                   1.4000771998813E29)-t167823*t167842*t167819*t167828*t167883*(2.475880078570761E27/1.4000771998813E29) \
                   -t167820*t167821*t167823*t167863*t167846*t167848*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t167811*t167850*t167863*t167829*(3.5184372088832E13/1.122528164409771E15) \
                   -omega*t167850*t167825*t167829*t167874*(3.5184372088832E13/3.74176054803257E14)+omega*t167825*t167863* \
                   t167890*t167829*(3.5184372088832E13/3.74176054803257E14)+omega*t167841*t167825*t167829*t167886*(3.5184372088832E13/ \
                   3.74176054803257E14)-omega*t167841*t167850*t167825*t167863*t167857*(1.7592186044416E13/3.74176054803257E14) \
                   +t167820*t167821*t167823*t167863*t167846*t167856*t167893*(5.588003872763475E44/5.575186299632656E42) \
                   )*(2.81474976710656E14/1.122528164409771E15)+omega*t167811*t167824*t167905*(2.81474976710656E14/3.367584493229313E15) \
                   +omega*t167900*t167825*t167863*t167829*(1.40737488355328E14/1.122528164409771E15)+omega*t167841*t167905* \
                   t167825*t167829*(1.40737488355328E14/1.122528164409771E15)-omega*t167811*t167854*t167863*t167829*(1.40737488355328E14/ \
                   3.367584493229313E15)+omega*t167825*t167854*t167829*t167874*(1.40737488355328E14/1.122528164409771E15) \
                   +omega*t167841*t167825*t167854*t167863*t167857*(7.0368744177664E13/1.122528164409771E15))*(1.0/2.0) \
                   -t167863*t167855*(omega*t167900*t167824*t167825*(-2.81474976710656E14/1.122528164409771E15)+omega* \
                   t167811*t167824*t167854*(2.81474976710656E14/3.367584493229313E15)+omega*t167841*t167825*t167854*t167829* \
                   (1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)+t167830*t167907*t167863*(2.0/3.0)-t167830*t167819* \
                   t167909*(2.0/3.0)+t167841*t167855*t167909*(1.0/2.0)+t167907*t167855*t167874*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_aa_[index] = 0.0;
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_rho_a_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else {
                v_rho_a_gamma_ab_[index] = 0.0;
            } 

            //V_rho_a_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else {
                v_rho_a_gamma_bb_[index] = 0.0;
            } 

            //V_rho_b_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else {
                v_rho_b_gamma_aa_[index] = 0.0;
            } 

            //V_rho_b_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else {
                v_rho_b_gamma_ab_[index] = 0.0;
            } 

            //V_rho_b_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t166947 = sqrt(gamma_bb[index]);
                double t166948 = 1.0/pow(rho_b[index],4.0/3.0);
                double t166949 = 1.0/pow(rho_b[index],8.0/3.0);
                double t166950 = t166947*t166948;
                double t166951 = log(t166950+sqrt(t166950*t166950+1.0));
                double t166952 = d*t166951*t166947*t166948*6.0;
                double t166953 = t166952+1.0;
                double t166954 = 1.0/t166953;
                double t166955 = d*gamma_bb[index]*t166954*t166949*2.0;
                double t166956 = t166955+4.190715359480463E15/2.251799813685248E15;
                double t166957 = 1.0/(omega*omega);
                double t166958 = pow(rho_b[index],2.0/3.0);
                double t166959 = 1.0/t166956;
                double t166963 = t166957*t166958*t166959*(1.4000771998813E29/4.951760157141521E27);
                double t166960 = exp(-t166963);
                double t166961 = sqrt(t166956);
                double t166962 = 1.0/pow(rho_b[index],1.0/3.0);
                double t166964 = 1.0/omega;
                double t166965 = 1.0/pow(rho_b[index],2.0/3.0);
                double t166966 = 1.0/sqrt(t166956);
                double t166967 = pow(rho_b[index],1.0/3.0);
                double t166968 = 1.0/(t166953*t166953);
                double t166969 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t166970 = gamma_bb[index]*t166949;
                double t166971 = t166970+1.0;
                double t166972 = 1.0/sqrt(t166971);
                double t166973 = d*gamma_bb[index]*t166954*t166969*(1.6E1/3.0);
                double t166974 = d*gamma_bb[index]*t166972*t166969*8.0;
                double t166975 = 1.0/pow(rho_b[index],7.0/3.0);
                double t166976 = d*t166951*t166947*t166975*8.0;
                double t166977 = t166974+t166976;
                double t166981 = d*gamma_bb[index]*t166949*t166968*t166977*2.0;
                double t166978 = -t166981+t166973;
                double t166979 = omega*omega;
                double t166980 = t166960-1.0;
                double t166982 = t166962*t166957*t166959*(1.4000771998813E29/7.427640235712282E27);
                double t166983 = 1.0/(t166956*t166956);
                double t166984 = t166983*t166957*t166958*t166978*(1.4000771998813E29/4.951760157141521E27);
                double t166985 = t166982+t166984;
                double t166986 = t166980*t166956*t166965*t166979*(2.475880078570761E27/1.4000771998813E29);
                double t166987 = -t166960+t166986+3.0/2.0;
                double t166988 = t166964*t166966*t166967*(3.74176054803257E14/7.0368744177664E13);
                double t166989 = erf(t166988);
                double t166990 = t166989*(3.991211251234741E15/2.251799813685248E15);
                double t167038 = omega*t166961*t166962*t166987*(7.0368744177664E13/3.74176054803257E14);
                double t166991 = -t167038+t166990;
                double t166992 = pow(rho_b[index],4.0/3.0);
                double t166993 = 1.0/sqrt(3.141592653589793);
                double t166994 = 1.0/pow(t166956,3.0/2.0);
                double t166995 = d*t166954*t166949*2.0;
                double t166996 = d*t166972*t166949*3.0;
                double t166997 = 1.0/sqrt(gamma_bb[index]);
                double t166998 = d*t166951*t166948*t166997*3.0;
                double t166999 = t166996+t166998;
                double t167001 = d*gamma_bb[index]*t166949*t166968*t166999*2.0;
                double t167000 = -t167001+t166995;
                double t167002 = d*t166949*t166968*t166977*2.0;
                double t167003 = d*gamma_bb[index]*t166968*t166969*t166999*(1.6E1/3.0);
                double t167004 = d*t166972*t166969*1.2E1;
                double t167005 = 1.0/pow(rho_b[index],1.9E1/3.0);
                double t167006 = 1.0/pow(t166971,3.0/2.0);
                double t167007 = d*t166951*t166975*t166997*4.0;
                double t167014 = d*gamma_bb[index]*t167005*t167006*4.0;
                double t167008 = t167004-t167014+t167007;
                double t167009 = d*gamma_bb[index]*t167008*t166949*t166968*2.0;
                double t167010 = 1.0/(t166953*t166953*t166953);
                double t167013 = d*t166954*t166969*(1.6E1/3.0);
                double t167015 = d*gamma_bb[index]*t167010*t166949*t166977*t166999*4.0;
                double t167011 = t167002+t167003-t167013-t167015+t167009;
                double t167012 = 1.0/pow(rho_b[index],5.0/3.0);
                double t167016 = t167000*t166962*t166983*t166957*(1.4000771998813E29/7.427640235712282E27);
                double t167017 = t167011*t166983*t166957*t166958*(1.4000771998813E29/4.951760157141521E27);
                double t167018 = 1.0/(t166956*t166956*t166956);
                double t167019 = t167000*t167018*t166957*t166958*t166978*(1.4000771998813E29/2.475880078570761E27) \
                   ;
                double t167020 = t167016+t167017+t167019;
                double t167021 = t167000*t166960*t166959*(1.0/2.0);
                double t167022 = t167000*t166980*t166965*t166979*(2.475880078570761E27/1.4000771998813E29);
                double t167031 = t167000*t166960*t166983*t166957*t166958*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167023 = t167021+t167022-t167031;
                double t167024 = t166980*t166965*t166978*t166979*(2.475880078570761E27/1.4000771998813E29);
                double t167025 = t167012*t166980*t166956*t166979*(4.951760157141521E27/4.2002315996439E29);
                double t167026 = t166960*t166956*t166965*t166985*t166979*(2.475880078570761E27/1.4000771998813E29) \
                   ;
                double t167033 = t166960*t166985;
                double t167027 = t167024-t167033+t167025+t167026;
                double t167028 = t166964*t166965*t166966*(3.74176054803257E14/2.11106232532992E14);
                double t167029 = t166964*t166967*t166994*t166978*(3.74176054803257E14/1.40737488355328E14);
                double t167030 = t167028+t167029;
                double t167032 = t167030*t166960*t166993*(3.991211251234741E15/1.125899906842624E15);
                double t167034 = omega*t167027*t166961*t166962*(7.0368744177664E13/3.74176054803257E14);
                double t167035 = omega*t166961*t166948*t166987*(7.0368744177664E13/1.122528164409771E15);
                double t167036 = omega*t166962*t166966*t166978*t166987*(3.5184372088832E13/3.74176054803257E14);
                double t167037 = t167032+t167034+t167035+t167036;
                double t167039 = omega*t167023*t166961*t166962*(7.0368744177664E13/3.74176054803257E14);
                double t167040 = omega*t167000*t166962*t166966*t166987*(3.5184372088832E13/3.74176054803257E14);
                double t167041 = t167000*t166960*t166964*t166993*t166967*t166994*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167042 = t167040+t167041+t167039;
                double t167043 = omega*t166961*t166962*t166991*(2.81474976710656E14/1.122528164409771E15);
                double t167044 = t167043-1.0;
                double t167045 = omega*t167042*t166961*t166962*(2.81474976710656E14/1.122528164409771E15);
                double t167046 = t167045-omega*t167000*t166962*t166991*t166966*(1.40737488355328E14/1.122528164409771E15) \
                   ;
                v_rho_b_gamma_bb_[index] = t166956*t166992*(omega*t166961*t166962*(t166960*t166993*(t167000*t166964* \
                   t166965*t166994*(3.74176054803257E14/4.22212465065984E14)+t167011*t166964*t166967*t166994*(3.74176054803257E14/ \
                   1.40737488355328E14)+t167000*t166964*1.0/pow(t166956,5.0/2.0)*t166967*t166978*(1.122528164409771E15/ \
                   2.81474976710656E14))*(-3.991211251234741E15/1.125899906842624E15)+omega*t167023*t166961*t166948*(7.0368744177664E13/ \
                   1.122528164409771E15)+omega*t166961*t166962*(t167020*t166960+t167000*t167012*t166980*t166979*(4.951760157141521E27/ \
                   4.2002315996439E29)+t167000*t166960*t166983*t166978*(1.0/2.0)+t167000*t166960*t166985*t166959*(1.0/ \
                   2.0)-t167011*t166980*t166965*t166979*(2.475880078570761E27/1.4000771998813E29)+(t167000*t166960*t166959* \
                   (1.0/3.0))/rho_b[index]+t167000*t166960*t166965*t166985*t166979*(2.475880078570761E27/1.4000771998813E29) \
                   -t167020*t166960*t166956*t166965*t166979*(2.475880078570761E27/1.4000771998813E29)-t167000*t166960* \
                   t166983*t166957*t166958*t166985*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/3.74176054803257E14) \
                   +omega*t167000*t167027*t166962*t166966*(3.5184372088832E13/3.74176054803257E14)-omega*t167011*t166962* \
                   t166966*t166987*(3.5184372088832E13/3.74176054803257E14)+omega*t167000*t166948*t166966*t166987*(3.5184372088832E13/ \
                   1.122528164409771E15)+omega*t167023*t166962*t166966*t166978*(3.5184372088832E13/3.74176054803257E14) \
                   -omega*t167000*t166962*t166994*t166978*t166987*(1.7592186044416E13/3.74176054803257E14)+t167000*t167030* \
                   t166960*t166983*t166957*t166993*t166958*(5.588003872763475E44/5.575186299632656E42))*(2.81474976710656E14/ \
                   1.122528164409771E15)+omega*t167042*t166961*t166948*(2.81474976710656E14/3.367584493229313E15)+omega* \
                   t167000*t167037*t166962*t166966*(1.40737488355328E14/1.122528164409771E15)+omega*t167011*t166962*t166991* \
                   t166966*(1.40737488355328E14/1.122528164409771E15)-omega*t167000*t166991*t166948*t166966*(1.40737488355328E14/ \
                   3.367584493229313E15)+omega*t167042*t166962*t166966*t166978*(1.40737488355328E14/1.122528164409771E15) \
                   +omega*t167000*t166962*t166991*t166994*t166978*(7.0368744177664E13/1.122528164409771E15))*(1.0/2.0) \
                   -t167000*t166992*(omega*t167037*t166961*t166962*(-2.81474976710656E14/1.122528164409771E15)+omega* \
                   t166961*t166991*t166948*(2.81474976710656E14/3.367584493229313E15)+omega*t166962*t166991*t166966*t166978* \
                   (1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)+t167000*t167044*t166967*(2.0/3.0)+t167011*t167044* \
                   t166992*(1.0/2.0)-t167046*t166956*t166967*(2.0/3.0)+t167046*t166992*t166978*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t167415 = sqrt(gamma_bb[index]);
                double t167416 = 1.0/pow(rho_b[index],4.0/3.0);
                double t167417 = 1.0/pow(rho_b[index],8.0/3.0);
                double t167418 = t167415*t167416;
                double t167419 = log(t167418+sqrt(t167418*t167418+1.0));
                double t167420 = d*t167415*t167416*t167419*6.0;
                double t167421 = t167420+1.0;
                double t167422 = 1.0/t167421;
                double t167423 = d*gamma_bb[index]*t167422*t167417*2.0;
                double t167424 = t167423+4.190715359480463E15/2.251799813685248E15;
                double t167425 = 1.0/(omega*omega);
                double t167426 = pow(rho_b[index],2.0/3.0);
                double t167427 = 1.0/t167424;
                double t167431 = t167425*t167426*t167427*(1.4000771998813E29/4.951760157141521E27);
                double t167428 = exp(-t167431);
                double t167429 = sqrt(t167424);
                double t167430 = 1.0/pow(rho_b[index],1.0/3.0);
                double t167432 = 1.0/omega;
                double t167433 = 1.0/pow(rho_b[index],2.0/3.0);
                double t167434 = 1.0/sqrt(t167424);
                double t167435 = pow(rho_b[index],1.0/3.0);
                double t167436 = 1.0/(t167421*t167421);
                double t167437 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t167438 = gamma_bb[index]*t167417;
                double t167439 = t167438+1.0;
                double t167440 = 1.0/sqrt(t167439);
                double t167441 = d*gamma_bb[index]*t167422*t167437*(1.6E1/3.0);
                double t167442 = d*gamma_bb[index]*t167440*t167437*8.0;
                double t167443 = 1.0/pow(rho_b[index],7.0/3.0);
                double t167444 = d*t167415*t167443*t167419*8.0;
                double t167445 = t167442+t167444;
                double t167449 = d*gamma_bb[index]*t167417*t167436*t167445*2.0;
                double t167446 = t167441-t167449;
                double t167447 = omega*omega;
                double t167448 = t167428-1.0;
                double t167450 = t167430*t167425*t167427*(1.4000771998813E29/7.427640235712282E27);
                double t167451 = 1.0/(t167424*t167424);
                double t167452 = t167451*t167425*t167426*t167446*(1.4000771998813E29/4.951760157141521E27);
                double t167453 = t167450+t167452;
                double t167454 = t167424*t167433*t167447*t167448*(2.475880078570761E27/1.4000771998813E29);
                double t167455 = t167454-t167428+3.0/2.0;
                double t167456 = t167432*t167434*t167435*(3.74176054803257E14/7.0368744177664E13);
                double t167457 = erf(t167456);
                double t167458 = t167457*(3.991211251234741E15/2.251799813685248E15);
                double t167506 = omega*t167430*t167455*t167429*(7.0368744177664E13/3.74176054803257E14);
                double t167459 = -t167506+t167458;
                double t167460 = pow(rho_b[index],4.0/3.0);
                double t167461 = 1.0/sqrt(3.141592653589793);
                double t167462 = 1.0/pow(t167424,3.0/2.0);
                double t167463 = d*t167422*t167417*2.0;
                double t167464 = d*t167440*t167417*3.0;
                double t167465 = 1.0/sqrt(gamma_bb[index]);
                double t167466 = d*t167416*t167419*t167465*3.0;
                double t167467 = t167464+t167466;
                double t167469 = d*gamma_bb[index]*t167417*t167436*t167467*2.0;
                double t167468 = t167463-t167469;
                double t167470 = d*t167417*t167436*t167445*2.0;
                double t167471 = d*gamma_bb[index]*t167436*t167437*t167467*(1.6E1/3.0);
                double t167472 = d*t167440*t167437*1.2E1;
                double t167473 = 1.0/pow(rho_b[index],1.9E1/3.0);
                double t167474 = 1.0/pow(t167439,3.0/2.0);
                double t167475 = d*t167443*t167419*t167465*4.0;
                double t167482 = d*gamma_bb[index]*t167473*t167474*4.0;
                double t167476 = t167472-t167482+t167475;
                double t167477 = d*gamma_bb[index]*t167417*t167436*t167476*2.0;
                double t167478 = 1.0/(t167421*t167421*t167421);
                double t167481 = d*t167422*t167437*(1.6E1/3.0);
                double t167483 = d*gamma_bb[index]*t167417*t167445*t167467*t167478*4.0;
                double t167479 = t167470+t167471-t167481-t167483+t167477;
                double t167480 = 1.0/pow(rho_b[index],5.0/3.0);
                double t167484 = t167430*t167451*t167425*t167468*(1.4000771998813E29/7.427640235712282E27);
                double t167485 = t167451*t167425*t167426*t167479*(1.4000771998813E29/4.951760157141521E27);
                double t167486 = 1.0/(t167424*t167424*t167424);
                double t167487 = t167425*t167426*t167446*t167468*t167486*(1.4000771998813E29/2.475880078570761E27) \
                   ;
                double t167488 = t167484+t167485+t167487;
                double t167489 = t167427*t167428*t167468*(1.0/2.0);
                double t167490 = t167433*t167447*t167448*t167468*(2.475880078570761E27/1.4000771998813E29);
                double t167499 = t167451*t167425*t167426*t167428*t167468*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167491 = t167490+t167489-t167499;
                double t167492 = t167433*t167446*t167447*t167448*(2.475880078570761E27/1.4000771998813E29);
                double t167493 = t167424*t167480*t167447*t167448*(4.951760157141521E27/4.2002315996439E29);
                double t167494 = t167424*t167433*t167453*t167428*t167447*(2.475880078570761E27/1.4000771998813E29) \
                   ;
                double t167501 = t167453*t167428;
                double t167495 = -t167501+t167492+t167493+t167494;
                double t167496 = t167432*t167433*t167434*(3.74176054803257E14/2.11106232532992E14);
                double t167497 = t167432*t167435*t167462*t167446*(3.74176054803257E14/1.40737488355328E14);
                double t167498 = t167496+t167497;
                double t167500 = t167461*t167428*t167498*(3.991211251234741E15/1.125899906842624E15);
                double t167502 = omega*t167430*t167429*t167495*(7.0368744177664E13/3.74176054803257E14);
                double t167503 = omega*t167416*t167455*t167429*(7.0368744177664E13/1.122528164409771E15);
                double t167504 = omega*t167430*t167434*t167446*t167455*(3.5184372088832E13/3.74176054803257E14);
                double t167505 = t167500+t167502+t167503+t167504;
                double t167507 = omega*t167430*t167491*t167429*(7.0368744177664E13/3.74176054803257E14);
                double t167508 = omega*t167430*t167434*t167455*t167468*(3.5184372088832E13/3.74176054803257E14);
                double t167509 = t167432*t167461*t167435*t167462*t167428*t167468*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167510 = t167507+t167508+t167509;
                double t167511 = omega*t167430*t167429*t167459*(2.81474976710656E14/1.122528164409771E15);
                double t167512 = t167511-1.0;
                double t167513 = omega*t167510*t167430*t167429*(2.81474976710656E14/1.122528164409771E15);
                double t167514 = t167513-omega*t167430*t167434*t167459*t167468*(1.40737488355328E14/1.122528164409771E15) \
                   ;
                v_rho_b_gamma_bb_[index] = t167424*t167460*(omega*t167430*t167429*(t167461*t167428*(t167432*t167433* \
                   t167462*t167468*(3.74176054803257E14/4.22212465065984E14)+t167432*t167435*t167462*t167479*(3.74176054803257E14/ \
                   1.40737488355328E14)+t167432*1.0/pow(t167424,5.0/2.0)*t167435*t167446*t167468*(1.122528164409771E15/ \
                   2.81474976710656E14))*(-3.991211251234741E15/1.125899906842624E15)+omega*t167416*t167491*t167429*(7.0368744177664E13/ \
                   1.122528164409771E15)+omega*t167430*t167429*(t167428*t167488+t167451*t167428*t167446*t167468*(1.0/ \
                   2.0)+t167453*t167427*t167428*t167468*(1.0/2.0)-t167433*t167447*t167448*t167479*(2.475880078570761E27/ \
                   1.4000771998813E29)+t167480*t167447*t167448*t167468*(4.951760157141521E27/4.2002315996439E29)+(t167427* \
                   t167428*t167468*(1.0/3.0))/rho_b[index]-t167424*t167433*t167428*t167447*t167488*(2.475880078570761E27/ \
                   1.4000771998813E29)+t167433*t167453*t167428*t167447*t167468*(2.475880078570761E27/1.4000771998813E29) \
                   -t167451*t167425*t167426*t167453*t167428*t167468*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t167430*t167434*t167446*t167491*(3.5184372088832E13/3.74176054803257E14) \
                   -omega*t167430*t167434*t167455*t167479*(3.5184372088832E13/3.74176054803257E14)+omega*t167430*t167434* \
                   t167468*t167495*(3.5184372088832E13/3.74176054803257E14)+omega*t167416*t167434*t167455*t167468*(3.5184372088832E13/ \
                   1.122528164409771E15)-omega*t167430*t167462*t167446*t167455*t167468*(1.7592186044416E13/3.74176054803257E14) \
                   +t167451*t167425*t167461*t167426*t167428*t167468*t167498*(5.588003872763475E44/5.575186299632656E42) \
                   )*(2.81474976710656E14/1.122528164409771E15)+omega*t167510*t167416*t167429*(2.81474976710656E14/3.367584493229313E15) \
                   +omega*t167510*t167430*t167434*t167446*(1.40737488355328E14/1.122528164409771E15)+omega*t167430*t167505* \
                   t167434*t167468*(1.40737488355328E14/1.122528164409771E15)+omega*t167430*t167434*t167459*t167479*(1.40737488355328E14/ \
                   1.122528164409771E15)-omega*t167416*t167434*t167459*t167468*(1.40737488355328E14/3.367584493229313E15) \
                   +omega*t167430*t167462*t167446*t167459*t167468*(7.0368744177664E13/1.122528164409771E15))*(1.0/2.0) \
                   -t167460*t167468*(omega*t167430*t167505*t167429*(-2.81474976710656E14/1.122528164409771E15)+omega* \
                   t167416*t167429*t167459*(2.81474976710656E14/3.367584493229313E15)+omega*t167430*t167434*t167446*t167459* \
                   (1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)-t167424*t167514*t167435*(2.0/3.0)+t167460*t167514* \
                   t167446*(1.0/2.0)+t167512*t167460*t167479*(1.0/2.0)+t167512*t167435*t167468*(2.0/3.0);
            } else {
                v_rho_b_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t167048 = sqrt(gamma_aa[index]);
                double t167049 = 1.0/pow(rho_a[index],4.0/3.0);
                double t167050 = 1.0/pow(rho_a[index],1.0/3.0);
                double t167051 = 1.0/pow(rho_a[index],8.0/3.0);
                double t167052 = t167048*t167049;
                double t167053 = log(t167052+sqrt(t167052*t167052+1.0));
                double t167054 = d*t167053*t167048*t167049*6.0;
                double t167055 = t167054+1.0;
                double t167056 = 1.0/t167055;
                double t167057 = d*gamma_aa[index]*t167051*t167056*2.0;
                double t167058 = t167057+4.190715359480463E15/2.251799813685248E15;
                double t167059 = 1.0/(omega*omega);
                double t167060 = pow(rho_a[index],2.0/3.0);
                double t167061 = 1.0/t167058;
                double t167073 = t167060*t167061*t167059*(1.4000771998813E29/4.951760157141521E27);
                double t167062 = exp(-t167073);
                double t167063 = sqrt(t167058);
                double t167064 = 1.0/(t167055*t167055);
                double t167065 = gamma_aa[index]*t167051;
                double t167066 = t167065+1.0;
                double t167067 = 1.0/sqrt(t167066);
                double t167068 = d*t167051*t167067*3.0;
                double t167069 = 1.0/sqrt(gamma_aa[index]);
                double t167070 = d*t167053*t167049*t167069*3.0;
                double t167071 = t167070+t167068;
                double t167072 = pow(rho_a[index],4.0/3.0);
                double t167074 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t167075 = 1.0/pow(t167066,3.0/2.0);
                double t167076 = d*t167074*t167075*(3.0/2.0);
                double t167077 = 1.0/gamma_aa[index];
                double t167078 = 1.0/pow(gamma_aa[index],3.0/2.0);
                double t167079 = d*t167053*t167049*t167078*(3.0/2.0);
                double t167090 = d*t167051*t167067*t167077*(3.0/2.0);
                double t167080 = -t167090+t167076+t167079;
                double t167081 = d*gamma_aa[index]*t167051*t167080*t167064*2.0;
                double t167082 = t167071*t167071;
                double t167083 = 1.0/(t167055*t167055*t167055);
                double t167084 = d*gamma_aa[index]*t167051*t167082*t167083*4.0;
                double t167089 = d*t167051*t167071*t167064*4.0;
                double t167085 = t167081+t167084-t167089;
                double t167086 = omega*omega;
                double t167087 = 1.0/pow(rho_a[index],2.0/3.0);
                double t167088 = t167062-1.0;
                double t167092 = d*t167051*t167056*2.0;
                double t167093 = d*gamma_aa[index]*t167051*t167071*t167064*2.0;
                double t167091 = t167092-t167093;
                double t167094 = t167091*t167091;
                double t167095 = 1.0/sqrt(t167058);
                double t167096 = 1.0/(t167058*t167058);
                double t167097 = t167058*t167086*t167087*t167088*(2.475880078570761E27/1.4000771998813E29);
                double t167098 = -t167062+t167097+3.0/2.0;
                double t167099 = 1.0/omega;
                double t167100 = pow(rho_a[index],1.0/3.0);
                double t167101 = 1.0/pow(t167058,3.0/2.0);
                double t167102 = 1.0/sqrt(3.141592653589793);
                double t167103 = t167100*t167095*t167099*(3.74176054803257E14/7.0368744177664E13);
                double t167104 = erf(t167103);
                double t167105 = t167104*(3.991211251234741E15/2.251799813685248E15);
                double t167110 = omega*t167050*t167063*t167098*(7.0368744177664E13/3.74176054803257E14);
                double t167106 = -t167110+t167105;
                double t167107 = t167061*t167062*t167091*(1.0/2.0);
                double t167108 = t167091*t167086*t167087*t167088*(2.475880078570761E27/1.4000771998813E29);
                double t167111 = t167060*t167062*t167091*t167059*t167096*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167109 = -t167111+t167107+t167108;
                double t167112 = omega*t167050*t167063*t167109*(7.0368744177664E13/3.74176054803257E14);
                double t167113 = omega*t167050*t167091*t167095*t167098*(3.5184372088832E13/3.74176054803257E14);
                double t167114 = t167100*t167101*t167102*t167062*t167091*t167099*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167115 = t167112+t167113+t167114;
                v_gamma_aa_gamma_aa_[index] = -t167072*t167091*(omega*t167050*t167115*t167063*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t167050*t167106*t167091*t167095*(1.40737488355328E14/1.122528164409771E15) \
                   )-t167072*t167058*(omega*t167050*t167063*(omega*t167050*t167063*(t167061*t167062*t167085*(1.0/2.0) \
                   +t167085*t167086*t167087*t167088*(2.475880078570761E27/1.4000771998813E29)+t167060*t167062*1.0/(t167058* \
                   t167058*t167058)*t167094*t167059*(7.000385999406499E29/9.903520314283042E27)-1.0/(omega*omega*omega* \
                   omega)*t167062*t167072*1.0/(t167058*t167058*t167058*t167058)*t167094*(1.960216165627461E58/2.451992865385422E55) \
                   -t167060*t167062*t167085*t167059*t167096*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)-omega*t167101*t167050*t167094*t167098*(1.7592186044416E13/3.74176054803257E14) \
                   +omega*t167050*t167091*t167109*t167095*(7.0368744177664E13/3.74176054803257E14)+omega*t167050*t167085* \
                   t167095*t167098*(3.5184372088832E13/3.74176054803257E14)+t167100*t167101*t167102*t167062*t167085*t167099* \
                   (1.493415679873386E30/1.584563250285287E29)-t167100*t167102*t167062*1.0/pow(t167058,5.0/2.0)*t167094* \
                   t167099*(4.480247039620159E30/3.169126500570574E29)+1.0/(omega*omega*omega)*rho_a[index]*t167102*t167062* \
                   1.0/pow(t167058,7.0/2.0)*t167094*(2.090897243335959E59/7.846377169233351E56))*(2.81474976710656E14/ \
                   1.122528164409771E15)+omega*t167101*t167050*t167106*t167094*(7.0368744177664E13/1.122528164409771E15) \
                   +omega*t167050*t167115*t167091*t167095*(2.81474976710656E14/1.122528164409771E15)-omega*t167050*t167106* \
                   t167085*t167095*(1.40737488355328E14/1.122528164409771E15))*(1.0/2.0)+t167072*t167085*(omega*t167050* \
                   t167106*t167063*(2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                double t167916 = sqrt(gamma_aa[index]);
                double t167917 = 1.0/pow(rho_a[index],4.0/3.0);
                double t167918 = 1.0/pow(rho_a[index],1.0/3.0);
                double t167919 = 1.0/pow(rho_a[index],8.0/3.0);
                double t167920 = t167916*t167917;
                double t167921 = log(t167920+sqrt(t167920*t167920+1.0));
                double t167922 = d*t167921*t167916*t167917*6.0;
                double t167923 = t167922+1.0;
                double t167924 = 1.0/t167923;
                double t167925 = d*gamma_aa[index]*t167924*t167919*2.0;
                double t167926 = t167925+4.190715359480463E15/2.251799813685248E15;
                double t167927 = 1.0/(omega*omega);
                double t167928 = pow(rho_a[index],2.0/3.0);
                double t167929 = 1.0/t167926;
                double t167941 = t167927*t167928*t167929*(1.4000771998813E29/4.951760157141521E27);
                double t167930 = exp(-t167941);
                double t167931 = sqrt(t167926);
                double t167932 = 1.0/(t167923*t167923);
                double t167933 = gamma_aa[index]*t167919;
                double t167934 = t167933+1.0;
                double t167935 = 1.0/sqrt(t167934);
                double t167936 = d*t167935*t167919*3.0;
                double t167937 = 1.0/sqrt(gamma_aa[index]);
                double t167938 = d*t167921*t167917*t167937*3.0;
                double t167939 = t167936+t167938;
                double t167940 = pow(rho_a[index],4.0/3.0);
                double t167942 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t167943 = 1.0/pow(t167934,3.0/2.0);
                double t167944 = d*t167942*t167943*(3.0/2.0);
                double t167945 = 1.0/gamma_aa[index];
                double t167946 = 1.0/pow(gamma_aa[index],3.0/2.0);
                double t167947 = d*t167921*t167917*t167946*(3.0/2.0);
                double t167958 = d*t167935*t167945*t167919*(3.0/2.0);
                double t167948 = t167944+t167947-t167958;
                double t167949 = d*gamma_aa[index]*t167932*t167919*t167948*2.0;
                double t167950 = t167939*t167939;
                double t167951 = 1.0/(t167923*t167923*t167923);
                double t167952 = d*gamma_aa[index]*t167950*t167951*t167919*4.0;
                double t167957 = d*t167932*t167919*t167939*4.0;
                double t167953 = t167952-t167957+t167949;
                double t167954 = omega*omega;
                double t167955 = 1.0/pow(rho_a[index],2.0/3.0);
                double t167956 = t167930-1.0;
                double t167960 = d*t167924*t167919*2.0;
                double t167961 = d*gamma_aa[index]*t167932*t167919*t167939*2.0;
                double t167959 = t167960-t167961;
                double t167962 = t167959*t167959;
                double t167963 = 1.0/sqrt(t167926);
                double t167964 = 1.0/(t167926*t167926);
                double t167965 = t167926*t167954*t167955*t167956*(2.475880078570761E27/1.4000771998813E29);
                double t167966 = -t167930+t167965+3.0/2.0;
                double t167967 = 1.0/omega;
                double t167968 = pow(rho_a[index],1.0/3.0);
                double t167969 = 1.0/pow(t167926,3.0/2.0);
                double t167970 = 1.0/sqrt(3.141592653589793);
                double t167971 = t167963*t167967*t167968*(3.74176054803257E14/7.0368744177664E13);
                double t167972 = erf(t167971);
                double t167973 = t167972*(3.991211251234741E15/2.251799813685248E15);
                double t167978 = omega*t167931*t167918*t167966*(7.0368744177664E13/3.74176054803257E14);
                double t167974 = t167973-t167978;
                double t167975 = t167930*t167929*t167959*(1.0/2.0);
                double t167976 = t167954*t167955*t167956*t167959*(2.475880078570761E27/1.4000771998813E29);
                double t167979 = t167930*t167927*t167928*t167964*t167959*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167977 = t167975+t167976-t167979;
                double t167980 = omega*t167931*t167918*t167977*(7.0368744177664E13/3.74176054803257E14);
                double t167981 = omega*t167918*t167963*t167966*t167959*(3.5184372088832E13/3.74176054803257E14);
                double t167982 = t167930*t167970*t167967*t167959*t167968*t167969*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167983 = t167980+t167981+t167982;
                v_gamma_aa_gamma_aa_[index] = -t167940*t167959*(omega*t167931*t167918*t167983*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t167918*t167963*t167974*t167959*(1.40737488355328E14/1.122528164409771E15) \
                   )-t167940*t167926*(omega*t167931*t167918*(omega*t167931*t167918*(t167930*t167953*t167929*(1.0/2.0) \
                   +t167953*t167954*t167955*t167956*(2.475880078570761E27/1.4000771998813E29)+t167930*1.0/(t167926*t167926* \
                   t167926)*t167962*t167927*t167928*(7.000385999406499E29/9.903520314283042E27)-1.0/(omega*omega*omega* \
                   omega)*t167930*t167940*1.0/(t167926*t167926*t167926*t167926)*t167962*(1.960216165627461E58/2.451992865385422E55) \
                   -t167930*t167953*t167927*t167928*t167964*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)+omega*t167953*t167918*t167963*t167966*(3.5184372088832E13/3.74176054803257E14) \
                   -omega*t167962*t167918*t167966*t167969*(1.7592186044416E13/3.74176054803257E14)+omega*t167918*t167963* \
                   t167959*t167977*(7.0368744177664E13/3.74176054803257E14)+t167930*t167970*t167953*t167967*t167968*t167969* \
                   (1.493415679873386E30/1.584563250285287E29)-t167930*t167970*1.0/pow(t167926,5.0/2.0)*t167962*t167967* \
                   t167968*(4.480247039620159E30/3.169126500570574E29)+1.0/(omega*omega*omega)*rho_a[index]*t167930*t167970* \
                   1.0/pow(t167926,7.0/2.0)*t167962*(2.090897243335959E59/7.846377169233351E56))*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t167953*t167918*t167963*t167974*(1.40737488355328E14/1.122528164409771E15) \
                   +omega*t167962*t167918*t167974*t167969*(7.0368744177664E13/1.122528164409771E15)+omega*t167918*t167963* \
                   t167983*t167959*(2.81474976710656E14/1.122528164409771E15))*(1.0/2.0)+t167940*t167953*(omega*t167931* \
                   t167918*t167974*(2.81474976710656E14/1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_bb_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t167121 = sqrt(gamma_bb[index]);
                double t167122 = 1.0/pow(rho_b[index],4.0/3.0);
                double t167123 = 1.0/pow(rho_b[index],1.0/3.0);
                double t167124 = 1.0/pow(rho_b[index],8.0/3.0);
                double t167125 = t167121*t167122;
                double t167126 = log(t167125+sqrt(t167125*t167125+1.0));
                double t167127 = d*t167121*t167122*t167126*6.0;
                double t167128 = t167127+1.0;
                double t167129 = 1.0/t167128;
                double t167130 = d*gamma_bb[index]*t167124*t167129*2.0;
                double t167131 = t167130+4.190715359480463E15/2.251799813685248E15;
                double t167132 = 1.0/(omega*omega);
                double t167133 = pow(rho_b[index],2.0/3.0);
                double t167134 = 1.0/t167131;
                double t167146 = t167132*t167133*t167134*(1.4000771998813E29/4.951760157141521E27);
                double t167135 = exp(-t167146);
                double t167136 = sqrt(t167131);
                double t167137 = 1.0/(t167128*t167128);
                double t167138 = gamma_bb[index]*t167124;
                double t167139 = t167138+1.0;
                double t167140 = 1.0/sqrt(t167139);
                double t167141 = d*t167140*t167124*3.0;
                double t167142 = 1.0/sqrt(gamma_bb[index]);
                double t167143 = d*t167122*t167142*t167126*3.0;
                double t167144 = t167141+t167143;
                double t167145 = pow(rho_b[index],4.0/3.0);
                double t167147 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t167148 = 1.0/pow(t167139,3.0/2.0);
                double t167149 = d*t167147*t167148*(3.0/2.0);
                double t167150 = 1.0/gamma_bb[index];
                double t167151 = 1.0/pow(gamma_bb[index],3.0/2.0);
                double t167152 = d*t167122*t167151*t167126*(3.0/2.0);
                double t167163 = d*t167140*t167150*t167124*(3.0/2.0);
                double t167153 = t167152-t167163+t167149;
                double t167154 = d*gamma_bb[index]*t167124*t167153*t167137*2.0;
                double t167155 = t167144*t167144;
                double t167156 = 1.0/(t167128*t167128*t167128);
                double t167157 = d*gamma_bb[index]*t167124*t167155*t167156*4.0;
                double t167162 = d*t167124*t167144*t167137*4.0;
                double t167158 = -t167162+t167154+t167157;
                double t167159 = omega*omega;
                double t167160 = 1.0/pow(rho_b[index],2.0/3.0);
                double t167161 = t167135-1.0;
                double t167165 = d*t167124*t167129*2.0;
                double t167166 = d*gamma_bb[index]*t167124*t167144*t167137*2.0;
                double t167164 = t167165-t167166;
                double t167167 = t167164*t167164;
                double t167168 = 1.0/sqrt(t167131);
                double t167169 = 1.0/(t167131*t167131);
                double t167170 = t167131*t167160*t167161*t167159*(2.475880078570761E27/1.4000771998813E29);
                double t167171 = t167170-t167135+3.0/2.0;
                double t167172 = 1.0/omega;
                double t167173 = pow(rho_b[index],1.0/3.0);
                double t167174 = 1.0/pow(t167131,3.0/2.0);
                double t167175 = 1.0/sqrt(3.141592653589793);
                double t167176 = t167172*t167173*t167168*(3.74176054803257E14/7.0368744177664E13);
                double t167177 = erf(t167176);
                double t167178 = t167177*(3.991211251234741E15/2.251799813685248E15);
                double t167183 = omega*t167123*t167171*t167136*(7.0368744177664E13/3.74176054803257E14);
                double t167179 = -t167183+t167178;
                double t167180 = t167134*t167135*t167164*(1.0/2.0);
                double t167181 = t167160*t167161*t167164*t167159*(2.475880078570761E27/1.4000771998813E29);
                double t167184 = t167132*t167133*t167135*t167164*t167169*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167182 = t167180+t167181-t167184;
                double t167185 = omega*t167123*t167136*t167182*(7.0368744177664E13/3.74176054803257E14);
                double t167186 = omega*t167123*t167171*t167164*t167168*(3.5184372088832E13/3.74176054803257E14);
                double t167187 = t167135*t167172*t167164*t167173*t167174*t167175*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167188 = t167185+t167186+t167187;
                v_gamma_bb_gamma_bb_[index] = -t167145*t167164*(omega*t167123*t167136*t167188*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t167123*t167164*t167168*t167179*(1.40737488355328E14/1.122528164409771E15) \
                   )-t167131*t167145*(omega*t167123*t167136*(omega*t167123*t167136*(t167134*t167135*t167158*(1.0/2.0) \
                   +t167160*t167161*t167158*t167159*(2.475880078570761E27/1.4000771998813E29)+1.0/(t167131*t167131*t167131) \
                   *t167132*t167133*t167135*t167167*(7.000385999406499E29/9.903520314283042E27)-1.0/(omega*omega*omega* \
                   omega)*1.0/(t167131*t167131*t167131*t167131)*t167135*t167145*t167167*(1.960216165627461E58/2.451992865385422E55) \
                   -t167132*t167133*t167135*t167158*t167169*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)-omega*t167123*t167171*t167174*t167167*(1.7592186044416E13/3.74176054803257E14) \
                   +omega*t167123*t167164*t167182*t167168*(7.0368744177664E13/3.74176054803257E14)+omega*t167123*t167171* \
                   t167158*t167168*(3.5184372088832E13/3.74176054803257E14)+t167135*t167172*t167173*t167174*t167175*t167158* \
                   (1.493415679873386E30/1.584563250285287E29)-1.0/pow(t167131,5.0/2.0)*t167135*t167172*t167173*t167175* \
                   t167167*(4.480247039620159E30/3.169126500570574E29)+1.0/(omega*omega*omega)*rho_b[index]*1.0/pow(t167131,7.0/ \
                   2.0)*t167135*t167175*t167167*(2.090897243335959E59/7.846377169233351E56))*(2.81474976710656E14/1.122528164409771E15) \
                   +omega*t167123*t167164*t167168*t167188*(2.81474976710656E14/1.122528164409771E15)+omega*t167123*t167174* \
                   t167167*t167179*(7.0368744177664E13/1.122528164409771E15)-omega*t167123*t167158*t167168*t167179*(1.40737488355328E14/ \
                   1.122528164409771E15))*(1.0/2.0)+t167145*t167158*(omega*t167123*t167136*t167179*(2.81474976710656E14/ \
                   1.122528164409771E15)-1.0)*(1.0/2.0);
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t167521 = sqrt(gamma_bb[index]);
                double t167522 = 1.0/pow(rho_b[index],4.0/3.0);
                double t167523 = 1.0/pow(rho_b[index],1.0/3.0);
                double t167524 = 1.0/pow(rho_b[index],8.0/3.0);
                double t167525 = t167521*t167522;
                double t167526 = log(t167525+sqrt(t167525*t167525+1.0));
                double t167527 = d*t167521*t167522*t167526*6.0;
                double t167528 = t167527+1.0;
                double t167529 = 1.0/t167528;
                double t167530 = d*gamma_bb[index]*t167524*t167529*2.0;
                double t167531 = t167530+4.190715359480463E15/2.251799813685248E15;
                double t167532 = 1.0/(omega*omega);
                double t167533 = pow(rho_b[index],2.0/3.0);
                double t167534 = 1.0/t167531;
                double t167546 = t167532*t167533*t167534*(1.4000771998813E29/4.951760157141521E27);
                double t167535 = exp(-t167546);
                double t167536 = sqrt(t167531);
                double t167537 = 1.0/(t167528*t167528);
                double t167538 = gamma_bb[index]*t167524;
                double t167539 = t167538+1.0;
                double t167540 = 1.0/sqrt(t167539);
                double t167541 = d*t167540*t167524*3.0;
                double t167542 = 1.0/sqrt(gamma_bb[index]);
                double t167543 = d*t167522*t167542*t167526*3.0;
                double t167544 = t167541+t167543;
                double t167545 = pow(rho_b[index],4.0/3.0);
                double t167547 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t167548 = 1.0/pow(t167539,3.0/2.0);
                double t167549 = d*t167547*t167548*(3.0/2.0);
                double t167550 = 1.0/gamma_bb[index];
                double t167551 = 1.0/pow(gamma_bb[index],3.0/2.0);
                double t167552 = d*t167522*t167551*t167526*(3.0/2.0);
                double t167563 = d*t167540*t167550*t167524*(3.0/2.0);
                double t167553 = t167552-t167563+t167549;
                double t167554 = d*gamma_bb[index]*t167524*t167553*t167537*2.0;
                double t167555 = t167544*t167544;
                double t167556 = 1.0/(t167528*t167528*t167528);
                double t167557 = d*gamma_bb[index]*t167524*t167555*t167556*4.0;
                double t167562 = d*t167524*t167544*t167537*4.0;
                double t167558 = -t167562+t167554+t167557;
                double t167559 = omega*omega;
                double t167560 = 1.0/pow(rho_b[index],2.0/3.0);
                double t167561 = t167535-1.0;
                double t167565 = d*t167524*t167529*2.0;
                double t167566 = d*gamma_bb[index]*t167524*t167544*t167537*2.0;
                double t167564 = t167565-t167566;
                double t167567 = t167564*t167564;
                double t167568 = 1.0/sqrt(t167531);
                double t167569 = 1.0/(t167531*t167531);
                double t167570 = t167531*t167560*t167561*t167559*(2.475880078570761E27/1.4000771998813E29);
                double t167571 = t167570-t167535+3.0/2.0;
                double t167572 = 1.0/omega;
                double t167573 = pow(rho_b[index],1.0/3.0);
                double t167574 = 1.0/pow(t167531,3.0/2.0);
                double t167575 = 1.0/sqrt(3.141592653589793);
                double t167576 = t167572*t167573*t167568*(3.74176054803257E14/7.0368744177664E13);
                double t167577 = erf(t167576);
                double t167578 = t167577*(3.991211251234741E15/2.251799813685248E15);
                double t167583 = omega*t167523*t167571*t167536*(7.0368744177664E13/3.74176054803257E14);
                double t167579 = -t167583+t167578;
                double t167580 = t167534*t167535*t167564*(1.0/2.0);
                double t167581 = t167560*t167561*t167564*t167559*(2.475880078570761E27/1.4000771998813E29);
                double t167584 = t167532*t167533*t167535*t167564*t167569*(1.4000771998813E29/4.951760157141521E27) \
                   ;
                double t167582 = t167580+t167581-t167584;
                double t167585 = omega*t167523*t167536*t167582*(7.0368744177664E13/3.74176054803257E14);
                double t167586 = omega*t167523*t167571*t167564*t167568*(3.5184372088832E13/3.74176054803257E14);
                double t167587 = t167535*t167572*t167564*t167573*t167574*t167575*(1.493415679873386E30/1.584563250285287E29) \
                   ;
                double t167588 = t167585+t167586+t167587;
                v_gamma_bb_gamma_bb_[index] = -t167545*t167564*(omega*t167523*t167536*t167588*(2.81474976710656E14/ \
                   1.122528164409771E15)-omega*t167523*t167564*t167568*t167579*(1.40737488355328E14/1.122528164409771E15) \
                   )-t167531*t167545*(omega*t167523*t167536*(omega*t167523*t167536*(t167534*t167535*t167558*(1.0/2.0) \
                   +t167560*t167561*t167558*t167559*(2.475880078570761E27/1.4000771998813E29)+1.0/(t167531*t167531*t167531) \
                   *t167532*t167533*t167535*t167567*(7.000385999406499E29/9.903520314283042E27)-1.0/(omega*omega*omega* \
                   omega)*1.0/(t167531*t167531*t167531*t167531)*t167535*t167545*t167567*(1.960216165627461E58/2.451992865385422E55) \
                   -t167532*t167533*t167535*t167558*t167569*(1.4000771998813E29/4.951760157141521E27))*(7.0368744177664E13/ \
                   3.74176054803257E14)-omega*t167523*t167571*t167574*t167567*(1.7592186044416E13/3.74176054803257E14) \
                   +omega*t167523*t167564*t167582*t167568*(7.0368744177664E13/3.74176054803257E14)+omega*t167523*t167571* \
                   t167558*t167568*(3.5184372088832E13/3.74176054803257E14)+t167535*t167572*t167573*t167574*t167575*t167558* \
                   (1.493415679873386E30/1.584563250285287E29)-1.0/pow(t167531,5.0/2.0)*t167535*t167572*t167573*t167575* \
                   t167567*(4.480247039620159E30/3.169126500570574E29)+1.0/(omega*omega*omega)*rho_b[index]*1.0/pow(t167531,7.0/ \
                   2.0)*t167535*t167575*t167567*(2.090897243335959E59/7.846377169233351E56))*(2.81474976710656E14/1.122528164409771E15) \
                   +omega*t167523*t167564*t167568*t167588*(2.81474976710656E14/1.122528164409771E15)+omega*t167523*t167574* \
                   t167567*t167579*(7.0368744177664E13/1.122528164409771E15)-omega*t167523*t167558*t167568*t167579*(1.40737488355328E14/ \
                   1.122528164409771E15))*(1.0/2.0)+t167545*t167558*(omega*t167523*t167536*t167579*(2.81474976710656E14/ \
                   1.122528164409771E15)-1.0)*(1.0/2.0);
            } else {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_rho_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else {
                v_rho_a_tau_b_[index] = 0.0;
            } 

            //V_rho_b_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else {
                v_rho_b_tau_a_[index] = 0.0;
            } 

            //V_rho_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else {
                v_rho_b_tau_b_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else {
                v_tau_a_tau_b_[index] = 0.0;
            } 

            //V_tau_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else {
                v_tau_b_tau_b_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

                //V_gamma_aa_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } 

                //V_gamma_ab_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } 

                //V_gamma_ab_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } 

                //V_gamma_bb_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } 

                //V_gamma_bb_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } 

            }
        }
    }
}

}}

