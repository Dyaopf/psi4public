<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>JK Builder: PsiShared Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceJKBuilder.html">JKBuilder</a>::<a class="el" href="classJKBuilder_1_1PsiShared.html">PsiShared</a>
  </div>
</div>
<div class="contents">
<h1>PsiShared Class Reference</h1><!-- doxytag: class="JKBuilder::PsiShared" --><!-- doxytag: inherits="JKBuilder::SharedFactory" -->
<p><code>#include &lt;<a class="el" href="PsiShared_8h_source.html">PsiShared.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PsiShared:</div>
<div class="dynsection">
 <div class="center">
  <img src="classJKBuilder_1_1PsiShared.gif" usemap="#PsiShared_map" alt=""/>
  <map id="PsiShared_map" name="PsiShared_map">
<area href="classJKBuilder_1_1SharedFactory.html" alt="SharedFactory" shape="rect" coords="0,56,97,80"/>
<area href="classJKBuilder_1_1JKFactory.html" alt="JKFactory" shape="rect" coords="0,0,97,24"/>
</map>
 </div>
</div>

<p><a href="classJKBuilder_1_1PsiShared-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#aa5f73a8109ec88464262262164feda1e">BuildJK</a> (const double *DensityMatrix, <a class="el" href="namespaceJKBuilder.html#aef21bc37b7cf7bc5ebb5a48628db8d0f">SharedSymJKMatrix</a> &amp;J_Matrix, <a class="el" href="namespaceJKBuilder.html#aef21bc37b7cf7bc5ebb5a48628db8d0f">SharedSymJKMatrix</a> &amp;K_Matrix)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The function actually in charge of building the J and K matrices.  <a href="#aa5f73a8109ec88464262262164feda1e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#a6500ac4c346e1a9c8c27f8b9f02bb29b">PsiShared</a> (<a class="el" href="classJKBuilder_1_1AOBasisSet.html">AOBasisSet</a> *<a class="el" href="classJKBuilder_1_1PsiShared.html#a33250ff04c740919f41b0ffb6c78ada5">basis</a>, <a class="el" href="classJKBuilder_1_1Integrals.html">Integrals</a> *<a class="el" href="classJKBuilder_1_1PsiShared.html#abff505bf91f526e978bc6abbf3e0cfc5">DaInts</a>)</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1SharedFactory.html#afabc3015deddc9247c1c2822431a724f">J</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The J <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>.  <a href="#afabc3015deddc9247c1c2822431a724f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1SharedFactory.html#a59469c5d5576ee51c033626879e699b1">K</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The K <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>.  <a href="#a59469c5d5576ee51c033626879e699b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1SharedFactory.html#af21e4022fc5e357635e5b22bb359fcba">rho</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The density.  <a href="#af21e4022fc5e357635e5b22bb359fcba"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#a911b43dc1d1da86bfdbd45e86f4be122">IsSignificant</a> (const int i, const int j)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Replicates Psi's Significance criteria for determining if shell pair i,j should be considered.  <a href="#a911b43dc1d1da86bfdbd45e86f4be122"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#a0ec04bf57470f228eeb9e8f608014edf">IsSignificant</a> (const int i, const int j, const int k, const int l)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The four-index version.  <a href="#a0ec04bf57470f228eeb9e8f608014edf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#af71d3f76014ba72b33336cef6ad2e397">CalcPrefactor</a> (const int p, const int q, const int r, const int s)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a shell quartet: pqrs calculates the appropriate weighting factor.  <a href="#af71d3f76014ba72b33336cef6ad2e397"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#a4b5b1a33d6eb89835454c8b852a1e63b">FillJK</a> (std::vector&lt; double * &gt; &amp;JKs, <a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a> <a class="el" href="classJKBuilder_1_1PsiShared.html#a33250ff04c740919f41b0ffb6c78ada5">basis</a>, double *dp, int *PQRS, int *pqrs, const double *<a class="el" href="classJKBuilder_1_1Integrals.html">Integrals</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Given a block of the four electron integrals fills the values into J and K.  <a href="#a4b5b1a33d6eb89835454c8b852a1e63b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#ac2d3bee6c0f963913d26d6cc3f7e2403">FillJK2</a> (<a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a> <a class="el" href="classJKBuilder_1_1PsiShared.html#a33250ff04c740919f41b0ffb6c78ada5">basis</a>, int P, int Q, double *JorK, vector&lt; double * &gt; JandKs, int index, bool IsSymmetric)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceJKBuilder.html#a5f21cc1a0cc795f1cb9aceca0400dcd0">SharedInts</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#abff505bf91f526e978bc6abbf3e0cfc5">DaInts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classJKBuilder_1_1PsiShared.html#a33250ff04c740919f41b0ffb6c78ada5">basis</a></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6500ac4c346e1a9c8c27f8b9f02bb29b"></a><!-- doxytag: member="JKBuilder::PsiShared::PsiShared" ref="a6500ac4c346e1a9c8c27f8b9f02bb29b" args="(AOBasisSet *basis, Integrals *DaInts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classJKBuilder_1_1PsiShared.html">PsiShared</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classJKBuilder_1_1AOBasisSet.html">AOBasisSet</a> *&nbsp;</td>
          <td class="paramname"> <em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classJKBuilder_1_1Integrals.html">Integrals</a> *&nbsp;</td>
          <td class="paramname"> <em>DaInts</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a911b43dc1d1da86bfdbd45e86f4be122"></a><!-- doxytag: member="JKBuilder::PsiShared::IsSignificant" ref="a911b43dc1d1da86bfdbd45e86f4be122" args="(const int i, const int j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsSignificant </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>j</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Replicates Psi's Significance criteria for determining if shell pair i,j should be considered. </p>
<p>Right now this function does nothing because Psi's significance criteria is based on the magnitude of elements of the 4 index electrons, which I don't have a way at yet... </p>

</div>
</div>
<a class="anchor" id="a0ec04bf57470f228eeb9e8f608014edf"></a><!-- doxytag: member="JKBuilder::PsiShared::IsSignificant" ref="a0ec04bf57470f228eeb9e8f608014edf" args="(const int i, const int j, const int k, const int l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsSignificant </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The four-index version. </p>

</div>
</div>
<a class="anchor" id="af71d3f76014ba72b33336cef6ad2e397"></a><!-- doxytag: member="JKBuilder::PsiShared::CalcPrefactor" ref="af71d3f76014ba72b33336cef6ad2e397" args="(const int p, const int q, const int r, const int s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CalcPrefactor </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given a shell quartet: pqrs calculates the appropriate weighting factor. </p>
<p>To understand the origin of this prefactor see the comments regarding FillJK. </p>

</div>
</div>
<a class="anchor" id="a4b5b1a33d6eb89835454c8b852a1e63b"></a><!-- doxytag: member="JKBuilder::PsiShared::FillJK" ref="a4b5b1a33d6eb89835454c8b852a1e63b" args="(std::vector&lt; double * &gt; &amp;JKs, SharedBasis basis, double *dp, int *PQRS, int *pqrs, const double *Integrals)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FillJK </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>JKs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a>&nbsp;</td>
          <td class="paramname"> <em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>dp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>PQRS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>pqrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>Integrals</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Given a block of the four electron integrals fills the values into J and K. </p>
<p>Assume we have a block of the four electron integrals that corresponds to shells p,q,r, and s on atoms P,Q,R, and S respectively. Letting i,j,k,l be basis functions belonging to shells p,q,r, and s respectively, it is this functions job to fill in J and K respectively.</p>
<p>Elements of J and K are defined in terms of the density <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>, D, and the four electron integrals as: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} J_{ij}=\sum_{kl}D_{kl}(ij|kl)\\ K_{ij}=\sum_{kl}D_{kl}(ik|jl)\\ K_{ik}=\sum_{jl}D_{jl}(ij|kl), \end{eqnarray*}" src="form_40.png"/>
</p>
<p> where in the last line we swapped dummy indices for the exchange <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>, so that it is in terms of the same four electron integral element.</p>
<p>Assume that p!=q!=r!=s for the time being, then note that the summation over kl runs over all pairs including lk; however, the iterator will not give us this element because (ij|kl)=(ij|lk) and we agreed to only iterate over unique elements. This means we have to add both of these at the same time:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} J_{ij}=\sum_{kl}\left(D_{kl}+D_{lk}\right)(ij|kl)\\ J_{kl}=\sum_{kl}\left(D_{ij}+D_{ji}\right)(ij|kl), \end{eqnarray*}" src="form_41.png"/>
</p>
<p>where the last line accounts for the fact that we agreed not to iterate over (kl|ij), which consequently means we are also not iterating over (kl|ji), because they all have the same value. Noting the symmetry of the four electron integral, we are also not iterating over (ji|kl), (ji|lk), (lk|ij), and (lk|ji), which correspond to elements J_{ji} and J_{lk} of the Coulomb <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>. Note that : </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} J_{ij}=\sum_{kl}\left(D_{kl}+D_{lk}\right)(ij|kl)\\ J_{ji}=\sum_{kl}\left(D_{kl}+D_{lk}\right)(ij|kl)\\ \therefore J_{ij}=J_{ji}\forall\ \{i,j,D\}, \end{eqnarray*}" src="form_52.png"/>
</p>
<p> furthermore this is true whether or not D is symmetric (i.e. D_{kl}=D_{lk}), which means we never have to worry about the last four elements of this list.</p>
<p>What about the exchange <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>? Our discussion of the J <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> shows that for each element (ij|kl), we are essentially considering eight elements: (ij|kl), (ij|lk), (kl|ij), (kl|ji), (ji|kl), (ji|lk), (lk|ij), and (lk|ji). Based on the equation for the exchange <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> given above, this means we need to update elements <img class="formulaInl" alt="$K_{ik}$" src="form_43.png"/>,<img class="formulaInl" alt="$K_{il}$" src="form_44.png"/>,<img class="formulaInl" alt="$K_{ki}$" src="form_45.png"/>, <img class="formulaInl" alt="$K_{kj}$" src="form_46.png"/>, <img class="formulaInl" alt="$K_{jk}$" src="form_47.png"/>, <img class="formulaInl" alt="$K_{li}$" src="form_48.png"/>, and <img class="formulaInl" alt="$K_{lj}$" src="form_49.png"/> respectively. Unlike the J <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} K_{ik}=\sum_{jl}D_{jl}(ij|kl)\\ K_{ki}=\sum_{lj}D_{lj}(ji|lk)\\ K_{ik}=K_{ki} \iff\ D_{jl}=D_{lj}, \end{eqnarray*}" src="form_50.png"/>
</p>
<p> i.e. if D is symmetric, we only need to consider four elements (<img class="formulaInl" alt="$K_{ik}$" src="form_43.png"/>,<img class="formulaInl" alt="$K_{il}$" src="form_44.png"/>,<img class="formulaInl" alt="$K_{jk}$" src="form_47.png"/> and <img class="formulaInl" alt="$K_{jl}$" src="form_51.png"/>) if it is not we have to consider all 8, bummer....</p>
<p>Now consider what happens if r==s, in that case our assumption that because (ij|kl)=(ij|lk) we are not going to consider the element (ij|lk) are false (because we iterate each index over the entire range). And if we use the same code, we will double count this integral. Of course an analogous situation exists for p==q and when both are true we actually quadruple count. Less obvious is that when p==r and q==s, also leads to a double counting (not quadruple) scenario; this case stems from assuming we are only going to consider (ij|kl) and not (kl|ij). Note that p==r or q==s alone corresponds to considering (ij|kl) and (kj|il) [or (il|kj) for the q==s case], which need to be considered, i.e. there is no general symmetry relation between them. It follows that for the case when p==q==r==s we octuple count the quantity. This is what the prefactor function above accounts for.</p>
<p>It seems to me that these "fringe" cases are actually quite common... TODO: Check if we get a much faster code by omitting these "fringe" cases from the summations. </p>

</div>
</div>
<a class="anchor" id="ac2d3bee6c0f963913d26d6cc3f7e2403"></a><!-- doxytag: member="JKBuilder::PsiShared::FillJK2" ref="ac2d3bee6c0f963913d26d6cc3f7e2403" args="(SharedBasis basis, int P, int Q, double *JorK, vector&lt; double * &gt; JandKs, int index, bool IsSymmetric)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FillJK2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a>&nbsp;</td>
          <td class="paramname"> <em>basis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>JorK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double * &gt;&nbsp;</td>
          <td class="paramname"> <em>JandKs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>IsSymmetric</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa5f73a8109ec88464262262164feda1e"></a><!-- doxytag: member="JKBuilder::PsiShared::BuildJK" ref="aa5f73a8109ec88464262262164feda1e" args="(const double *DensityMatrix, SharedSymJKMatrix &amp;J_Matrix, SharedSymJKMatrix &amp;K_Matrix)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildJK </td>
          <td>(</td>
          <td class="paramtype">const double *&nbsp;</td>
          <td class="paramname"> <em>DensityMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceJKBuilder.html#aef21bc37b7cf7bc5ebb5a48628db8d0f">SharedSymJKMatrix</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>J_Matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceJKBuilder.html#aef21bc37b7cf7bc5ebb5a48628db8d0f">SharedSymJKMatrix</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>K_Matrix</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The function actually in charge of building the J and K matrices. </p>
<p>This function first updates the density <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> to be the one given to it. Next, it computes J and K and returns them as <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> objects.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>DensityMatrix</em>&nbsp;</td><td>The density <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>J</em>&nbsp;</td><td>The Coulomb <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> corresponding to DensityMatrix </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>K</em>&nbsp;</td><td>The Exchange <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a> corresponding to DensityMatrix </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classJKBuilder_1_1JKFactory.html#ae253b309dafe3ce003fdabfd315318b8">JKFactory</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="abff505bf91f526e978bc6abbf3e0cfc5"></a><!-- doxytag: member="JKBuilder::PsiShared::DaInts" ref="abff505bf91f526e978bc6abbf3e0cfc5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceJKBuilder.html#a5f21cc1a0cc795f1cb9aceca0400dcd0">SharedInts</a> <a class="el" href="classJKBuilder_1_1PsiShared.html#abff505bf91f526e978bc6abbf3e0cfc5">DaInts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a33250ff04c740919f41b0ffb6c78ada5"></a><!-- doxytag: member="JKBuilder::PsiShared::basis" ref="a33250ff04c740919f41b0ffb6c78ada5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceJKBuilder.html#aa50d645c83645be7de5fa94937abf1f3">SharedBasis</a> <a class="el" href="classJKBuilder_1_1PsiShared.html#a33250ff04c740919f41b0ffb6c78ada5">basis</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afabc3015deddc9247c1c2822431a724f"></a><!-- doxytag: member="JKBuilder::PsiShared::J" ref="afabc3015deddc9247c1c2822431a724f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a>&gt; <a class="el" href="classJKBuilder_1_1SharedFactory.html#afabc3015deddc9247c1c2822431a724f">J</a><code> [protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The J <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>. </p>

</div>
</div>
<a class="anchor" id="a59469c5d5576ee51c033626879e699b1"></a><!-- doxytag: member="JKBuilder::PsiShared::K" ref="a59469c5d5576ee51c033626879e699b1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a>&gt; <a class="el" href="classJKBuilder_1_1SharedFactory.html#a59469c5d5576ee51c033626879e699b1">K</a><code> [protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The K <a class="el" href="classJKBuilder_1_1matrix.html">matrix</a>. </p>

</div>
</div>
<a class="anchor" id="af21e4022fc5e357635e5b22bb359fcba"></a><!-- doxytag: member="JKBuilder::PsiShared::rho" ref="af21e4022fc5e357635e5b22bb359fcba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespaceJKBuilder.html#a490b0a0cd0b0f8f0e280e29b03eb51a3">Shared2Matrix</a>&gt; <a class="el" href="classJKBuilder_1_1SharedFactory.html#af21e4022fc5e357635e5b22bb359fcba">rho</a><code> [protected, inherited]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The density. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="PsiShared_8h_source.html">PsiShared.h</a></li>
<li>src/<a class="el" href="PsiShared_8cpp.html">PsiShared.cpp</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 24 Mar 2014 for JK Builder by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
