# BLAS2 Tests

# GEMV
print '\n  GEMV Tests \n\n'

m = 4
n = 5
lda = 7
A = PsiMod.Matrix(m,lda)
A.set_name('A')
b = PsiMod.Vector(n*2)
c = PsiMod.Vector(n*2)

for i in range(0,m):
    for j in range(0, lda): 
        A.set(0, i, j,  1.0 / (i + j + 1))

for i in range(0,2*n):
    b.set(0,i,i+1.0)
    c.set(0,i,0.0)

A.print_out()
print '\n  b\n'
b.print_out()

PsiMod.DGEMV(0,'N',m,n,1.0,A,lda,b,2,0.0,c,1)
print '\n  c\n'
c.print_out()

PsiMod.DGEMV(0,'T',m,n,1.0,A,lda,b,2,0.0,c,1)
print '\n  c\n'
c.print_out()
    
# SYMV
print '\n  SYMV Tests \n\n'

n = 5
lda = 7
A = PsiMod.Matrix(n,lda)
A.set_name('A')
b = PsiMod.Vector(n*2)
c = PsiMod.Vector(n*2)

for i in range(0,n):
    for j in range(0, lda): 
        A.set(0, i, j,  1.0 / (i + 0.5*j + 1))

for i in range(0,2*n):
    b.set(0,i,i+1.0)
    c.set(0,i,0.0)

A.print_out()
print '\n  b\n'
b.print_out()

PsiMod.DSYMV(0,'U',n,1.0,A,lda,b,2,0.0,c,1)
print '\n  c\n'
c.print_out()

PsiMod.DSYMV(0,'L',n,1.0,A,lda,b,2,0.0,c,1)
print '\n  c\n'
c.print_out()

# TRMV
print '\n  TRMV Tests \n\n'

n = 5
lda = 7
A = PsiMod.Matrix(n,lda)
A.set_name('A')
b = PsiMod.Vector(n)

for i in range(0,n):
    for j in range(0, lda): 
        A.set(0, i, j,  1.0 / (i + 0.5*j + 1))

for i in range(0,n):
    b.set(0,i,i+1.0)

A.print_out()
print '\n  b\n'
b.print_out()

PsiMod.DTRMV(0,'U','N','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i + 1.0)

PsiMod.DTRMV(0,'U','T','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

PsiMod.DTRMV(0,'L','N','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

PsiMod.DTRMV(0,'L','T','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

# TRSV
print '\n  TRSV Tests \n\n'

n = 5
lda = 7
A = PsiMod.Matrix(n,lda)
A.set_name('A')
b = PsiMod.Vector(n)

for i in range(0,n):
    for j in range(0, lda): 
        A.set(0, i, j,  1.0 / (i + 0.5*j + 1))

for i in range(0,n):
    b.set(0,i,i+1.0)

A.print_out()
print '\n  b\n'
b.print_out()

PsiMod.DTRSV(0,'U','N','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i + 1.0)

PsiMod.DTRSV(0,'U','T','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

PsiMod.DTRSV(0,'L','N','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

PsiMod.DTRSV(0,'L','T','N',n,A,lda,b,1)
print '\n  c\n'
b.print_out()
    
for i in range(0,n):
    b.set(0,i,i+1.0)

# BLAS 3

# GEMM
print '\n  GEMM Tests \n\n'

m = 3
n = 5
k = 2
lda = 7
ldb = 6
ldc = 6
A = PsiMod.Matrix(m,lda)
A.set_name('A')
B = PsiMod.Matrix(n,ldb)
B.set_name('B')
C = PsiMod.Matrix(m,ldc)
C.set_name('C')

for i in range(0,m):
    for j in range(0, lda): 
        A.set(0, i, j,  1.0 / (i + 0.5*j + 1))

for i in range(0,k):
    for j in range(0, ldb): 
        B.set(0, i, j,  1.0)

A.print_out()
B.print_out()

PsiMod.DGEMM(0,'N','N',m,n,k,1.0,A,lda,B,ldb,0.0,C,ldc)
C.print_out()

PsiMod.DGEMM(0,'T','N',m,n,k,1.0,A,lda,B,ldb,0.0,C,ldc)
C.print_out()

PsiMod.DGEMM(0,'N','T',m,n,k,1.0,A,lda,B,ldb,0.0,C,ldc)
C.print_out()

PsiMod.DGEMM(0,'T','T',m,n,k,1.0,A,lda,B,ldb,0.0,C,ldc)
C.print_out()

# SYMM (I know works from previous extensive testing)

# TRMM
n = 2
lda = 3
m = 3
ldb = 4
A = PsiMod.Matrix(lda,lda)
A.set_name('A')
B = PsiMod.Matrix(m,ldb)
B.set_name('B')

A.set(0,0,0,1)
A.set(0,1,1,1)
A.set(0,0,1,2)
A.set(0,1,0,3)
A.set(0,0,2,10)
A.set(0,1,2,10)
A.set(0,2,2,10)
A.set(0,2,1,10)
A.set(0,2,0,10)

for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

A.print_out()
B.print_out()

PsiMod.DTRMM(0,'L','U','N','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'L','L','N','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'R','U','N','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'R','L','N','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'L','U','T','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'L','L','T','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'R','U','T','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

PsiMod.DTRMM(0,'R','L','T','N',m,n,1.0,A,lda,B,ldb)
B.print_out()
for i in range(0,m):
    for j in range(0, ldb): 
        B.set(0, i, j,  i + j + 1.0)

