#! DF-DCFT ODC-12 gradient for ethylene with cc-pVDZ/cc-pVDZ-RI standard/auxiliary basis set

ref_vals_aonone = [                                                             
                [ 0.000000000000,     0.000000000000,    -0.087825233898],
                [ 0.000000000000,     0.000000000000,     0.087825233898],
                [ 0.000000000000,    -0.074671046970,     0.046771949175],
                [ 0.000000000000,     0.074671046970,     0.046771949175],
                [ 0.000000000000,     0.074671046970,    -0.046771949175],
                [ 0.000000000000,    -0.074671046970,    -0.046771949175]      
                ]                                                             
ref_vals_aodisk= [                                                            
                [ 0.000000000000,     0.000000000000,    -0.087803444808], 
                [ 0.000000000000,     0.000000000000,     0.087803444808], 
                [ 0.000000000000,    -0.074668776254,     0.046772710519], 
                [ 0.000000000000,     0.074668776254,     0.046772710519], 
                [ 0.000000000000,     0.074668776254,    -0.046772710519], 
                [ 0.000000000000,    -0.074668776254,    -0.046772710519] 
                ]                                                             
ref_aonone = psi4.Matrix(6, 3)                                                
ref_aodisk = psi4.Matrix(6, 3)                                                
ref_aonone.set(ref_vals_aonone)                                               
ref_aodisk.set(ref_vals_aodisk)                                               

memory 512 Mb

molecule c2h4{
symmetry d2h
0 1
C
C 1 RCC
H 1 RCH 2 AHCC
H 1 RCH 2 AHCC 3 D1
H 2 RCH 1 AHCC 4 D2
H 2 RCH 1 AHCC 4 D1

RCC = 1.35 
RCH = 1.00
AHCC = 120.0
D1 = 180.0
D2 = 0.0
}

set {
  basis cc-pvdz
  dcft_density_fitting true
  df_basis_dcft cc-pvdz-ri
  dcft_guess mp2
  algorithm simultaneous
  dcft_functional odc-12
  diis_min_vecs 4
  diis_start_convergence 1.0E-4
  r_convergence 1.0E-10
  maxiter 50
}

#AO_BASIS = NONE
set reference uhf
set ao_basis none
gradient('dcft')
grad = psi4.wavefunction().gradient()
compare_matrices(ref_aonone, grad, 8, "DF-UODC-12 analytic gradient (ao_basis=none)")
clean()

set reference rhf
set ao_basis none
gradient('dcft')
grad = psi4.wavefunction().gradient()
compare_matrices(ref_aonone, grad, 8, "DF-RODC-12 analytic gradient (ao_basis=none)")
clean()

#AO_BASIS = DISK
set reference uhf
set ao_basis disk
gradient('dcft')
grad = psi4.wavefunction().gradient()
compare_matrices(ref_aodisk, grad, 8, "DF-UODC-12 analytic gradient (ao_basis=disk)")
clean()

set reference rhf
set ao_basis disk
gradient('dcft')
grad = psi4.wavefunction().gradient()
compare_matrices(ref_aodisk, grad, 8, "DF-RODC-12 analytic gradient (ao_basis=disk)")
clean()
