#! SCF STO-3G finite-difference tests

memory 250 mb

molecule h2o {
  symmetry c1
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals {
  basis sto-3g
  d_convergence 11
}

# Test against Analytic second derivatives from PSI3 (for now).
anal_freqs = PsiMod.Vector(3)   #TEST
anal_freqs.set(0, 0, 2170.046)  #TEST
anal_freqs.set(0, 1, 4140.002)  #TEST
anal_freqs.set(0, 2, 4391.067)  #TEST

# psi3 3-point formula: #A1 force constants
#  0.3546775  -0.2277549
# -0.2277549   0.4721543
#
#B2 force constant
#  0.7296851

# *** Test frequencies by 3-pt formula in C1.
set globals { points 3 }

frequencies('scf')

fd_freqs = PsiMod.reference_wavefunction().frequencies()                                 #TEST
compare_vectors(anal_freqs, fd_freqs, 1,                                                 #TEST
 "Analytic vs. Finite-difference (3-pt.) frequencies from energies to 0.1 cm^-1 (C1) ")  #TEST

# *** Test frequencies by 5-pt formula in C1.
molecule h2o {
  symmetry c1
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals { points 5 }

frequencies('scf')

fd_freqs = PsiMod.reference_wavefunction().frequencies()                                  #TEST
compare_vectors(anal_freqs, fd_freqs, 3,                                                  #TEST
 "Analytic vs. Finite-difference (5-pt.) frequencies from energies to 0.001 cm^-1 (C1) ") #TEST

clean()

# *** Test frequencies by 3-pt formula in C2v.
molecule h2o {
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals { points 3 }

frequencies('scf')

fd_freqs = PsiMod.reference_wavefunction().frequencies()                                 #TEST
compare_vectors(anal_freqs, fd_freqs, 1,                                                 #TEST
 "Analytic vs. Finite-difference (3-pt.) frequencies from energies to 0.1 cm^-1 (C2v) ") #TEST

# *** Test frequencies by 5-pt formula in C2v.
molecule h2o {
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals { points 5 }

frequencies('scf')

fd_freqs = PsiMod.reference_wavefunction().frequencies()                                   #TEST
compare_vectors(anal_freqs, fd_freqs, 3,                                                   #TEST
 "Analytic vs. Finite-difference (5-pt.) frequencies from energies to 0.001 cm^-1 (C2v) ") #TEST

# *** Test frequencies by 5-pt formula for A1 irrep only.

molecule h2o {
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals { points 5 }

frequencies('scf', irrep=1)

fd_freqs = PsiMod.reference_wavefunction().frequencies()                      #TEST
a1_freqs = PsiMod.Vector(2)                                                   #TEST
a1_freqs.set(0, 0, anal_freqs[0])                                             #TEST
a1_freqs.set(0, 1, anal_freqs[1])                                             #TEST
compare_vectors(a1_freqs, fd_freqs, 3, "A1 frequencies only (5-pt. formula)") #TEST

clean()

# *** Test frequencies by 5-pt formula for B2 irrep only.

molecule h2o {
  O
  H 1 0.9894093
  H 1 0.9894093 2 100.02688
}

set globals { points 5 }
frequencies('scf', irrep=4)

b2_freqs = PsiMod.Vector(1)                                                   #TEST
b2_freqs.set(0, 0, anal_freqs[2])                                             #TEST
fd_freqs = PsiMod.reference_wavefunction().frequencies()                      #TEST
compare_vectors(b2_freqs, fd_freqs, 3, "B2 frequencies only (5-pt. formula)") #TEST

