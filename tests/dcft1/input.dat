#! DCFT calculation for the He dimer, with the K06 functional. This performs a
#! simultaneous update of the orbitals and cumulant, using DIIS extrapolation.
#! Four-virtual integrals are handled in the MO Basis.

refnuc      =  0.66147156125000 #TEST
refscf      = -5.71032245823757 #TEST
refmp2      = -5.76128209224412 #TEST
refdcftscf  = -5.62714230597787 #TEST
refdcft     = -5.77531659915098 #TEST

molecule he2 {
    He
    He 1 3.2
}

set globals {
    convergence 11
    reference   uhf
    ao_basis    none
    algorithm   simultaneous
    basis       6-31G**
}

energy('dcft')

compare_values(refnuc, he2.nuclear_repulsion_energy(), 10, "Nuclear Repulsion Energy"); #TEST
compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 6, "SCF Energy");             #TEST
compare_values(refmp2, get_variable("MP2 ENERGY"), 6, "MP2 Energy");                   #TEST
compare_values(refdcft, get_variable("DCFT ENERGY"), 6, "DCFT Energy");                #TEST
compare_values(refdcftscf, get_variable("DCFT SCF ENERGY"), 6, "DCFT SCF Energy");     #TEST

clean()

