    -----------------------------------------------------------------------
          PSI4: An Open-Source Ab Initio Electronic Structure Package
                              PSI 4.0.0-beta1 Driver

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci., (2011) (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, M. Saitow, U. Bozkaya, A. Yu. Sokolov
    -----------------------------------------------------------------------


    Using LocalCommunicator (Number of processes = 1)

    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#! CCSD(T) energy using MP2 natural orbitals for water (monomer in dimer basis) in aug-cc-pvdz
molecule dimer {
0 1
O  -1.551007  -0.114520   0.000000
H  -1.934259   0.762503   0.000000
H  -0.599677   0.040712   0.000000
--
0 1
O   1.350625   0.111469   0.000000
H   1.680398  -0.373741  -0.758561
H   1.680398  -0.373741   0.758561
}

memory 250 mb
set {
  r_convergence 1e-7
  basis aug-cc-pvdz
  freeze_core true
  triples_use_nos true
}

activate(dimer)
monoA = dimer.extract_subsets(1,2)

energy("plugin_ccsd_serial")

refscf     = -76.0412702882  # TEST
refccsd    = -0.227694028575 # TEST
refccsdt   = -0.232978044518 # TEST

compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 8, "SCF energy")                             #TEST
compare_values(refccsd, get_variable("CCSD CORRELATION ENERGY"), 8, "CCSD correlation energy")        #TEST 
compare_values(refccsdt, get_variable("CCSD(T) CORRELATION ENERGY"), 8, "CCSD(T) correlation energy") #TEST
--------------------------------------------------------------------------

  Memory set to 250.000 MiB by Python script.
/home/deprince/psi4/lib/../tests/plugin_ccsd_serial/plugin_ccsd_serial.so loaded.

*** tstart() called on ds8
*** at Mon Jan 30 12:50:15 2012


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,    250 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: cs

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
           O         -1.485163346097    -0.114724564047     0.000000000000
           H         -1.868415346097     0.762298435953     0.000000000000
           H         -0.533833346097     0.040507435953     0.000000000000
           O(Gh)      1.416468653903     0.111264435953     0.000000000000
           H(Gh)      1.746241653903    -0.373945564047    -0.758561000000
           H(Gh)      1.746241653903    -0.373945564047     0.758561000000

    Number of unique atoms: 5

    Atoms equivalency:
       unique atom 0: 0 
       unique atom 1: 1 
       unique atom 2: 2 
       unique atom 3: 3 
       unique atom 4: 4 5 

  Running in cs symmetry.

  Nuclear repulsion =    9.163830145965932

  Charge       = 0
  Multiplicity = 1
  Electrons    = 10
  Nalpha       = 5
  Nbeta        = 5

  ==> Algorithm <==

  SCF Algorithm Type is PK.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is CORE.
  Energy threshold   = 1.00e-08
  Density threshold  = 1.00e-08
  Integral threshold = 0.00e+00

  ==> Primary Basis: AUG-CC-PVDZ <==

  Basis Set
    Number of shells: 38
    Number of basis function: 82
    Number of Cartesian functions: 86
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

  Minimum eigenvalue in the overlap matrix is 1.5458174156E-03.
  Using Symmetric Orthogonalization.
  SCF Guess: Core (One-Electron) Hamiltonian.

  Initial RHF energy:   -58.65157588620747

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     A'        55      55       4       4       4       0
     A"        27      27       1       1       1       0
   -------------------------------------------------------
    Total      82      82       5       5       5       0
   -------------------------------------------------------

  ==> Integral Setup <==

 MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of atoms:                   6
      Number of AO shells:              38
      Number of SO shells:              33
      Number of primitives:             78
      Number of atomic orbitals:        86
      Number of basis functions:        82

      Number of irreps:                  2
      Number of functions per irrep: [  55   27 ]

      Overlap, kinetic, potential, dipole, and quadrupole integrals
        stored in file 35.

      Computing two-electron integrals...done
      Computed 2898501 non-zero two-electron integrals.
        Stored in file 33.

  ==> Iterations <==

                        Total Energy        Delta E     Density RMS

   @RHF iter   1:   -68.49492061614745   -9.84334e+00   0.00000e+00 
   @RHF iter   2:   -64.77313955617034    3.72178e+00   3.49320e-01 DIIS
   @RHF iter   3:   -75.04796361407770   -1.02748e+01   3.46554e-01 DIIS
   @RHF iter   4:   -75.84010811534498   -7.92145e-01   6.29219e-03 DIIS
   @RHF iter   5:   -76.04002961603732   -1.99922e-01   6.11249e-03 DIIS
   @RHF iter   6:   -76.04101023038737   -9.80614e-04   7.35365e-04 DIIS
   @RHF iter   7:   -76.04126411507417   -2.53885e-04   1.69463e-04 DIIS
   @RHF iter   8:   -76.04127002992253   -5.91485e-06   3.40749e-05 DIIS
   @RHF iter   9:   -76.04127027909007   -2.49168e-07   9.66317e-06 DIIS
   @RHF iter  10:   -76.04127028785132   -8.76125e-09   1.79024e-06 DIIS
   @RHF iter  11:   -76.04127028818834   -3.37025e-10   2.34406e-07 DIIS
   @RHF iter  12:   -76.04127028819313   -4.78906e-12   3.53819e-08 DIIS
   @RHF iter  13:   -76.04127028819406   -9.23706e-13   1.02892e-08 DIIS

  ==> Post-Iterations <==

	Orbital Energies (a.u.)
	-----------------------

	Doubly Occupied:                                                      

	   1A'   -20.577859     2A'    -1.355084     3A'    -0.717140  
	   4A'    -0.585309     1A"    -0.509189  

	Virtual:                                                              

	   5A'     0.026520     6A'     0.050712     2A"     0.061602  
	   7A'     0.086376     8A'     0.129583     9A'     0.147348  
	  10A'     0.188792     3A"     0.191369     4A"     0.216554  
	  11A'     0.226827    12A'     0.233481    13A'     0.278512  
	  14A'     0.337908     5A"     0.361004    15A'     0.365587  
	   6A"     0.392755    16A'     0.400792    17A'     0.416656  
	   7A"     0.440273    18A'     0.445304    19A'     0.490029  
	   8A"     0.520796    20A'     0.531052     9A"     0.565716  
	  21A'     0.626227    10A"     0.636724    22A'     0.659681  
	  23A'     0.752322    24A'     0.841449    25A'     0.938920  
	  26A'     0.978901    11A"     1.107399    27A'     1.108385  
	  28A'     1.145221    12A"     1.153629    13A"     1.190678  
	  29A'     1.199606    14A"     1.269416    30A'     1.290464  
	  15A"     1.334932    31A'     1.345221    32A'     1.387847  
	  33A'     1.460850    34A'     1.499113    16A"     1.590181  
	  35A'     1.759463    36A'     2.016766    17A"     2.018587  
	  37A'     2.063854    18A"     2.110762    19A"     2.257151  
	  38A'     2.380732    20A"     2.508987    39A'     2.519965  
	  21A"     2.535997    40A'     2.574908    41A'     2.697479  
	  42A'     2.748173    43A'     2.823467    44A'     2.986646  
	  45A'     3.444146    22A"     3.680384    46A'     3.714413  
	  23A"     3.743396    24A"     3.902455    47A'     4.082148  
	  48A'     4.137907    49A'     4.358399    50A'     4.954494  
	  25A"     4.958015    51A'     5.036442    52A'     5.104269  
	  26A"     5.366868    53A'     5.935266    54A'     6.625253  
	  27A"     7.039181    55A'    33.536834  

	Final Occupation by Irrep:
	         A'    A" 
	DOCC [     4,    1 ]

  Energy converged.

  @RHF Final Energy:   -76.04127028819406

  ==> Properties <==

  Nuclear Dipole Moment: (a.u.)
     X:   -26.9920      Y:    -0.2173      Z:     0.0000

  Electronic Dipole Moment: (a.u.)
     X:    27.3712      Y:     0.9088      Z:     0.0000

  Dipole Moment: (a.u.)
     X:     0.3792      Y:     0.6915      Z:     0.0000     Total:     0.7886

  Dipole Moment: (Debye)
     X:     0.9638      Y:     1.7576      Z:     0.0000     Total:     2.0045


  Saving occupied orbitals to File 180.

*** tstop() called on ds8 at Mon Jan 30 12:50:18 2012
Module time:
	user time   =       2.80 seconds =       0.05 minutes
	system time =       0.34 seconds =       0.01 minutes
	total time  =          3 seconds =       0.05 minutes
Total time:
	user time   =       2.80 seconds =       0.05 minutes
	system time =       0.34 seconds =       0.01 minutes
	total time  =          3 seconds =       0.05 minutes

*** tstart() called on ds8
*** at Mon Jan 30 12:50:18 2012


	**************************************************
	* TRANSQT2: Program to transform integrals from  *
	*           the SO basis to the MO basis.        *
	*                                                *
	*            Daniel, David, & Justin             *
	**************************************************


	Input parameters:
	-----------------
	Wave function   =	CCSD
	Backtransform   =	No
	Print Level     =	1
	Print TEIs      =	No
	Reference wfn   =	RHF
	Derivative      =	None
	Delete TEI File =	Yes
	Memory (Mbytes) =	250.0
	Cache Level     =	2
	Cache Type      =	LRU
	Chkpt Parameters:
	--------------------
	Number of irreps     = 2
	Number of SOs        = 82
	Number of MOs        = 82
	Number of active MOs = 81

	Label	# SOs	# FZDC	# DOCC	# SOCC	# VIRT	# FZVR
	-----	-----	------	------	------	------	------
	 A'	   55	    1	    3	    0	    51	    0
	 A"	   27	    0	    1	    0	    26	    0

	Nuclear Rep. energy (chkpt) =      9.16383014596593
	SCF energy          (chkpt) =    -76.04127028819406

	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (pq,rs) nbuckets = 1
	Frozen-core energy =  -61.308782109875665
	Starting first half-transformation.
	Sorting half-transformed integrals.
	Starting second half-transformation.
	Two-electron integral transformation complete.

*** tstop() called on ds8 at Mon Jan 30 12:50:24 2012
Module time:
	user time   =       2.47 seconds =       0.04 minutes
	system time =       2.47 seconds =       0.04 minutes
	total time  =          6 seconds =       0.10 minutes
Total time:
	user time   =       5.27 seconds =       0.09 minutes
	system time =       2.81 seconds =       0.05 minutes
	total time  =          9 seconds =       0.15 minutes
Reading options from the PLUGIN_CCSD_SERIAL block
Calling plugin plugin_ccsd_serial.so.

*** tstart() called on ds8
*** at Mon Jan 30 12:50:24 2012



        *******************************************************
        *                                                     *
        *                        CCSD                         *
        *           Coupled-Cluster Singles Doubles           *
        *                                                     *
        *                   Eugene DePrince                   *
        *                                                     *
        *******************************************************



        Begin CC integral sort

        CC integral sort will use                    206.41 mb

        Initial sort.....done.

        IJKL block.......done.
        IJAK block 1/2...done.
        IJAK block 2/2...done.
        KCLD block.......done.
        KLCD block.......done.
        ABCI block 1/4...done.
        ABCI block 2/4...done.
        ABCI block 3/4...done.
        ABCI block 4/4...done.
        ABCD block 1/2...done.
        ABCD block 2/2...done.

  Time for integral sort:             0.83 s (user)
                                      3.13 s (system)
                                         6 s (total)

  available memory =                           238.42 mb
  minimum memory requirements for CCSD =         2.27 mb
  minimum memory requirements for CCSD(T) =     11.94 mb

  Define tiling:

        v(ab,cd) diagrams will be evaluated in   1 blocks.
        v(ab,ci) diagrams will be evaluated in   1 blocks over ov2.
        v(ab,ci) diagrams will be evaluated in   1 blocks over ov.

  Allocate cpu memory (    71.07 mb).....done.
  Initialize cpu memory..................done.

  Begin singles and doubles coupled cluster iterations

   Iter  DIIS          Energy       d(Energy)          |d(T)|     time
      0   0 1   -0.2199659895   -0.2199659895    0.2093357368        0
      1   1 1   -0.2220623515   -0.0020963621    0.0383281600        1
      2   2 1   -0.2264091684   -0.0043468169    0.0128815559        2
      3   3 1   -0.2277530508   -0.0013438824    0.0054658646        1
      4   4 1   -0.2276875316    0.0000655192    0.0010385508        0
      5   5 1   -0.2276901780   -0.0000026464    0.0003748199        1
      6   6 1   -0.2276959831   -0.0000058052    0.0001070446        1
      7   7 1   -0.2276947919    0.0000011913    0.0000363769        0
      8   8 1   -0.2276941079    0.0000006840    0.0000118740        1
      9   8 2   -0.2276941831   -0.0000000752    0.0000039907        1
     10   8 3   -0.2276940695    0.0000001137    0.0000015027        0
     11   8 4   -0.2276940434    0.0000000261    0.0000005019        1
     12   8 5   -0.2276940320    0.0000000114    0.0000002074        1
     13   8 6   -0.2276940286    0.0000000034    0.0000000751        1

  CCSD iterations converged!

        OS SCS-MP2 correlation energy:       -0.196827471460
        SS SCS-MP2 correlation energy:       -0.018647698865
        SCS-MP2 correlation energy:          -0.215475170325
      * SCS-MP2 total energy:               -76.256745458519

        OS MP2 correlation energy:           -0.164022892883
        SS MP2 correlation energy:           -0.055943096595
        MP2 correlation energy:              -0.219965989478
      * MP2 total energy:                   -76.261236277672

        OS SCS-CCSD correlation energy:      -0.226350363814
        SS SCS-CCSD correlation energy:      -0.055895897086
        SCS-CCSD correlation energy:         -0.282246260900
      * SCS-CCSD total energy:              -76.323516549094

        OS CCSD correlation energy:          -0.178228632924
        SS CCSD correlation energy:          -0.049465395651
        CCSD correlation energy:             -0.227694028575
      * CCSD total energy:                  -76.268964316769

  Total time for CCSD iterations:       5.42 s (user)
                                        3.15 s (system)
                                          11 s (total)

  Time per iteration:                   0.42 s (user)
                                        0.24 s (system)
                                        0.85 s (total)

*** tstop() called on ds8 at Mon Jan 30 12:50:41 2012
Module time:
	user time   =       6.29 seconds =       0.10 minutes
	system time =       6.49 seconds =       0.11 minutes
	total time  =         17 seconds =       0.28 minutes
Total time:
	user time   =      11.56 seconds =       0.19 minutes
	system time =       9.30 seconds =       0.15 minutes
	total time  =         26 seconds =       0.43 minutes

*** tstart() called on ds8
*** at Mon Jan 30 12:50:41 2012

        *******************************************************
        *                                                     *
        *          MP2 Natural Orbitals for CCSD(T)           *
        *                                                     *
        *******************************************************

        Cutoff for significant NO occupancy: 1.000e-06

        Number of virtual orbitals in original space:     77
        Number of virtual orbitals in truncated space:    36

        MP2 correlation energy in original space:        -0.219965989478
        MP2 correlation energy in truncated space:       -0.219953353777

        CCSD correlation energy in original space:       -0.227694028575
        CCSD correlation energy in truncated space:      -0.227682553516


*** tstop() called on ds8 at Mon Jan 30 12:50:41 2012
Module time:
	user time   =       0.08 seconds =       0.00 minutes
	system time =       0.03 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =      11.64 seconds =       0.19 minutes
	system time =       9.34 seconds =       0.16 minutes
	total time  =         26 seconds =       0.43 minutes

*** tstart() called on ds8
*** at Mon Jan 30 12:50:41 2012


        *******************************************************
        *                                                     *
        *                      CCSD(T)                        *
        *                                                     *
        *******************************************************

        num_threads =                     1
        available memory =        238.42 mb
        memory requirements =       1.40 mb

        Number of ijk combinations: 20

        Computing (T) correction...

        % complete  total time
              10.0         0 s
              20.0         0 s
              30.0         0 s
              40.0         0 s
              50.0         0 s
              60.0         0 s
              70.0         0 s
              80.0         0 s
              90.0         0 s

                                                 unscaled               scaled
        (T) energy                        -0.005284015943      -0.005284319495

                                                 unscaled               scaled
        CCSD(T) correlation energy        -0.232978044518      -0.232978348070
                                                 unscaled               scaled
      * CCSD(T) total energy             -76.274248332712     -76.274248636264

*** tstop() called on ds8 at Mon Jan 30 12:50:41 2012
Module time:
	user time   =       0.19 seconds =       0.00 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =      11.83 seconds =       0.20 minutes
	system time =       9.35 seconds =       0.16 minutes
	total time  =         26 seconds =       0.43 minutes

*** PSI4 exiting successfully. Buy a developer a beer!
