#! 6-31G** H2O CCSD(T) optimization by energies, with Z-Matrix input

# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, '/home/deprince/psi4/tests')
import plugin_ccsd_serial

memory 250 mb
molecule h2o {
    o
    h 1 0.97
    h 1 0.97 2 103.0
}

set globals {
  basis 6-31G**
  r_convergence 1e-10
  d_convergence 1e-10
  e_convergence 1e-10
}

optimize('_ccsd(t)', dertype=0)
clean()

refnuc   = 9.15670280505  #TEST
refscf   = -76.0228552393  #TEST
refccsd  = -0.211162891845  #TEST
reftotal = -76.2340181311  #TEST

compare_values(refnuc,   h2o.nuclear_repulsion_energy(),             3, "Nuclear repulsion energy") #TEST
compare_values(refscf,   get_variable("SCF total energy"),           7, "SCF energy")               #TEST
compare_values(refccsd,  get_variable("CCSD(T) correlation energy"), 7, "CCSD(T) contribution")     #TEST
compare_values(reftotal, get_variable("Current energy"),             7, "Total energy")             #TEST
