    -----------------------------------------------------------------------
          PSI4: An Open-Source Ab Initio Electronic Structure Package
                              PSI 4.0.0-beta1 Driver
            Using Git: Rev aed566f393ccc7efee6fe99bf8ad026694439c70

    J. M. Turney, A. C. Simmonett, R. M. Parrish, E. G. Hohenstein,
    F. Evangelista, J. T. Fermann, B. J. Mintz, L. A. Burns, J. J. Wilke,
    M. L. Abrams, N. J. Russ, M. L. Leininger, C. L. Janssen, E. T. Seidl,
    W. D. Allen, H. F. Schaefer, R. A. King, E. F. Valeev, C. D. Sherrill,
    and T. D. Crawford, WIREs Comput. Mol. Sci., (2011) (doi: 10.1002/wcms.93)

                         Additional Contributions by
    A. E. DePrince, M. Saitow, U. Bozkaya, A. Yu. Sokolov
    -----------------------------------------------------------------------


    Using LocalCommunicator (Number of processes = 1)

    Memory level set to 256.000 MB

  ==> Input File <==

--------------------------------------------------------------------------
#! Test DF-CCSD(T) energy for H2O/aug-cc-pVDZ
molecule h2o {
0 1
O
H 1 1.0 
H 1 1.0 2 104.5
symmetry c1
}

plugin_load('./plugin_df_ccsd.so')

memory 250 mb
set {
  basis        aug-cc-pvdz
  df_basis_cc  aug-cc-pvdz-ri
  df_basis_scf aug-cc-pvdz-jkfit

  scf_type df
  freeze_core true
  e_convergence 1e-10
  d_convergence 1e-10
  r_convergence 1e-7
}

scf_energy = scf()
plugin('./plugin_df_ccsd.so')

refscf =  -76.03566968373900 # TEST
refccsd =  -0.230819852022   # TEST
refccsdt = -0.236360387427   # TEST

compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 8, "SCF energy")                             #TEST
compare_values(refccsd, get_variable("CCSD CORRELATION ENERGY"), 8, "CCSD correlation energy")        #TEST 
compare_values(refccsdt, get_variable("CCSD(T) CORRELATION ENERGY"), 8, "CCSD(T) correlation energy") #TEST

clean()
--------------------------------------------------------------------------
./plugin_df_ccsd.so loaded.

  Memory set to 250.000 MiB by Python script.

*** tstart() called on ds8
*** at Tue Jan 31 11:25:42 2012


         ---------------------------------------------------------
                                   SCF
            by Justin Turney, Rob Parrish, and Andy Simmonett
                              RHF Reference
                        1 Threads,    250 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z       
    ------------   -----------------  -----------------  -----------------
           O          0.000000000000    -0.000000000000    -0.068516219310
           H          0.000000000000    -0.790689573744     0.543701060724
           H          0.000000000000     0.790689573744     0.543701060724

    Number of unique atoms: 3

    Atoms equivalency:
       unique atom 0: 0 
       unique atom 1: 1 
       unique atom 2: 2 

  Running in c1 symmetry.

  Nuclear repulsion =    8.801465529972067

  Charge       = 0
  Multiplicity = 1
  Electrons    = 10
  Nalpha       = 5
  Nbeta        = 5

  ==> Algorithm <==

  SCF Algorithm Type is DF.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is CORE.
  Energy threshold   = 1.00e-10
  Density threshold  = 1.00e-10
  Integral threshold = 0.00e+00

  ==> Primary Basis: AUG-CC-PVDZ <==

  Basis Set
    Number of shells: 19
    Number of basis function: 41
    Number of Cartesian functions: 43
    Spherical Harmonics?: true
    Max angular momentum: 2

  ==> Pre-Iterations <==

  Minimum eigenvalue in the overlap matrix is 3.1766171647E-03.
  Using Symmetric Orthogonalization.
  SCF Guess: Core (One-Electron) Hamiltonian.

  Initial RHF energy:   -58.75572137110451

   -------------------------------------------------------
    Irrep   Nso     Nmo     Nalpha   Nbeta   Ndocc  Nsocc
   -------------------------------------------------------
     A         41      41       5       5       5       0
   -------------------------------------------------------
    Total      41      41       5       5       5       0
   -------------------------------------------------------

  ==> Integral Setup <==

  ==> DFJK: Density-Fitted J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    OpenMP threads:              1
    Integrals threads:           1
    Memory (MB):               166
    Algorithm:                Core
    Integral Cache:           NONE
    Schwarz Cutoff:          0E+00
    Fitting Condition:       1E-12

   => Auxiliary Basis Set <=

  Basis Set
    Number of shells: 52
    Number of basis function: 150
    Number of Cartesian functions: 171
    Spherical Harmonics?: true
    Max angular momentum: 3

  ==> Iterations <==

                        Total Energy        Delta E     Density RMS

   @RHF iter   1:   -68.60307255291167   -9.84735e+00   0.00000e+00 
   @RHF iter   2:   -66.46031032323367    2.14276e+00   5.93295e-01 DIIS
   @RHF iter   3:   -75.27499078511086   -8.81468e+00   5.90838e-01 DIIS
   @RHF iter   4:   -75.87096346407679   -5.95973e-01   7.81123e-03 DIIS
   @RHF iter   5:   -76.03440667884709   -1.63443e-01   7.52399e-03 DIIS
   @RHF iter   6:   -76.03530311308920   -8.96434e-04   1.27626e-03 DIIS
   @RHF iter   7:   -76.03565407815049   -3.50965e-04   2.82643e-04 DIIS
   @RHF iter   8:   -76.03566915974147   -1.50816e-05   8.73586e-05 DIIS
   @RHF iter   9:   -76.03566966273442   -5.02993e-07   2.22785e-05 DIIS
   @RHF iter  10:   -76.03566968318755   -2.04531e-08   3.45638e-06 DIIS
   @RHF iter  11:   -76.03566968372873   -5.41178e-10   4.90082e-07 DIIS
   @RHF iter  12:   -76.03566968373882   -1.00897e-11   6.70858e-08 DIIS
   @RHF iter  13:   -76.03566968373903   -2.13163e-13   2.00216e-08 DIIS
   @RHF iter  14:   -76.03566968373909   -5.68434e-14   2.40750e-09 DIIS
   @RHF iter  15:   -76.03566968373914   -5.68434e-14   3.77863e-10 DIIS

  ==> Post-Iterations <==

	Orbital Energies (a.u.)
	-----------------------

	Doubly Occupied:                                                      

	   1A    -20.584239     2A     -1.335647     3A     -0.696479  
	   4A     -0.577439     5A     -0.506106  

	Virtual:                                                              

	   6A      0.034658     7A      0.057722     8A      0.174901  
	   9A      0.198751    10A      0.219018    11A      0.232772  
	  12A      0.278549    13A      0.326071    14A      0.382613  
	  15A      0.397881    16A      0.427473    17A      0.532911  
	  18A      0.636696    19A      0.654104    20A      0.794625  
	  21A      0.917437    22A      1.105427    23A      1.117509  
	  24A      1.145099    25A      1.291954    26A      1.454194  
	  27A      1.470010    28A      1.572206    29A      1.971534  
	  30A      1.988356    31A      2.082925    32A      2.346452  
	  33A      2.398798    34A      2.533949    35A      2.701650  
	  36A      2.959675    37A      3.671282    38A      3.683510  
	  39A      3.694439    40A      3.974411    41A      4.219132  

	Final Occupation by Irrep:
	          A 
	DOCC [     5 ]

  Energy converged.

  @RHF Final Energy:   -76.03566968373914

  ==> Properties <==

  Nuclear Dipole Moment: (a.u.)
     X:     0.0000      Y:     0.0000      Z:     1.0191

  Electronic Dipole Moment: (a.u.)
     X:     0.0000      Y:    -0.0000      Z:    -0.2197

  Dipole Moment: (a.u.)
     X:     0.0000      Y:    -0.0000      Z:     0.7994     Total:     0.7994

  Dipole Moment: (Debye)
     X:     0.0000      Y:    -0.0000      Z:     2.0319     Total:     2.0319


  Saving occupied orbitals to File 180.

*** tstop() called on ds8 at Tue Jan 31 11:25:42 2012
Module time:
	user time   =       0.35 seconds =       0.01 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.35 seconds =       0.01 minutes
	system time =       0.01 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Reading options from the PLUGIN_DF_CCSD block
Calling plugin ./plugin_df_ccsd.so.

*** tstart() called on ds8
*** at Tue Jan 31 11:25:42 2012



        *******************************************************
        *                                                     *
        *                       DF-CCSD                       *
        *              Integral-Direct CCSD with              *
        *                   Density Fitting                   *
        *                                                     *
        *                   Eugene DePrince                   *
        *                                                     *
        *******************************************************



  Transform 3-index integrals:

  ==> DF Tensor (by Rob Parrish) <==

 => Primary Basis Set <= 

  Basis Set
    Number of shells: 19
    Number of basis function: 41
    Number of Cartesian functions: 43
    Spherical Harmonics?: true
    Max angular momentum: 2

 => Auxiliary Basis Set <= 

  Basis Set
    Number of shells: 40
    Number of basis function: 118
    Number of Cartesian functions: 136
    Spherical Harmonics?: true
    Max angular momentum: 3

DFTensor::Qov: naux 118, naocc 4, navir 36

  Time for 3-index transform:         0.42 s (user)
                                      0.03 s (system)
                                         1 s (total)

        v(ab,cd) diagram will be evaluated in   1 blocks.

  Total memory requirements:     27.44 mb
  3-index integrals:              1.31 mb
  CCSD intermediates:            26.13 mb

  Begin singles and doubles coupled cluster iterations ... on GPUs!

   Iter  DIIS          Energy       d(Energy)          |d(T)|     time
      0   0 1   -0.2231285261   -0.2231285261    0.2144301456        0
      1   1 1   -0.2246170722   -0.0014885461    0.0405751256        0
      2   2 1   -0.2296230988   -0.0050060266    0.0140168347        0
      3   3 1   -0.2308859833   -0.0012628845    0.0059533931        0
      4   4 1   -0.2308058967    0.0000800866    0.0011192328        1
      5   5 1   -0.2308163635   -0.0000104668    0.0003825014        0
      6   6 1   -0.2308221902   -0.0000058267    0.0001032689        0
      7   7 1   -0.2308201759    0.0000020144    0.0000338545        0
      8   8 1   -0.2308198847    0.0000002912    0.0000100322        0
      9   8 2   -0.2308199994   -0.0000001147    0.0000036095        1
     10   8 3   -0.2308198284    0.0000001709    0.0000012827        0
     11   8 4   -0.2308198547   -0.0000000262    0.0000004251        0
     12   8 5   -0.2308198488    0.0000000059    0.0000001442        0
     13   8 6   -0.2308198520   -0.0000000032    0.0000000414        0

  CCSD iterations converged!

        OS MP2 correlation energy:           -0.166416232135
        SS MP2 correlation energy:           -0.056712293992
        MP2 correlation energy:              -0.223128526127
      * MP2 total energy:                   -76.258798209866

        OS CCSD correlation energy:          -0.181264434310
        SS CCSD correlation energy:          -0.049555417712
        CCSD correlation energy:             -0.230819852022
      * CCSD total energy:                  -76.266489535761

  Total time for CCSD iterations:       2.15 s (user)
                                        0.24 s (system)
                                           2 s (total)

  Time per iteration:                   0.17 s (user)
                                        0.02 s (system)
                                        0.15 s (total)

*** tstop() called on ds8 at Tue Jan 31 11:25:45 2012
Module time:
	user time   =       2.59 seconds =       0.04 minutes
	system time =       0.27 seconds =       0.00 minutes
	total time  =          3 seconds =       0.05 minutes
Total time:
	user time   =       2.94 seconds =       0.05 minutes
	system time =       0.28 seconds =       0.00 minutes
	total time  =          3 seconds =       0.05 minutes

*** tstart() called on ds8
*** at Tue Jan 31 11:25:45 2012


        *******************************************************
        *                                                     *
        *                      CCSD(T)                        *
        *                                                     *
        *******************************************************

        num_threads =                          1
        available memory =             238.42 mb
        total memory requirements =      2.83 mb
        3-index integrals =              1.43 mb
        T1, T2, (T) intermediates =      1.40 mb

        Number of ijk pairs: 20

        Computing (T) correction... 

        % complete  total time
              10.0         0 s
              20.0         0 s
              30.0         0 s
              40.0         0 s
              50.0         0 s
              60.0         1 s
              70.0         1 s
              80.0         1 s
              90.0         1 s

        (T) energy                        -0.005540535405

        CCSD(T) correlation energy        -0.236360387427
      * CCSD(T) total energy             -76.272030071166

*** tstop() called on ds8 at Tue Jan 31 11:25:46 2012
Module time:
	user time   =       0.35 seconds =       0.01 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          1 seconds =       0.02 minutes
Total time:
	user time   =       3.29 seconds =       0.05 minutes
	system time =       0.28 seconds =       0.00 minutes
	total time  =          4 seconds =       0.07 minutes

*** PSI4 exiting successfully. Buy a developer a beer!
