#! Test DF-CCSD(T) energy for H2O/aug-cc-pVDZ

# PYTHONPATH must include directory above plugin directory.
#     Define either externally or here, then import plugin.
sys.path.insert(0, '/home/deprince/psi4/tests')
import plugin_df_ccsd

molecule h2o {
0 1
O
H 1 1.0 
H 1 1.0 2 104.5
}

memory 500 mb
set {
  basis        aug-cc-pvdz
  df_basis_cc  aug-cc-pvdz-ri
  df_basis_scf aug-cc-pvdz-jkfit

  scf_type df
  freeze_core true
  r_convergence 1e-7
}
energy('df-ccsd(t)')

refscf =  -76.03566968373900 # TEST
refccsd =  -0.230819852022   # TEST
refccsdt = -0.236360387427   # TEST

compare_values(refscf, get_variable("SCF TOTAL ENERGY"), 8, "SCF energy")                             #TEST
compare_values(refccsd, get_variable("CCSD CORRELATION ENERGY"), 8, "CCSD correlation energy")        #TEST 
compare_values(refccsdt, get_variable("CCSD(T) CORRELATION ENERGY"), 8, "CCSD(T) correlation energy") #TEST

clean()
