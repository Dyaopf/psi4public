#! DCFT calculation for the Ne atom, with the K06 functional. This performs both
#! two-step and simultaneous update of the orbitals and cumulant using DIIS extrapolation.
#! Four-virtual integrals are handled in the MO Basis.
#! The reference DCFT energy is taken from the JCP 133 174122 (2010) paper

refscf      = -128.48877555174076 #TEST
refmp2      = -128.67634273661755 #TEST
refdcftscf  = -128.29060244088066 #TEST
refdcft     = -128.680342024 #TEST

molecule ne {
    Ne
}

set globals {
    convergence 11
    reference   uhf
    ao_basis    none
    algorithm   twostep
    basis       cc-pvdz
}

energy('dcft')

compare_values(refscf, get_variable("SCF ENERGY"), 10, "SCF Energy");                   #TEST
compare_values(refmp2, get_variable("MP2 ENERGY"), 8, "MP2 Energy");                   #TEST
compare_values(refdcft, get_variable("DCFT ENERGY"), 8, "DCFT Energy (two-step)");                #TEST
compare_values(refdcftscf, get_variable("DCFT SCF ENERGY"), 8, "DCFT SCF Energy (two-step)");     #TEST

#set algorithm simultaneous
#energy('dcft')

#compare_values(refdcft, get_variable("DCFT ENERGY"), 8, "DCFT Energy (simultaneous)");                #TEST
#compare_values(refdcftscf, get_variable("DCFT SCF ENERGY"), 8, "DCFT SCF Energy (simultaneous)");     #TEST

clean()

