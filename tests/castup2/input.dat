#! SCF with various combinations of pk/density-fitting, castup/no-castup,
#! and spherical/cartesian settings. Demonstrates that puream setting is
#! getting set by orbital basis for all df/castup parts of calc. Demonstrates
#! that answer doesn't depend on presence/absence of castup. Demonstrates (by
#! comparison to castup3) that output file doesn't depend on options
#! (scf_type) being set global or local. This input uses global.

memory 256 mb

molecule zinc {
   0 1 
   C
}

set basis 6-31g*

print_stdout('                                     local    global   used')  #TEST
print_stdout('                    prelims          %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST

set scf_type pk
banner('ITEM 1')
energy('scf')
compare_values(-37.5885579065, get_variable('SCF TOTAL ENERGY'), 8, '[1]     scf default          %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type pk
banner('ITEM 2')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5885579065, get_variable('SCF TOTAL ENERGY'), 8, '[2]     scf default   castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
banner('ITEM 3')
energy('scf')
compare_values(-37.5885589047, get_variable('SCF TOTAL ENERGY'), 8, '[3]  df-scf default          %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
banner('ITEM 4')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5885589047, get_variable('SCF TOTAL ENERGY'), 8, '[4]  df-scf default   castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type pk
set puream true
banner('ITEM 5')
energy('scf')
compare_values(-37.5882734783, get_variable('SCF TOTAL ENERGY'), 8, '[5]     scf spherical        %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type pk
set puream true
banner('ITEM 6')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5882734783, get_variable('SCF TOTAL ENERGY'), 8, '[6]     scf spherical castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
set puream true
banner('ITEM 7')
energy('scf')
compare_values(-37.5882728035, get_variable('SCF TOTAL ENERGY'), 8, '[7]  df-scf spherical        %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
set puream true
banner('ITEM 8')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5882728035, get_variable('SCF TOTAL ENERGY'), 8, '[8]  df-scf spherical castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type pk
set puream false
banner('ITEM 9')
energy('scf')
compare_values(-37.5885579065, get_variable('SCF TOTAL ENERGY'), 8, '[9]     scf cartesian        %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type pk
set puream false
banner('ITEM 10')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5885579065, get_variable('SCF TOTAL ENERGY'), 8, '[10]    scf cartesian castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
set puream false
banner('ITEM 11')
energy('scf')
compare_values(-37.5885589047, get_variable('SCF TOTAL ENERGY'), 8, '[11] df-scf cartesian        %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

set scf_type df
set puream false
banner('ITEM 12')
energy('scf', cast_up=True, cast_up_df=True)
compare_values(-37.5885589047, get_variable('SCF TOTAL ENERGY'), 8, '[12] df-scf cartesian castup %s %s %s %s %s %s' % (get_local_option('SCF', 'SCF_TYPE'), has_local_option_changed('SCF', 'SCF_TYPE'), get_global_option('SCF_TYPE'), has_global_option_changed('SCF_TYPE'), get_option('SCF', 'SCF_TYPE'), has_option_changed('SCF', 'SCF_TYPE')))  #TEST
clean()

