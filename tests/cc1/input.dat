#! RHF-CCSD 6-31G** all-electron optimization of the H2O molecule

refnuc   =  9.166137300098260  #TEST
refscf   = -76.02293995043653  #TEST
refccsd  = -0.208238532935749  #TEST
reftotal = -76.2311784833722   #TEST

molecule h2o {
    O
    H 1 0.97
    H 1 0.97 2 103.0
}

set {
    wfn ccsd
    jobtype opt
    dertype first
    docc [3, 0, 1, 1]
    basis 6-31G**
    relax_opdm true     # Currently needed until ccdensity is fixed.

    convergence 11
    e_converge 11
    d_converge 11
}

thisenergy = optimize('ccsd')

compare_values(refnuc,   h2o.nuclear_repulsion_energy(), 9, "Nuclear repulsion energy") #TEST
compare_values(refscf,   get_variable("SCF energy"),     9, "SCF energy")               #TEST
compare_values(refccsd,  get_variable("CCSD energy"),    8, "CCSD contribution")        #TEST
compare_values(reftotal, get_variable("Current energy"), 8, "Total energy")             #TEST

clean()
