#! DCFT calculation for the Ne+ ion (doublet ground state). This performs both
#! two-step and simultaneous update of the orbitals and cumulant using DIIS extrapolation.
#! Four-virtual integrals are handled in the MO Basis.

memory 250 mb

refuhf      = -127.09539051427785 #TEST
refmp2      = -127.17613462119119 #TEST
refdcftscf  = -127.00494667865641 #TEST
refdcft     = -127.18032524447956 #TEST

molecule ne {
    1 2
    Ne
}

set globals {
    r_convergence 11
    reference   uhf
    ao_basis    none
    algorithm   twostep
    basis       3-21G
}

energy('dcft')

compare_values(refuhf, get_variable("SCF TOTAL ENERGY"), 8, "UHF Energy");                        #TEST
compare_values(refmp2, get_variable("MP2 ENERGY"), 8, "MP2 Energy");                              #TEST
compare_values(refdcft, get_variable("DCFT ENERGY"), 8, "DCFT Energy (two-step)");                #TEST
compare_values(refdcftscf, get_variable("DCFT SCF ENERGY"), 8, "DCFT SCF Energy (two-step)");     #TEST

set algorithm simultaneous
energy('dcft')

compare_values(refdcft, get_variable("DCFT ENERGY"), 8, "DCFT Energy (simultaneous)");                #TEST
compare_values(refdcftscf, get_variable("DCFT SCF ENERGY"), 8, "DCFT SCF Energy (simultaneous)");     #TEST
