#! RHF-ODC-12 analytic gradient computations for H2O use
#! AO_BASIS=DISK and AO_BASIS=NONE, respectively. 

memory 250 mb

# RHF-ODC-12 gradients
ref_vals = [
           [-0.000463315203,     0.011184720362,     0.000000000000],
           [-0.000214140480,    -0.007910878984,     0.000000000000],
           [ 0.000677455683,    -0.003273841378,     0.000000000000]  
           ]
ref_grad = psi4.Matrix(3, 3)
ref_grad.set(ref_vals)


molecule h2o {
0 1
O  -1.551007  -0.114520   0.000000
H  -1.934259   0.762503   0.000000
H  -0.599677   0.040712   0.000000
}

set globals {
    r_convergence 12
    d_convergence 12
    algorithm   simultaneous
    basis       cc-pvdz
    dcft_functional odc-12
}

set reference rhf
set ao_basis disk
gradient('dcft')
grad = psi4.wavefunction().gradient() 
compare_matrices(ref_grad, grad, 8, "RHF-ODC-12 analytic gradient (simultaneous, ao_basis=disk)") 
clean()

set reference rhf
set ao_basis none
gradient('dcft')
grad = psi4.wavefunction().gradient() 
compare_matrices(ref_grad, grad, 8, "RHF-ODC-12 analytic gradient (simultaneous, ao_basis=none)") 
