\subsection{Configuration Interaction} \label{detci}

Configuration interaction (CI) is one of the most general ways to
improve upon Hartree--Fock theory by adding a description of the
correlated motions of electrons.  Simply put, a CI wavefunction
is a linear combination of Slater determinants (or spin-adapted
configuration state functions), with the linear coefficients being
determined variationally via diagonalization of the Hamiltonian in the
given subspace of determinants.  The simplest standard CI method which
improves upon Hartree--Fock is a CI which adds all singly and doubly
substituted determinants (CISD).  The CISD wavefunction has fallen out
of favor because truncated CI wavefunctions are not size-extensive,
meaning that their quality degrades for larger molecules.  MP2 is a less
expensive alternative giving results similar to those of CISD for small
molecules, but the quality of MP2 does not degrade for larger molecules.
Coupled-cluster singles and doubles (CCSD) is another size-extensive
alternative; it is only slightly more costly computationally than CISD,
but it typically provides significantly more accurate results.

The CI code in \PSIfour\ is described in detail in Reference
\cite{Sherrill:1999:CI}.  For the reasons stated above, the CI code in
\PSIfour\ is not optimized for CISD computations.  Instead, emphasis
has been placed on developing a very efficient program to handle more
general CI wavefunctions which may be helpful in more challenging cases
such as highly strained molecules or bond breaking reactions.  \PSIdetci\
is a fast, determinant-based CI module based upon the string formalism
of Handy \cite{Handy:1980}.  It can solve for restricted active space
configuration interaction (RAS CI) wavefunctions as described by Olsen,
Roos, Jorgensen, and Aa. Jensen \cite{Olsen:1988}.  Excitation-class
selected multi-reference CI wavefunctions, such as second-order CI,
can be formulated as RAS CI's.  A RAS CI selects determinants for the
model space as those which have no more than $n$ holes in the lowest set
of orbitals (called RAS I) and no more than $m$ electrons in the highest
set of orbitals (called RAS III).  An intermediate set of orbitals, if
present (RAS II), has no restrictions placed upon it.  All determinants
satisfying these rules are included in the CI.

\PSIdetci\ is also very efficient at computing full configuration interaction
wavefunctions, and it is used in this capacity in the complete-active-space
self-consistent-field (CASSCF) code.  Use of \PSIdetci\ for CASSCF
wavefunctions is described in another section of this manual.

As just mentioned, the \PSIdetci\ module is designed for challenging 
chemical systems for which simple CISD is not suitable.  Because
CI wavefunctions which go beyond CISD (such as RAS CI) are fairly complex,
typically the \PSIdetci\ program will be used in cases where the 
tradeoffs between computational expense and completeness of the 
model space are nontrivial.  Hence, the user is advised to develop
a good working knowledge of multi-reference and RAS CI methods before
attempting to use the program for a production-level project.  This user's
manual will provide only an elementary introduction to the most
important keywords.  Additional information is available in the complete
list of keywords for \PSIdetci\ provided in the Appendix.

The division of the molecular orbitals into various subspaces such as
RAS spaces, or frozen vs active orbitals, etc, needs to be clear not
only to \PSIdetci\, but also at least to the transformation program
(and in the case of MCSCF, to other programs as well).  Thus, orbital
subspace keywords such as {\tt RAS1}, {\tt RAS2}, {\tt RAS3}, {\tt
frozen\_docc}, {\tt frozen\_uocc}, {\tt active}, etc., should be set
in the global section of input so they may also be read by other modules.

\subsubsection{Basic Keywords}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         WFN & Wavefunction type \\

          & {\bf Possible Values:} DETCI, CI, ZAPTN, DETCAS, CASSCF, RASSCF
\\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} string &  {\bf Default:} DETCI\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         REFERENCE & Reference wavefunction \\

          & {\bf Possible Values:} RHF, ROHF \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} string &  {\bf Default:} RHF\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         CONVERGENCE & Convergence is achieved when the RMS of the error in
the CI vector is less than 10**(-n). The default is 4 for energies and 7
for gradients. \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} integer &  {\bf Default:} 4\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         EX\_LVL & The CI excitation level \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} integer &  {\bf Default:} 2\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         FCI & Do a full CI (FCI)? \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         FROZEN\_DOCC & The number of frozen (doubly) occupied orbitals
         per irrep \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} array &  {\bf Default:} The zero vector\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         FROZEN\_UOCC & The number of frozen unoccupied orbitals 
         per irrep \\ 
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} array &  {\bf Default:} The zero vector\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         MAXITER & Maximum number of iterations to diagonalize the
Hamiltonian. \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} integer &  {\bf Default:} 12\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         NUM\_ROOTS & number of CI roots to find \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} integer &  {\bf Default:} 1\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         ICORE & Specifies how to handle buffering of CI vectors. A value
of 0 makes the program perform I/O one RAS subblock at a time; 1 uses
entire CI vectors at a time; and 2 uses one irrep block at a time. Values
of 0 or 2 cause some inefficiency in the I/O (requiring multiple reads of
the C vector when constructing H in the iterative subspace if DIAG\_METHOD
= SEM), but require less core memory. \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} integer &  {\bf Default:} 1\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         OPDM & Compute one-particle density matrix if not otherwise
required? \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         TRANSITION\_DENSITY & Compute the transition density? Note: 
         only transition densities
         between roots of the same symmetry will be evaluated.  \PSIdetci\ 
         does not compute states of different irreps within the same 
         computation; to do this, lower the symmetry of the computation. \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         DIPMOM & Compute the dipole moment? \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.7\textwidth}}
         MPN & When this option is TRUE DETCI will compute the MPn series
out to kth order where k is determined by maxnvect. For open-shell systems
(REF=ROHF, WFN = ZAPTN), DETCI will compute the ZAPTn series. GUESS\_VECTOR
must be set to UNIT, HD\_OTF must be set to TRUE, and HD\_AVE must be set
to orb\_ener; these should happen by default for MPN=TRUE. \\
\end{tabular*}
\begin{tabular*}{\textwidth}[tb]{p{0.3\textwidth}p{0.35\textwidth}p{0.35\textwidth}}
           & {\bf Type:} boolean &  {\bf Default:} false\\
         & & \\
\end{tabular*}

For larger computations, additional keywords may be required, as
described in the \PSIdetci\ section of the Appendix.

\subsubsection{Arbitrary Order Perturbation Theory}
The \PSIdetci\ module is capable of computing energies for arbitrary
order M{\o}ller--Plesset perturbation theory (MPn, for closed-shell
systems with an RHF reference) and for Z-averaged perturbation theory
(ZAPTn, open-shell systems with an ROHF reference).  However, please
note that these computations are essentially doing high-order CI (up to
full CI) computations to obtain these results, and hence they will only
be possible for very small systems (generally a dozen electrons or less).

The simplest way to run high-order perturbation theory computations is to
call, e.g., {\tt energy('mp10')} to invoke an MP10 computation, and
{\tt energy('zapt25')} to invoke a ZAPT25 computation.  This will
automatically set several additional user options to their appropriate
values.  The program uses the Wigner $(2n+1)$ rule to obtain higher-order
energies from lower-order wavefunctions.

For the interested reader, the additional user options that are
automatically set up by the calls above are as follows.  A call like
{\tt energy('mp10')} sets MPN = TRUE.  The program uses the Wigner
$(2n+1)$ rule by default (WIGNER = TRUE) and figures out what order
of wavefunction is necssary to reach the desired order in the energy.
The program then sets MAXNVECT to the required order in the wavefunction.
By default, the requested n{th} order energy is saved as the current energy
to the process environment.   ZAPTN works essentially the same way for an
ROHF reference.

\subsubsection{Arbitrary Order Coupled-Cluster Theory} The
\PSIdetci\ module is also capable of computing arbitrary-order
coupled-cluster energies, using an approach similar to that of Hirata
and Bartlett \cite{Hirata:2000:216}, or of Olsen \cite{Olsen:2000:7140}.
Notably, the approach in \PSIdetci\ also allows arbitrary-order {\em
active space} coupled-cluster procedures.  The general algorithm
for doing this in \PSIdetci\ is inefficient compared to optimized
lower-order coupled-cluster codes and should not be used for CCSD,
where the \PSIccenergy\ module is much more efficient.  It is also very
memory-intensive.  However, it allows for testing of, for example,
CCSDTQ, or its active-space CCSDtq analog \cite{Piecuch:1999:6103},
on very small systems.

To perform arbitrary-order coupled-cluster, set the \PSIdetci\ option
CC to TRUE, and set CC\_EX\_LVL (note: not EX\_LVL) to the desired
coupled-cluster excitation level.  Various other \PSIdetci\ options have a
similar option for coupled-cluster, usually named beginning with CC.  The
full list of options is given in the Appendix.


